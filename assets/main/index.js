System.register("chunks:///_virtual/Analyzer.ts",["cc","./EnumDefine.ts","./define.ts"],(function(e){var n,t,u,r,c,o;return{setters:[function(e){n=e.cclegacy},function(e){t=e.GroundTypeEnum,u=e.RangeTypeEnum},function(e){r=e.ResourceBuffName,c=e.ModuleName,o=e.TResourceType}],execute:function(){e("run",(function(e,n){e(a),n((function(e){return e.module.effect}),a.name,(function(e,n,t){var u={level:n.setting.consts.ability};e.managers.gameLogicUtil.addBuffToResource(t,r.ANALYZED,u)}))})),n._RF.push({},"136f9vx4ChG2KkkkOl2zqoW","Analyzer",void 0);var a={name:c.ANALYZER,groundType:t.INSULATION,funcs:{},consts:{effect:{range:{type:u.AROUND,range:1},resourceSelector:{resourceTypeFilter:[o.COMMON]},triggerInterval:60,funcName:c.ANALYZER},ability:2,maxBuffLevelCount:5,buildAble:{cost:50}},desc:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/AssetVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts"],(function(e){var t,r,n,o,i,a,s,c,l,p,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,s=e.Prefab,c=e.instantiate,l=e.RichText,p=e.Component},function(e){u=e.GlobalContext}],execute:function(){var f,h,g,v,b;i._RF.push({},"6586bZ+91RB/bhtproKPyGq","AssetVMgr",void 0);var d=a.ccclass,y=a.property;e("AssetVMgr",(f=d("AssetVMgr"),h=y({type:s}),f((b=t((v=function(e){function t(){for(var t,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,n(t,"infoPrefab",b,o(t)),t.nodes={},t}r(t,e);var i=t.prototype;return i.start=function(){},i.update=function(e){var t=u.logic,r={hp:"生命",value:"价值",baseResearch:"科研",energy:"能量"};if(t&&t.gameContext){var n=t.gameContext.asset;for(var o in n){var i,a=n[o];if(!this.nodes[o]){var s=c(this.infoPrefab);s.parent=this.node;var p=s.getComponent(l);this.nodes[o]=p}this.nodes[o].string=((null!=(i=r[o])?i:o)+":"+a.cur).padEnd(10," ")}}},t}(p)).prototype,"infoPrefab",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=v))||g));i._RF.pop()}}}));

System.register("chunks:///_virtual/BottomMenuVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,n,e,r;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,r=t.Component}],execute:function(){var u;n._RF.push({},"0fc12Ej/apPj6Ls39iVKSeL","BottomMenuVMgr",void 0);var c=e.ccclass;e.property,t("BottomMenuVMgr",c("BottomMenuVMgr")(u=function(t){function n(){return t.apply(this,arguments)||this}o(n,t);var e=n.prototype;return e.start=function(){},e.update=function(t){},n}(r))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/BottomRightMenuVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewGlobal.ts"],(function(t){var n,o,e,s,i,u;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,s=t.NodeEventType,i=t.Component},function(t){u=t.UIGlobalContext}],execute:function(){var r;o._RF.push({},"366acyqI4pHro5/HPqgT82W","BottomRightMenuVMgr",void 0);var h=e.ccclass;e.property,t("BottomRightMenuVMgr",h("BottomRightMenuVMgr")(r=function(t){function o(){return t.apply(this,arguments)||this}n(o,t);var e=o.prototype;return e.manageEvent=function(t){t?(this.node.on(s.MOUSE_ENTER,this.onMouseEnter,this,!0),this.node.on(s.MOUSE_LEAVE,this.onMouseLeave,this,!0)):(this.node.off(s.MOUSE_ENTER,this.onMouseEnter,this,!0),this.node.off(s.MOUSE_LEAVE,this.onMouseLeave,this,!0))},e.start=function(){this.manageEvent(!0)},e.onDestroy=function(){this.onMouseLeave(),this.manageEvent(!1)},e.update=function(t){},e.onMouseEnter=function(){u.myInputSystem.mousePointMenu=this.node},e.onMouseLeave=function(){u.myInputSystem.mousePointMenu===this.node&&(u.myInputSystem.mousePointMenu=void 0)},o}(i))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/buff.ts",["cc","./EnumDefine.ts","./BuffDefine.ts","./common.ts","./define.ts"],(function(e){var n,u,t,f,o;return{setters:[function(e){n=e.cclegacy},function(e){u=e.ModuleEffectTypeEnum},function(e){t=e.ResourceBuff},function(e){f=e.assert},function(e){o=e.ResourceBuffName}],execute:function(){e("init",(function(e,n,u){[a].forEach((function(n){return e.addFunction((function(e){return e.resource.buff.onDestroy}),n.name,n.func)})),[r].forEach((function(n){return e.addFunction((function(e){return e.resource.buff.beforeDamaged}),n.name,n.func)})),[s,i].forEach((function(e){return n.addResourceBuff(e)}))})),n._RF.push({},"872e1e5uuNJy6/2PXlCWYFp","buff",void 0);var c=t.BuffDestroyReasonEnum,a={name:o.ReduceComplexity,func:function(e,n,t,o){f(!!t.vars.complexity),o===c.TIME&&e.managers.damageManager.applyUnstable(n,{effectType:u.UNSTABLE,ability:{processAbility:t.vars.complexity}})}},r={name:o.ANALYZED,func:function(e,n,u){f(!!n.vars.level),u.relDamage+=n.vars.level,n.vars.level--,n.vars.level<=0&&(n.vars.leftTimes=0)}},s={name:o.ReduceComplexity,func:{onDestroy:a.name,onRepeated:void 0},consts:{maxTime:5}},i={name:o.ANALYZED,func:{beforeDamaged:r.name,onRepeated:t.RepeatedBuffResolutionEnum.NUM_ADD},consts:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/BuffDefine.ts",["cc"],(function(e){var E;return{setters:[function(e){E=e.cclegacy}],execute:function(){var u,R;e("ResourceBuff",void 0),E._RF.push({},"59d24W4wv9CHIaVX1UJ55KE","BuffDefine",void 0),(R=u||(u=e("ResourceBuff",{}))).BuffDestroyReasonEnum={TIMES:"TIMES",TIME:"TIME",RESOURCE_DESTROY:"RESOURCE_DESTROY"},R.RepeatedBuffResolutionEnum={IGNORE:"IGNORE",REPLACE:"REPLACE",ABANDON:"ABANDON",NUM_ADD:"NUM_ADD",OTHER:"自定义名称"},E._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingItemVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewGlobal.ts"],(function(t){var e,i,n,o,s,u,l,h,c;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.RichText,s=t.NodeEventType,u=t.Color,l=t.Component},function(t){h=t.UIGlobalContext,c=t.InputMode}],execute:function(){var r;i._RF.push({},"68daeHYI0BAYpFkbsSUA/xZ","BuildingItemVMgr",void 0);var d=n.ccclass;t("BuildingItemVMgr",d("BuildingItemVMgr")(r=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).buildingName=void 0,e.text=void 0,e}e(i,t);var n=i.prototype;return n.start=function(){this.initRef(),this.manageEvent(!0)},n.initRef=function(){!this.text&&(this.text=this.getComponent(o))},n.manageEvent=function(t){t?(this.node.on(s.MOUSE_ENTER,this.onMouseEnter,this),this.node.on(s.MOUSE_DOWN,this.onMouseClick,this),this.node.on(s.MOUSE_LEAVE,this.onMouseLeave,this)):(this.node.off(s.MOUSE_ENTER,this.onMouseEnter,this),this.node.off(s.MOUSE_DOWN,this.onMouseClick,this),this.node.off(s.MOUSE_LEAVE,this.onMouseLeave,this))},n.init=function(t){this.buildingName=t,this.initRef()},n.update=function(t){this.text&&(this.text.fontColor=h.myInputSystem.clickedBuildAble===this.buildingName&&h.myInputSystem.inputMode===c.BUILD_MODULE?u.BLUE:u.WHITE)},n.onDestroy=function(){this.manageEvent(!1)},n.onMouseEnter=function(t){this.buildingName&&(h.myInputSystem.mouseOverBuildAble=this.buildingName)},n.onMouseLeave=function(t){this.buildingName&&h.myInputSystem.mouseOverBuildAble===this.buildingName&&(h.myInputSystem.mouseOverBuildAble=void 0)},n.onMouseClick=function(t){0==t.getButton()&&(h.myInputSystem.inputMode=c.BUILD_MODULE,h.myInputSystem.clickedBuildAble=this.buildingName)},i}(l))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingManager.ts",["cc","./EnumDefine.ts","./EventDefine.ts"],(function(e){var t,n,i,u;return{setters:[function(e){t=e.cclegacy},function(e){n=e.GroundTypeEnum,i=e.AssetName},function(e){u=e.GameLogicEvent}],execute:function(){t._RF.push({},"19f71006hNN54H7IYxuTjfI","BuildingManager",void 0);e("BuildingManager",function(){function e(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.gameLogicUtils=void 0,this.gameEntityManager=void 0,this.lockChangeEvent=!0,this.buildAbleModules={},this.lockedModules={}}var t=e.prototype;return t.setContext=function(e){this.context=e,this.settingDataManager=e.managers.settingDataManager,this.functionManager=e.managers.functionManager,this.eventBus=e.managers.eventBus,this.gameLogicUtils=e.managers.gameLogicUtil,this.gameEntityManager=e.managers.gameEntityManager},t.afterGameContextFullInit=function(){this.lockChangeEvent=!1,this.onBuildModuleChange()},t.canBuildAt=function(e,t){var i=this.settingDataManager;if(e.module)return!1;var u="string"==typeof t?i.getModule(t):t;return u.groundType===n.NONE||e.groundType===u.groundType},t.getModuleCost=function(e){var t=this.settingDataManager,n="string"==typeof e?t.getModule(e):e,i=n.consts.buildAble;if(!i)return 1/0;if(!i.punishment)return i.cost;var u=this.gameLogicUtils.countModuleByName(n.name);return i.cost+u*i.punishment},t.canBuildModule=function(e,t){var n=this.settingDataManager.getModule(t);if(!this.canBuildAt(e,n))return!1;var u=this.getModuleCost(n);return!(this.context.asset.value.cur<u)&&this.gameLogicUtils.useAsset(i.VALUE,u)},t.buildModule=function(e,t){if(this.canBuildModule(e,t)){var n=this.gameEntityManager.createModule(t);return this.gameEntityManager.registerModule(n,e),n}},t.onBuildModuleChange=function(){if(!this.lockChangeEvent){var e={buildAbleModules:this.getBuildAbleModules()};this.eventBus.pub(u.BUILD_ABLE_MODULE_CHANGE,e)}},t.addBuildAble=function(e){this.buildAbleModules[e]||(this.buildAbleModules[e]=!0,this.onBuildModuleChange())},t.removeBuildAble=function(e){this.buildAbleModules[e]&&(this.buildAbleModules[e]=!1,this.onBuildModuleChange())},t.getBuildAbleModules=function(){var e=[];for(var t in this.buildAbleModules)this.buildAbleModules[t]&&!this.lockedModules[t]&&e.push(t);return e},t.isLocked=function(e){return this.lockedModules[e]},t.unLockModules=function(e){var t=this;e.forEach((function(e){delete t.lockedModules[e]}))},t.lockModules=function(e){var t=this;e.forEach((function(e){t.lockedModules[e]=!0}))},t.lockAllExcept=function(e){var t=this;Object.keys(this.buildAbleModules).forEach((function(n){t.lockedModules[n]=!e.includes(n)}))},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./common.ts","./EnumDefine.ts","./EventDefine.ts","./ViewGlobal.ts","./BuildingItemVMgr.ts"],(function(e){var t,n,i,l,o,u,a,s,r,d,c,b,g,h,f,p,M,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,l=e.assertThisInitialized},function(e){o=e.cclegacy,u=e._decorator,a=e.Prefab,s=e.Input,r=e.instantiate,d=e.RichText,c=e.Component},function(e){b=e.GlobalContext},function(e){g=e.differ},function(e){h=e.TranslateScope},function(e){f=e.GameLogicEvent},function(e){p=e.UIGlobalContext,M=e.InputMode},function(e){v=e.BuildingItemVMgr}],execute:function(){var A,m,E,B,y;o._RF.push({},"1e77b7jtQxMAZIWaSFE+erv","BuildingVMgr",void 0);var C=u.ccclass,I=u.property;e("BuildingVMgr",(A=C("BuildingVMgr"),m=I({type:a,displayName:"建筑项预制体"}),A((y=t((B=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return t=e.call.apply(e,[this].concat(o))||this,i(t,"selectAblePrefab",y,l(t)),t.buildAbleChanged=!0,t.buildAbleModules=void 0,t.lastRenderAbleModules={},t}n(t,e);var o=t.prototype;return o.onBuildAbleChangeEvent=function(e,t,n){this.buildAbleChanged=!0,this.buildAbleModules=n.buildAbleModules},o.onBuildModule=function(e,t,n){this.buildAbleChanged=!0},o.onRightClick=function(e){2==e.getButton()&&(p.myInputSystem.inputMode=M.NONE,p.myInputSystem.clickedBuildAble=void 0)},o.manageEvent=function(e){var t=e?b.context.managers.eventBus.sub:b.context.managers.eventBus.remove,n=e?p.globalUIEvent.sub:p.globalUIEvent.remove;t(f.BUILD_ABLE_MODULE_CHANGE,this.onBuildAbleChangeEvent,this),t(f.NEW_MODULE,this.onBuildModule,this),n(s.EventType.MOUSE_DOWN,this.onRightClick,this)},o.start=function(){this.manageEvent(!0)},o.onDestroy=function(){this.manageEvent(!1)},o.resetBuildAbleUI=function(){var e=this,t=b.context;this.buildAbleModules||(this.buildAbleModules=t.managers.buildingManager.getBuildAbleModules()),this.buildAbleChanged=!1;var n=this.buildAbleModules.reduce((function(e,t){return e[t]=t,e}),{}),i=g(this.lastRenderAbleModules,n),l=t.managers.translateManager,o=t.managers.buildingManager;i.add.forEach((function(t){var n=l.$(h.MODULE_NAME,t),i=r(e.selectAblePrefab);i.parent=e.node,i.getComponent(d).string=n+" cost:"+o.getModuleCost(t);var u=i.getComponent(v);u.init(t),e.lastRenderAbleModules[t]=u})),i.delete.forEach((function(t){delete e.lastRenderAbleModules[t.buildingName],t.node.destroy()}))},o.update=function(e){b.context&&this.buildAbleChanged&&this.resetBuildAbleUI()},o.onClickBuildingButton=function(){},t}(c)).prototype,"selectAblePrefab",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=B))||E));o._RF.pop()}}}));

System.register("chunks:///_virtual/CameraManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameLogic.ts","./GameContextBuilder.ts","./GlobalContextImpl.ts","./Mod2.ts","./ViewGlobal.ts"],(function(t){var e,n,o,i,a,s,r,u,c,l,g,p,h,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){a=t.cclegacy,s=t._decorator,r=t.Node,u=t.Vec2,c=t.Component},function(t){l=t.GameLogic},function(t){g=t.GameContextBuilder},function(t){p=t.GlobalContext},function(t){h=t.Mods},function(t){f=t.UIGlobalContext}],execute:function(){var v,d,m,M,y,E;a._RF.push({},"8623flulA5K+4h5udynbbwd","CameraManager",void 0);var b=s.ccclass,C=s.property;t("CameraManager",(v=b("CameraManager"),d=C({type:r}),v(((E=function(t){function e(){var e;if(e=t.call(this)||this,o(e,"camera",y,i(e)),e.isDragging=!1,e.startPos=void 0,p.logic)return i(e);h.forEach((function(t){null==t.onApplicationLoaded||t.onApplicationLoaded([],[],p)}));var n=new g;return p.setGameContext(new l(n.buildByLevel(p.levelManager.getLevels()[0]))),e}n(e,t);var a=e.prototype;return a.start=function(){e.INSTANCE=this},a.update=function(t){},a.manageEvent=function(t){var e=f.globalUIEvent.$(!0);e(r.EventType.MOUSE_DOWN,this.onMouseDown,this),e(r.EventType.MOUSE_MOVE,this.onMouseMove,this),e(r.EventType.MOUSE_UP,this.onMouseUp,this),e(r.EventType.MOUSE_LEAVE,this.onMouseUp,this)},a.onLoad=function(){this.manageEvent(!0),this.isDragging=!1,this.startPos=new u(0,0)},a.onMouseDown=function(t){f.myInputSystem.mousePointMenu||(this.startPos=t.getLocation(),this.isDragging=!0)},a.onMouseMove=function(t){if(this.isDragging&&this.camera){var e=t.getLocation().subtract(this.startPos);this.camera.position=this.node.position.add3f(-e.x,-e.y,0),this.startPos=t.getLocation()}},a.onMouseUp=function(){this.isDragging=!1},a.onDestroy=function(){this.manageEvent(!1)},e}(c)).INSTANCE=void 0,y=e((M=E).prototype,"camera",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=M))||m));a._RF.pop()}}}));

System.register("chunks:///_virtual/CollaborativeProcessor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,t,i,o,r,u,c,s;return{setters:[function(e){n=e.extends},function(e){t=e.cclegacy},function(e){i=e.ModuleEffectTypeEnum,o=e.GroundTypeEnum,r=e.RangeTypeEnum},function(e){u=e.FRAME_RATE},function(e){c=e.ModuleName,s=e.TResourceType}],execute:function(){e("run",(function(e,t){e(a),t((function(e){return e.module.effect}),a.name,(function(e,t,o){var r=t.setting.consts,c=e.managers.gameLogicUtil.getAround4(t.position).filter((function(e){return null==e?void 0:e.module})).length,s=r.ability+c*r.increaseAbility;e.managers.gameEntityManager.createAndRegisterBullet({effectType:i.PROCESS,ability:{processAbility:s},moveSpeed:2/u,realPosition:n({},t.position),target:o})}))})),t._RF.push({},"4fb19qflWJCzLnM3xxm4Q/f","CollaborativeProcessor",void 0);var a={name:c.COLLABORATIVE_PROCESSOR,groundType:o.INSULATION,funcs:{},consts:{effect:{range:{type:r.AROUND,range:1},resourceSelector:{resourceTypeFilter:[s.COMMON]},triggerInterval:60,funcName:c.COLLABORATIVE_PROCESSOR},ability:2,increaseAbility:1,buildAble:{cost:70}},desc:{}};t._RF.pop()}}}));

System.register("chunks:///_virtual/common.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.js","./EnumDefine.ts"],(function(t){var r,e,n,i,o,s,u;return{setters:[function(t){r=t.createForOfIteratorHelperLoose,e=t.inheritsLoose,n=t.wrapNativeSuper},function(t){i=t.cclegacy},function(t){o=t.stringify,s=t.parse},function(t){u=t.DirectionTypeEnum}],execute:function(){t({assert:function(t,r){if(!t)throw console.error("assert error"+(null!=r?r:"")),new Error("assert error"+(null!=r?r:""))},bindAll:function(t){for(var e,n=r(Object.getOwnPropertyNames(Object.getPrototypeOf(t)));!(e=n()).done;){var i=e.value;"function"==typeof t[i]&&(t[i]=t[i].bind(t))}},differ:function(t,r){var e={add:[],modify:[],delete:[]};for(var n in t){var i=t[n],o=r[n];i&&o?e.modify.push({oldObj:i,newObj:o}):i&&e.delete.push(i)}for(var s in r){var u=t[s],f=r[s];u||e.add.push(f)}return e},differObject2:function(t,r){var e={add:[],modify:[],delete:[]};for(var n in t){var i=t[n],o=r[n];i&&o?e.modify.push({key:n,oldObj:i,newObj:o}):i&&e.delete.push({obj:i,key:n})}for(var s in r){var u=t[s],f=r[s];u||e.add.push({obj:f,key:s})}return e}}),i._RF.push({},"2e0ddWnOrtAyYuiNM5hMk0F","common",void 0),t("MyPointClass",function(){function t(t,r){this.x=void 0,this.y=void 0,this.x=t,this.y=r}var r=t.prototype;return r.pointOfDirection=function(r){if(r==u.DOWN)return new t(this.x,this.y-1);if(r==u.UP)return new t(this.x,this.y+1);if(r==u.LEFT)return new t(this.x-1,this.y);if(r==u.RIGHT)return new t(this.x+1,this.y);throw new Error("未知方向")},r.equals=function(t){return t&&t.x==this.x&&t.y==this.y},t.equals=function(t,r){return t==r||null==t&&null==r||t&&r&&t.x==r.x&&r.y==t.y},t}()).ZERO_RAW={x:0,y:0};t("Timer",function(){function t(){this.time=0}var r=t.prototype;return r.add=function(t){this.time+=t},r.wait=function(t){return this.time>=t&&(this.time=0,!0)},r.addWait=function(t,r){return this.time+=t,this.time>=r&&(this.time=0,!0)},t}());t("GameOverError",function(t){function r(r){var e;return(e=t.call(this,"游戏结束"+r)||this).success=void 0,e.success=r,e}return e(r,t),r}(n(Error))),t("JSON",{stringify:o,parse:s});i._RF.pop()}}}));

System.register("chunks:///_virtual/DamageManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./define.ts","./common.ts","./EnumDefine.ts"],(function(e){var a,t,i,s,n,r,l;return{setters:[function(e){a=e.createForOfIteratorHelperLoose},function(e){t=e.cclegacy},function(e){i=e.ResourceBuffName},function(e){s=e.bindAll,n=e.assert},function(e){r=e.ModuleEffectTypeEnum,l=e.AssetName}],execute:function(){t._RF.push({},"487f2m//X1H4rb9ODmEiOu/","DamageManager",void 0);e("DamageManager",function(){function e(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.gameEntityManager=void 0,this.buffManager=void 0,this.gameLogicUtils=void 0}var t=e.prototype;return t.setContext=function(e){this.context=e,this.settingDataManager=e.managers.settingDataManager,this.functionManager=e.managers.functionManager,this.eventBus=e.managers.eventBus,this.gameEntityManager=e.managers.gameEntityManager,this.buffManager=e.managers.buildingManager,this.gameLogicUtils=e.managers.gameLogicUtil,s(this)},t.apply=function(e,a){switch(a.effectType){case r.PROCESS:this.applyProcess(e,a);break;case r.BATCH_PROCESS:this.applyBatchProcess(e,a);break;case r.ANALYSIS:this.applyAnalysis(e,a);break;case r.DEBUG:this.applyDebug(e,a);break;case r.FLIP:throw new Error("TODO");case r.UNSTABLE:this.applyUnstable(e,a);break;case r.INTERFERE:this.applyInterfere(e,a);break;case r.MERGE:this.applyMerge(e,a);break;case r.DECOMPOSE:this.applyDecompose(e,a);break;case r.INSPIRE:this.applyInspire(e,a);break;case r.CONSUME:this.applyConsume(e,a)}},t.applyProcess=function(e,a){var t,i=null==(t=a.ability)?void 0:t.processAbility;if(n(i&&i>=0),0!=e.alive){var s=this.applyProcess_CalculateBuff(i,e,a);e.vars.complexity-=s,(e.vars.complexity<=0||!e.alive)&&this.gameEntityManager.deRegisterResource(e,a)}},t.applyBatchProcess=function(e,t){var i,s=null==(i=t.ability)?void 0:i.processAbility;n(s&&s>=0);for(var r,l=a(e);!(r=l()).done;){var o=r.value;if(0!=o.alive){var c=this.applyProcess_CalculateBuff(s,o,t);o.vars.complexity-=c,(o.vars.complexity<=0||!o.alive)&&this.gameEntityManager.deRegisterResource(o,t)}}},t.applyDebug=function(e,a){var t,i=null==(t=a.ability)?void 0:t.debugAbility;if(n(i&&i>=0),0!=e.alive){var s=this.applyProcess_CalculateBuff(i,e,a);e.vars.complexity-=s,(e.vars.complexity<=0||!e.alive)&&this.gameEntityManager.deRegisterResource(e,a)}},t.applyAnalysis=function(e,a){if(a.ability.analysisAbility&&!(a.ability.analysisAbility<=0)){var t={level:a.ability.analysisAbility};this.gameLogicUtils.addBuffToResource(e,i.ANALYZED,t)}},t.applyUnstable=function(e,a){var t,i=null==(t=a.ability)?void 0:t.processAbility;if(n(i&&i>=0),0!=e.alive){var s=i;e.vars.complexity-=s,(e.vars.complexity<=0||!e.alive)&&this.gameEntityManager.deRegisterResource(e,a)}},t.applyMerge=function(e,a){},t.applyDecompose=function(e,a){},t.applyInterfere=function(e,a){},t.applyInspire=function(e,a){var t=e.setting.consts;t.addValue&&this.gameLogicUtils.addAsset(l.VALUE,t.addValue),t.addEnergy&&this.gameLogicUtils.addAsset(l.ENERGY,t.addEnergy),t.damage&&this.gameLogicUtils.addAsset(l.ENERGY,t.damage)},t.applyConsume=function(e,a){var t,i=null==(t=a.ability)?void 0:t.processAbility;n(i&&i>=0),0!=e.alive&&(e.alive=!1,e.vars.complexity=0,this.gameEntityManager.deRegisterResource(e,a))},t.applyProcess_CalculateBuff=function(e,a,t){var i=this,s={orgDamage:e,relDamage:e,target:a,bullet:t};return a.buffs.forEach((function(e){var a=e.setting.func.beforeDamaged;if(a){var t=i.functionManager.getFunction((function(e){return e.resource.buff.beforeDamaged}),a);t&&t(i.context,e,s)}})),this.gameLogicUtils.checkResourceBuffDestroy(a),s.relDamage},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/define.ts",["cc"],(function(R){var E;return{setters:[function(R){E=R.cclegacy}],execute:function(){E._RF.push({},"5a81ew3SrdPMKPM3AgTE6wf","define",void 0);R("ModuleName",{START:"MN_START",END:"MN_END",PROCESSOR:"MN_PROCESS",INDEPENDENT_PROCESSOR:"MN_INDEPENDENT_PROCESSOR",COLLABORATIVE_PROCESSOR:"MN_COLLABORATIVE_PROCESSOR",HARMLESS_PROCESSOR:"MN_HARMLESS_PROCESSOR",RECYCLE:"MN_RECYCLE",FLIP:"MN_FLIP",ANALYZER:"MN_ANALYZER",POWERFUL_PROCESSOR:"MN_POWERFUL_PROCESSOR",REINFORCER:"MN_REINFORCER",LABORATORY:"MN_LABORATORY",OPERATIONS:"MN_OPERATIONS",JAMMER:"MN_JAMMER",MAINTENANCE:"MN_MAINTENANCE",POLE_TRANSMISSION:"MN_POLE_TRANSMISSION",FORGET:"MN_FORGET",CALCULATOR:"MN_CALCULATOR",INTERCEPTOR:"MN_INTERCEPTOR",POLE_POWER_STATION:"MN_POLE_POWER_STATION",CAPACITANCE:"MN_CAPACITANCE",POWERED_LABORATORY:"MN_POWERED_LABORATORY",POWERED_PROCESSOR:"MN_POWERED_PROCESSOR",POWERED_FLIP:"MN_POWERED_FLIP",REFACTOR:"MN_REFACTOR",SUICIDAL_PROCESS:"MN_SUICIDAL_PROCESS",PROCESS_ACCELERATOR:"MN_PROCESS_ACCELERATOR"}),R("ResourceName",{META_DATA:"RT_META_DATA",PERSISTENT_DATA:"RT_PERSISTENT_DATA",VOLATILE_DATA:"RT_VOLATILE_DATA",BACKUP_DATA:"RT_BACKUP_DATA",DISTRIBUTED_DATA:"RT_DISTRIBUTED_DATA",BUG:"RT_BUG",VULNERABILITY:"RT_VULNERABILITY",ENERGY:"RT_ENERGY",VALUE:"RT_VALUE"}),R("TResourceType",{COMMON:"TL_COMMON",DANGER:"TL_DANGER",SPECIAL:"TL_SPECIAL"}),R("ResourceBuffName",{ReduceComplexity:"RBN_ReduceComplexity",ANALYZED:"RBN_Analyzed"});E._RF.pop()}}}));

System.register("chunks:///_virtual/End.ts",["cc","./EnumDefine.ts","./define.ts"],(function(e){var n,t,r,u,a;return{setters:[function(e){n=e.cclegacy},function(e){t=e.GroundTypeEnum,r=e.RangeTypeEnum,u=e.ModuleEffectTypeEnum},function(e){a=e.ModuleName}],execute:function(){e("run",(function(e,n){e(c),n((function(e){return e.module.effect}),c.name,(function(e,n,t){if(t){var r={effectType:u.INSPIRE,ability:{}};e.managers.damageManager.applyInspire(t,r),e.managers.gameEntityManager.deRegisterResource(t,r)}}))})),n._RF.push({},"0dc2eawk+9ITJ0R8JFtOotB","End",void 0);var c={name:a.END,groundType:t.NONE,funcs:{},consts:{effect:{range:{type:r.SELF},resourceSelector:{},triggerInterval:0,funcName:a.END}}};n._RF.pop()}}}));

System.register("chunks:///_virtual/EnumDefine.ts",["cc"],(function(E){var N;return{setters:[function(E){N=E.cclegacy}],execute:function(){N._RF.push({},"a43058pmOVBs6YdMBqWoFqm","EnumDefine",void 0);E("DirectionTypeEnum",{UP:"U",DOWN:"D",LEFT:"L",RIGHT:"R"}),E("GroundTypeEnum",{NONE:"GT_NONE",WIRE:"GT_WIRE",INSULATION:"GT_INSULATION",POLE:"POLE",HOLE:"HOLE",PIN__2:"PIN__2",PIN__4:"PIN__4",PIN__8:"PIN__8",PIN__16:"PIN__16"}),E("ModuleEffectTypeEnum",{UNKNOWN:"UNKNOWN",PROCESS:"PROCESS",BATCH_PROCESS:"BATCH_PROCESS",ANALYSIS:"ANALYSIS",DEBUG:"DEBUG",FLIP:"FLIP",UNSTABLE:"UNSTABLE",INTERFERE:"INTERFERE",MERGE:"MERGE",DECOMPOSE:"DECOMPOSE",INSPIRE:"INSPIRE",CONSUME:"CONSUME"}),E("AssetName",{VALUE:"value",ENERGY:"energy",RESEARCH_BASE:"baseResearch"}),E("TranslateScope",{MODULE_NAME:"0",MODULE_DESC:"1",RESOURCE_NAME:"10",RESOURCE_DESC:"11",BUFF_NAME:"20",BUFF_DESC:"21",GROUND_NAME:"100",G_LEVEL_NAME:"1000",G_LEVEL_DESC:"1001"}),E("LangEnum",{CN:"cn",EN:"en"}),E("RangeTypeEnum",{SELF:"0",AROUND:"1",CIRCULAR:"2"});N._RF.pop()}}}));

System.register("chunks:///_virtual/EventBus.ts",["cc","./common.ts"],(function(t){var n,e;return{setters:[function(t){n=t.cclegacy},function(t){e=t.bindAll}],execute:function(){n._RF.push({},"03166inDCZOJqLj5vAM11px","EventBus",void 0);t("EventBus",function(){function t(){this.listeners={},this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0}var n=t.prototype;return n.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.functionManager=t.managers.functionManager,this.eventBus=t.managers.eventBus,e(this)},n.pub=function(t,n){var e=this,i=this.listeners[t];i&&i.length&&i.forEach((function(i){i.listener(e.context,t,n)}))},n.sub=function(t,n,e){this.listeners[t]||(this.listeners[t]=[]),e&&(n=n.bind(e));var i=this.listeners[t].find((function(t){return t.listener==n&&(!e||t.$this==e)}));if(i){if(i.$this!=e)throw new Error("已经注册了该监听,但绑定的this不一致")}else this.listeners[t].push({listener:n,$this:e})},n.targetOff=function(t){if(t)for(var n=0,e=Object.keys(this.listeners);n<e.length;n++){var i=e[n],s=this.listeners[i];s.findIndex((function(n){return n.$this==t}))>=0&&(this.listeners[i]=s.filter((function(n){return n.$this==t})))}},n.remove=function(t,n,e){if(this.listeners[t]){var i=this.listeners[t].findIndex((function(t){return t.listener==n&&(!e||t.$this==e)})),s=this.listeners[t][i];if(s)throw s.$this==e&&(this.listeners[t]=this.listeners[t].filter((function(t){return t!=s}))),new Error("已经注册了该监听,但解除绑定的this没有传")}},n.clear=function(t){delete this.listeners[t]},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/EventDefine.ts",["cc"],(function(E){var S;return{setters:[function(E){S=E.cclegacy}],execute:function(){S._RF.push({},"574ebvJ6nhCN4KDZQwOAIJo","EventDefine",void 0);E("GameLogicEvent",{RESOURCE_DESTROYED:"RESOURCE_DESTROYED",GAME_FAIL:"GAME_FAIL",GAME_SUCCESS:"GAME_SUCCESS",ASSET_ADD:"ASSET_ADD",ASSET_USE:"ASSET_USE",BUILD_ABLE_MODULE_CHANGE:"BUILD_ABLE_MODULE_CHANGE",NEW_MODULE:"BUILD_MODULE"});S._RF.pop()}}}));

System.register("chunks:///_virtual/Flip.ts",["cc","./common.ts","./EnumDefine.ts","./define.ts"],(function(e){var n,t,u,c,o,r,i;return{setters:[function(e){n=e.cclegacy},function(e){t=e.assert},function(e){u=e.GroundTypeEnum,c=e.RangeTypeEnum},function(e){o=e.ResourceName,r=e.ResourceBuffName,i=e.ModuleName}],execute:function(){e("run",(function(e,n){e(s),n((function(e){return e.module.effect}),s.name,(function(e,n,u){var c=n.setting.consts,i=e.managers.gameLogicUtil;if(u.name===o.PERSISTENT_DATA)i.doMultipleToResource(u,1/c.multiples),i.changeResourceType(u,o.VOLATILE_DATA);else if(u.name===o.VOLATILE_DATA){var s=i.doMultipleToResource(u,c.multiples);i.changeResourceType(u,o.PERSISTENT_DATA),s>0&&i.addBuffToResource(u,r.ReduceComplexity,{leftTime:c.recoverTime,complexity:s})}else t(!1,"翻转不能接受该资源类型"+u.name)}))})),n._RF.push({},"00f66LZDrdHQpCL6ATWietQ","Flip",void 0);var s={name:i.FLIP,groundType:u.INSULATION,funcs:{},consts:{effect:{range:{type:c.AROUND,range:1},resourceSelector:{resourceNameFilter:[o.PERSISTENT_DATA,o.VOLATILE_DATA]},triggerInterval:60,funcName:i.FLIP},multiples:2,recoverTime:5,buildAble:{cost:100}},desc:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/funcs.ts",["cc"],(function(){var c;return{setters:[function(t){c=t.cclegacy}],execute:function(){c._RF.push({},"d37a4bGlO5JN4Q+QNFidpxW","funcs",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/FunctionManager.ts",["cc","./common.ts"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy},function(t){n=t.bindAll}],execute:function(){e._RF.push({},"b054eT87TdBJ75tEpDUFERk","FunctionManager",void 0);t("FunctionManager",function(){function t(){this.context=void 0,this.settingDataManager=void 0,this.eventBus=void 0,this.lifeCycle=void 0,this.module=void 0,this.resource=void 0,this.lifeCycle={afterTicket:{},beforeTicket:{}},this.module={effect:{},onTick:{},onBuild:{},init:{},onNewWave:{}},this.resource={onTick:{},onMove:{},onDestroy:{},init:{},selector:{},buff:{init:{},onTick:{},onDestroy:{},beforeDamaged:{},onRepeat:{}}}}var e=t.prototype;return e.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.eventBus=t.managers.eventBus,n(this)},e.addFunction=function(t,e,n){if(e){var i=t(this);if(!i)throw new Error("未知方法 funcName:"+e);if(i[e])throw new Error("方法已经存在funcName:"+e);i[e]=n}},e.getFunction=function(t,e){if(e){var n=t(this);if(!n)throw new Error("未知方法 funcName:"+e);var i=n[e];if(!i)throw new Error("未知方法 funcName:"+e);return i}},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/GameContextBuilder.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./BuildingManager.ts","./DamageManager.ts","./EventBus.ts","./FunctionManager.ts","./GameEntityManager.ts","./GameLogicUtils.ts","./MapUtil.ts","./ResearchManager.ts","./SettingDataManager.ts","./TranslateManager.ts","./EnumDefine.ts","./GameData.ts","./Mod2.ts"],(function(n){var t,i,e,o,a,s,r,u,p,c,g,l,f,y,m,d,h,v;return{setters:[function(n){t=n.extends},function(n){i=n.cclegacy},function(n){e=n.assert,o=n.MyPointClass},function(n){a=n.BuildingManager},function(n){s=n.DamageManager},function(n){r=n.EventBus},function(n){u=n.FunctionManager},function(n){p=n.GameEntityManager},function(n){c=n.GameLogicUtils},function(n){g=n.MapUtil},function(n){l=n.ResearchManager},function(n){f=n.SettingDataManager},function(n){y=n.TranslateManager},function(n){m=n.DirectionTypeEnum,d=n.GroundTypeEnum},function(n){h=n.GameMap},function(n){v=n.Mods}],execute:function(){i._RF.push({},"0e675i0inRPQ7yBCirXImk6","GameContextBuilder",void 0);n("GameContextBuilder",function(){function n(){}var i=n.prototype;return i.buildManagers=function(n){return n.managers={functionManager:new u,eventBus:new r,gameEntityManager:new p,settingDataManager:new f,gameLogicUtil:new c,buildingManager:new a,translateManager:new y,researchManager:new l,mapUtil:new g,damageManager:new s},n.managers},i.getDirection=function(n,t){if(n.x==t.x){if(t.y-n.y==1)return m.DOWN;if(t.y-n.y==-1)return m.UP}else if(n.y==t.y){if(t.x-n.x==1)return m.RIGHT;if(t.x-n.x==-1)return m.LEFT}throw new Error("未知坐标方向")},i.buildByLevel=function(n){var i=this,a=this.buildEmptyMap(n),s=[];n.wayPoints.forEach((function(n){var t=[];s.push(t);var i=a.getAt(n[0]);e(!!i,"配置的路径超出地图范围"+JSON.stringify(n[0]));for(var o=1;o<n.length;o++){var r=a.getAt(n[o]);if(e(!!r,"配置的路径超出地图范围"+JSON.stringify(n[0])),i.position.x!==r.position.x&&i.position.y===r.position.y)for(var u=i.position.x>r.position.x?-1:1,p=i.position.x;p<r.position.x;p+=u){var c=a.getAt({x:p,y:r.position.y});c.groundType=d.WIRE,t.push(c)}else if(i.position.x===r.position.x&&i.position.y!==r.position.y)for(var g=i.position.y>r.position.y?-1:1,l=i.position.y;l<r.position.y;l+=g){var f=a.getAt({x:r.position.x,y:l});f.groundType=d.WIRE,t.push(f)}else if(i.position.x-r.position.x!=0&&Math.abs(i.position.x-r.position.x)==Math.abs(i.position.y-r.position.y))for(var y=i.position.x>r.position.x?-1:1,m=i.position.y>r.position.y?-1:1,h=i.position.x,v=i.position.y;h<r.position.x;h+=y,v+=m){var x=a.getAt({x:h,y:v});x.groundType=d.WIRE,t.push(x)}else e(!1,"不支持该路径方式");i=r}i.groundType=d.WIRE,t.push(i)})),n.grounds.forEach((function(n){var t=a.getAt(n.pos);e(!!t,"配置的地面类型超出地图范围"+JSON.stringify(n.pos)),t.groundType=n.ground}));var r=s.map((function(n){return n[0]})),u=s.map((function(n){return n[n.length-1]})),p=s.map((function(n,t){var e=[],a=i.getDirection(n[0].position,n[1].position);e.push({pos:n[0].position,direction:a});for(var s=1;s<n.length;s++){var r=n[s],u=n[s-1],p=i.getDirection(u.position,r.position);p!==a&&e.push({pos:u.position,direction:p}),a=p}return o.equals(e[e.length-1].pos,n[n.length-1].position)||e.push({pos:n[n.length-1].position,direction:a}),{rid:t+1,start:n[0],end:n[n.length-1],wayPoints:n,keyPoints:e}}));p.forEach((function(n){var t=0;n.wayPoints.forEach((function(i){var e;o.equals(n.keyPoints[t].pos,i.position)&&t++,i.nextWayPoint=null==(e=n.keyPoints[t])?void 0:e.pos}))}));var c=t({},this.buildCommonData(),{asset:n.asset,map:a,wavesInfo:{nextPtr:0,waves:n.waves},place:{ends:u,starts:r},roads:p}),g=this.buildManagers(c),l=(g.gameEntityManager,g.buildingManager);return Object.values(c.managers).forEach((function(n){return n.setContext(c)})),v.forEach((function(n){null==n.onGameContextCreated||n.onGameContextCreated(c,[],[])})),n.limitModule&&l.lockAllExcept(n.limitModule),Object.values(c.managers).forEach((function(n){return null==n.afterGameContextFullInit?void 0:n.afterGameContextFullInit()})),c},i.buildEmptyMap=function(n){var t=new h;t.sizeX=n.width,t.sizeY=n.height,t.mapUnits=[];for(var i=0;i<t.sizeY;i++){var e=[];t.mapUnits.push(e);for(var o=0;o<t.sizeX;o++){var a={module:void 0,position:{x:o,y:i},groundType:d.INSULATION,resources:[]};e.push(a)}}return t},i.buildCommonData=function(){return{eidPtr:0,tick:0,entities:{modules:{},moduleList:[],resources:{},resourceList:[],bullets:{},bulletList:[]},moduleMapUnits:[],alive:!0,research:{unlocked:{}},cache:{},temp:{},managers:{}}},n}());i._RF.pop()}}}));

System.register("chunks:///_virtual/GameData.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"97a64W8Nq5L87uPIWLZb9H6","GameData",void 0);t("GameMap",function(){function t(){this.sizeX=void 0,this.sizeY=void 0,this.mapUnits=void 0,this.sizeX=50,this.sizeY=50,this.mapUnits=[]}var i=t.prototype;return i.filter=function(t){for(var i=[],s=0;s<this.sizeY;s++)for(var e=this.mapUnits[s],n=0;n<this.sizeX;n++)t(e[n])&&i.push(e[n]);return i},i.getAt=function(t){if(t)return this.mapUnits[t.y][t.x]?this.mapUnits[t.y][t.x]:void 0},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/GameEntity.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"9bb22mgtOFDYLoazN+A6QIc","GameEntity",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/GameEntityManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EnumDefine.ts","./EventDefine.ts"],(function(t){var e,i,n,s,o;return{setters:[function(t){e=t.extends},function(t){i=t.cclegacy},function(t){n=t.bindAll,s=t.MyPointClass},null,function(t){o=t.GameLogicEvent}],execute:function(){i._RF.push({},"d5efcOnCFFNYrqF0YdISqq5","GameEntityManager",void 0);t("GameEntityManager",function(){function t(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.gameLogicUtils=void 0}var i=t.prototype;return i.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.functionManager=t.managers.functionManager,this.eventBus=t.managers.eventBus,this.gameLogicUtils=t.managers.gameLogicUtil,n(this)},i._buildModule=function(t,e){return{eid:t,alive:!0,position:s.ZERO_RAW,name:e.name,setting:e,cache:{},vars:{effect:{coldDown:0}}}},i._buildResource=function(t,i,n,o){return{eid:t,name:i.name,setting:i,vars:e({logicPosition:s.ZERO_RAW,nextWayPoint:s.ZERO_RAW,realPosition:s.ZERO_RAW,complexity:n},o),buffs:[],cache:{},alive:!0}},i.createModule=function(t){var e=this.settingDataManager.getModule(t);if(!e)throw new Error("配置不存在"+t);var i=this._buildModule(++this.context.eidPtr,e),n=null==e?void 0:e.funcs.init,s=this.functionManager.getFunction((function(t){return t.module.init}),n);return null==s||s(this.context,i),i},i.registerModule=function(t,e){var i=this.context;e.module=t,t.position=e.position,i.entities.modules[t.eid]=t,i.entities.moduleList.push(t);var n={module:t};return i.managers.eventBus.pub(o.NEW_MODULE,n),t},i.createResource=function(t,e,i){var n=this.context,s=this.settingDataManager.getResource(t);if(!s)throw new Error("配置不存在"+t);var o=this._buildResource(++n.eidPtr,s,e,i),r=null==s?void 0:s.funcs.init,u=this.functionManager.getFunction((function(t){return t.resource.init}),r);return null==u||u(n,o),o},i.registerResource=function(t,i){return i.resources.push(t),t.vars.logicPosition=e({},i.position),t.vars.nextWayPoint=i.nextWayPoint,this.context.entities.resources[t.eid]=t,this.context.entities.resourceList.push(t),t},i.deRegisterResource=function(t,e){if(this.context.entities.resources[t.eid]){t.alive=!1,delete this.context.entities.resources[t.eid];var i=this.context.map.getAt(t.vars.logicPosition);if(i){i.resources=i.resources.filter((function(e){return e!=t}));var n={attacker:e,resource:t};this.gameLogicUtils.checkResourceBuffDestroy(t);var s=this.functionManager.getFunction((function(t){return t.resource.onDestroy}),t.setting.funcs.onDestroy);return s&&s(this.context,n),this.eventBus.pub(o.RESOURCE_DESTROYED,n),t}}},i.deRegisterModule=function(t){if(this.context.entities.modules[t.eid]){var e=this.context.map.getAt(t.position);e&&delete e.module,t.alive=!1,delete this.context.entities.modules[t.eid]}},i.createAndRegisterBullet=function(t){return t.eid=++this.context.eidPtr,t.alive=!0,this.context.entities.bullets[t.eid]=t,this.context.entities.bulletList.push(t),t},i.deRegisterBullet=function(t){t.alive=!1,delete this.context.entities.bullets[t.eid]},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/GameLogic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EventDefine.ts"],(function(e){var t,n,i,o,r;return{setters:[function(e){t=e.createForOfIteratorHelperLoose,n=e.extends},function(e){i=e.cclegacy},function(e){o=e.GameOverError},function(e){r=e.GameLogicEvent}],execute:function(){i._RF.push({},"282660ewJNO3oyeER5uZRTk","GameLogic",void 0);e("GameLogic",function(){function e(e){this.pause=!1,this.gameSpeed=1,this.gameContext=void 0,this.gameContext=e}var i=e.prototype;return i.init=function(){},i.getFunction=function(e,t){if(t)return this.gameContext.managers.functionManager.getFunction(e,t)},i.nextTick=function(){if(!this.pause)try{if(this.gameContext.alive&&(this.mainLogic(),!this.gameContext.alive))throw new o(!1)}catch(e){if(e instanceof o)this.gameContext.alive=!1,e.success?this.gameContext.managers.eventBus.pub(r.GAME_SUCCESS,void 0):this.gameContext.managers.eventBus.pub(r.GAME_FAIL,void 0);else console.log(e)}},i.mainLogic=function(){var e=this.gameContext;e.alive&&(e.temp={},this.beforeTickLogic(e),this.nextWaveLogic(e),this.moveNextLogic(e),this.onTickLogic(),this.moduleEffectLogic(e),this.entityAliveJudgeLogic(e),this.afterTickLogic(e),e.tick++,this.debuggerChecker(e))},i.moduleEffectLogic=function(e){e.entities.moduleList.forEach((function(t){if(t.alive&&t.setting.consts.effect&&t.vars.effect){var n=t.vars.effect,i=t.setting.consts.effect;if(n.coldDown<=0){var o=e.entities.resourceList.filter((function(e){return e.alive})).filter((function(n){return e.managers.gameLogicUtil.isInRange(n,t)})).filter((function(n){return e.managers.gameLogicUtil.isMatchEffect(n,t)}));if(o.length){var r=e.managers.functionManager.getFunction((function(e){return e.module.effect}),i.funcName);if(r)for(var a=0;a<o.length&&n.coldDown<=0;a++){var s=o[a],c=r(e,t,s);null!=c&&c.noColdDown||(n.coldDown=i.triggerInterval)}}}n.coldDown=Math.max(0,n.coldDown-1)}}))},i.onTickLogic=function(){var e=this,t=this.gameContext;t.entities.moduleList.forEach((function(t){var n,i;t.alive&&(null==(n=e.getFunction((function(e){return e.module.onTick}),null==(i=t.setting)||null==(i=i.funcs)?void 0:i.onTicket))||n(e.gameContext,t))})),t.entities.resourceList.forEach((function(n){var i,o;n.alive&&(null==(i=e.getFunction((function(e){return e.resource.onTick}),null==(o=n.setting)||null==(o=o.funcs)?void 0:o.onTicket))||i(t,n),n.buffs.forEach((function(i){var o;null==(o=e.getFunction((function(e){return e.resource.buff.onTick}),i.setting.func.onTick))||o(t,n,i),void 0!==i.vars.leftTime&&i.vars.leftTime--})),t.managers.gameLogicUtil.checkResourceBuffDestroy(n))}))},i.beforeTickLogic=function(e){Object.values(e.managers.functionManager.lifeCycle.beforeTicket).forEach((function(t){return null==t?void 0:t(e)}))},i.afterTickLogic=function(e){Object.values(e.managers.functionManager.lifeCycle.afterTicket).forEach((function(t){return null==t?void 0:t(e)}))},i.moveNextLogic=function(e){var i=e.managers.mapUtil,o=e.managers.damageManager,r=e.managers.gameEntityManager;e.roads.forEach((function(e){for(var t=function(){var t=e.wayPoints[o];t.resources.forEach((function(e){var o=e.vars.nextWayPoint,r=e.vars.realPosition;if(o){var a=i.approach(r,o,e.setting.consts.moveSpeed);a.arrive?(delete a.arrive,e.vars.realPosition=a,e.vars.nextWayPoint=t.nextWayPoint,e.vars.logicPosition=n({},t.position)):(e.vars.realPosition=a,e.vars.logicPosition={x:Math.floor(a.x+.5),y:Math.floor(a.y+.5)})}})),t.resources=[]},o=0;o<e.wayPoints.length;o++)t()}));for(var a,s=t(e.entities.resourceList);!(a=s()).done;){var c,u=a.value;if(!u.alive)return;var f=u.vars.logicPosition;null==(c=e.map.getAt(f))||c.resources.push(u)}for(var l,v=t(e.entities.bulletList);!(l=v()).done;){var g=l.value;if(!g.alive)return;if(!g.target.alive)return;var m=i.approach(g.realPosition,g.target.vars.realPosition,g.moveSpeed);m.arrive?(o.apply(g.target,g),r.deRegisterBullet(g)):g.realPosition=m}},i.nextWaveLogic=function(e,n){void 0===n&&(n=!1);var i=e.wavesInfo,r=i.nextPtr<i.waves.length?i.waves[i.nextPtr]:null;if(r&&(n||r.ticket<=e.tick)){if(r.info.length!=e.place.starts.length)throw new Error("波次数据和出生点数量不一致");i.nextPtr++,e.place.starts.forEach((function(n,i){var o=n.module.vars;o.index<o.wave.length?o.wave.splice(0,o.index):o.wave=[],o.index=0;for(var a,s=r.info[i],c=t(s);!(a=c()).done;){var u=a.value;if(u.name){var f=e.managers.gameEntityManager.createResource(u.name,u.complexity,u.ext);o.wave.push(f),f&&(e.entities.resources[f.eid]=f)}else if(u.__nop__)for(var l=0;l<u.__nop__;l++)o.wave.push(void 0)}})),e.entities.moduleList.filter((function(e){return e.alive&&e.setting.funcs.onNewWave})).forEach((function(t){e.managers.functionManager.getFunction((function(e){return e.module.onNewWave}),t.setting.funcs.onNewWave)(e,t)}))}else if(!n&&!r&&this.hasNoResources(e))throw new o(!0)},i.hasNoResources=function(e){return!e.entities.resourceList.length&&e.place.starts.every((function(e){var t=e.module.vars;return t.index>=t.wave.length}))},i.entityAliveJudgeLogic=function(e){e.entities.moduleList=e.entities.moduleList.filter((function(e){return e.alive})),e.entities.resourceList=e.entities.resourceList.filter((function(e){return e.alive})),e.entities.bulletList=e.entities.bulletList.filter((function(e){return e.alive}))},i.debuggerChecker=function(e){e.asset.hp.cur<=0&&e.alive&&console.warn("context 存活状态异常 ",e.asset.hp.cur,e.alive)},e}());i._RF.pop()}}}));

System.register("chunks:///_virtual/GameLogicUtils.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EnumDefine.ts","./BuffDefine.ts","./EventDefine.ts"],(function(e){var t,n,i,o,r,s,a,u,f;return{setters:[function(e){t=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy},function(e){i=e.bindAll,o=e.differObject2,r=e.JSON,s=e.assert},function(e){a=e.RangeTypeEnum},function(e){u=e.ResourceBuff},function(e){f=e.GameLogicEvent}],execute:function(){n._RF.push({},"7b66afG9BVCMbGK8oqUpg63","GameLogicUtils",void 0);e("GameLogicUtils",function(){function e(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.gameEntityManager=void 0,this.doDamageToResourceOptions={modifyAble:!0,dieAble:!1},this.direction4=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}]}var n=e.prototype;return n.setContext=function(e){this.context=e,this.settingDataManager=e.managers.settingDataManager,this.functionManager=e.managers.functionManager,this.eventBus=e.managers.eventBus,this.gameEntityManager=e.managers.gameEntityManager,i(this)},n.addBuffToResource=function(e,n,i){var s,a=this.settingDataManager.getResourceBuff(n);if(a){var f={name:a.name,setting:a,vars:null!=i?i:{},resource:e},c=e.buffs.findIndex((function(e){return e.name===a.name})),l=u.RepeatedBuffResolutionEnum,g=null!=(s=a.func.onRepeated)?s:l.REPLACE;c<0&&(g=l.IGNORE);var v=["leftTime","leftTimes"];if(l.IGNORE===g)e.buffs.push(f);else if(l.REPLACE===g)e.buffs[c];else if(l.ABANDON===g);else if(l.NUM_ADD===g){var h=e.buffs[c],m=o(h.vars,f.vars);if(m.delete.length||m.add.length)throw new Error("buff 合并失败 "+l.NUM_ADD+"  "+r.stringify(h)+"  "+r.stringify(f)+"  不能和差异数据");for(var y,p={},d=t(m.modify);!(y=d()).done;){var x=y.value,M=x.key,E=x.oldObj,R=x.newObj;if(v.includes(M)){if(E!==R)throw new Error("buff 合并失败 "+l.NUM_ADD+"  "+r.stringify(h)+"  "+r.stringify(f)+"  不能有不同的生命周期参数"+M+" 剩余时间等");p[M]=E}else{if(typeof E!=typeof R||"number"!=typeof E)throw new Error("buff 合并失败 "+l.NUM_ADD+"  "+r.stringify(h)+"  "+r.stringify(f)+"  key"+M+" 必须是数字");p[M]=E+R}}e.buffs[c].vars=p}else{var b=this.functionManager.getFunction((function(e){return e.resource.buff.onRepeat}),a.func.onRepeated);b&&(e.buffs[c]=b(this.context,e.buffs[c],f))}}},n.damageToHome=function(e){if(s(e>=0),0!=e){var t=this.context.asset.hp;t.cur-=e,t.cur<=0&&(this.context.alive=!1)}},n.checkResourceBuffDestroy=function(e){var t=this;e.buffs=e.buffs.filter((function(n){var i,o=void 0;return e.alive||(o=u.BuffDestroyReasonEnum.RESOURCE_DESTROY),void 0!==n.vars.leftTime&&n.vars.leftTime<=0&&(o=u.BuffDestroyReasonEnum.TIME),void 0!==n.vars.leftTimes&&n.vars.leftTimes<=0&&(o=u.BuffDestroyReasonEnum.TIMES),!o||(null==(i=t.functionManager.getFunction((function(e){return e.resource.buff.onDestroy}),n.setting.func.onDestroy))||i(t.context,n.resource,n,o),!1)}))},n.doMultipleToResource=function(e,t){if(s(t>0),0==e.alive)return 0;var n=e.vars.complexity,i=e.vars.complexity*t;return i=Math.max(Math.floor(i),1),e.vars.complexity=i,i-n},n.changeResourceType=function(e,t){var n=this.settingDataManager.getResource(t);if(!n)throw new Error("changeResourceType no setting name:"+t);e.name=n.name,e.setting=n},n.addAsset=function(e,t){if(s(t>0),0!=t){var n=this.context.asset[e],i=n.cur;n.cur=Math.min(i+t,n.max);var o={original:i,current:n.cur,wantAmount:t};this.eventBus.pub(f.ASSET_USE,o)}},n.canUseAsset=function(e,t){return s(t>0),0==t||!(this.context.asset[e].cur<t)},n.useAsset=function(e,t){if(s(t>0),0==t)return!0;var n=this.context.asset[e],i=n.cur;if(i<t)return!1;n.cur-=t;var o={original:i,current:n.cur,wantAmount:t,forceUse:!1};return this.eventBus.pub(f.ASSET_USE,o),!0},n.countModuleByName=function(e){return this.context.entities.moduleList.filter((function(t){return t.alive&&t.name===e})).length},n.getAround4=function(e){var t=this.context.map,n=[];return this.direction4.forEach((function(i){var o=t.mapUnits[e.y+i.y];o?n.push(o[e.x+i.x]):n.push(void 0)})),n},n.healToHome=function(e){if(s(e>=0),e){var t=this.context.asset.hp;t.cur+=Math.max(Math.min(e,t.max-t.cur),0)}},n.isMatchEffect=function(e,t){var n,i,o=this.context.managers.functionManager.getFunction((function(e){return e.resource.selector}),null!=(n=null==(i=t.setting.consts.effect)||null==(i=i.resourceSelector)?void 0:i.funcName)?n:"default");return!!o&&o(this.context,e,t)},n.isInRange=function(e,t){var n,i,o=null==(n=t.setting.consts.effect)?void 0:n.range;return!!o&&(o.type===a.SELF?e.vars.logicPosition.x===t.position.x&&e.vars.logicPosition.y===t.position.y:o.type===a.AROUND?Math.abs(e.vars.logicPosition.x-t.position.x)+Math.abs(e.vars.logicPosition.y-t.position.y)<=1:o.type===a.CIRCULAR&&Math.pow(e.vars.realPosition.x-t.position.x,2)+Math.pow(e.vars.realPosition.y-t.position.y,2)<=Math.pow(null!=(i=o.range)?i:1,2))},e}());n._RF.pop()}}}));

System.register("chunks:///_virtual/Global.ts",["cc"],(function(){var t;return{setters:[function(c){t=c.cclegacy}],execute:function(){t._RF.push({},"94178Nhx+hEb6UYHwHAQo+1","Global",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/GlobalContextImpl.ts",["cc","./TranslateManager.ts"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy},function(t){n=t.TranslateManager}],execute:function(){e._RF.push({},"e2256zqChxOG7/BBwE9t4A4","GlobalContextImpl",void 0);var i=function(){function t(){this.levels={}}var e=t.prototype;return e.addLevel=function(t){this.levels[t.name]=t},e.getLevels=function(){return Object.values(this.levels)},e.getLevel=function(t){return this.levels[t]},t}();t("GlobalContext",new(function(){function t(){this.logic=void 0,this.context=void 0,this.levelManager=new i,this.translateManager=new n,this.gameUpdateTimer=void 0}var e=t.prototype;return e.setGameContext=function(t){t?(this.logic=t,this.context=t.gameContext,this.gameUpdateTimer&&clearTimeout(this.gameUpdateTimer)):(this.logic=void 0,this.context=void 0)},e.run=function(){var t=this;this.logic&&(this.logic.nextTick(),this.gameUpdateTimer=setTimeout((function(){t.run()}),1e3))},t}()));e._RF.pop()}}}));

System.register("chunks:///_virtual/GlobalInputEventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewGlobal.ts"],(function(n){var t,e,o,i,s,u,a,p;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator,i=n.Input,s=n.input,u=n.NodeEventType,a=n.Component},function(n){p=n.UIGlobalContext}],execute:function(){var r;e._RF.push({},"bcceeeXtw9MwKkTM7PMBxKX","GlobalInputEventManager",void 0);var E=o.ccclass;o.property,n("GlobalInputEventManager",E("GlobalInputEventManager")(r=function(n){function e(){return n.apply(this,arguments)||this}t(e,n);var o=e.prototype;return o.mouseDown=function(n){p.globalUIEvent.pub(i.EventType.MOUSE_DOWN,n)},o.mouseUp=function(n){p.globalUIEvent.pub(i.EventType.MOUSE_UP,n)},o.mouseMove=function(n){p.globalUIEvent.pub(i.EventType.MOUSE_MOVE,n)},o.manageEvent=function(n){var t=n?s.on.bind(s):s.off.bind(s),e=n?this.node.on.bind(this.node):this.node.off.bind(this.node);t(i.EventType.MOUSE_DOWN,this.mouseDown,this),t(i.EventType.MOUSE_UP,this.mouseUp,this),t(i.EventType.MOUSE_MOVE,this.mouseMove,this),e(u.MOUSE_DOWN,this.mouseDown,this),e(u.MOUSE_UP,this.mouseUp,this),e(u.MOUSE_MOVE,this.mouseMove,this)},o.start=function(){this.manageEvent(!0)},o.onDestroy=function(){this.manageEvent(!1)},e}(a))||r);e._RF.pop()}}}));

System.register("chunks:///_virtual/HarmlessProcessor.ts",["cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,t,c,r,s,o;return{setters:[function(e){n=e.cclegacy},function(e){t=e.GroundTypeEnum,c=e.RangeTypeEnum},function(e){r=e.CommonResourceSelector},function(e){s=e.ModuleName,o=e.TResourceType}],execute:function(){e("run",(function(e,n){e(u),n((function(e){return e.module.effect}),u.name,(function(e,n,t){n.setting.consts}))})),n._RF.push({},"bcd5e3cdwtPEpG9lBRPiqvs","HarmlessProcessor",void 0);var u={name:s.HARMLESS_PROCESSOR,groundType:t.INSULATION,funcs:{},consts:{effect:{range:{type:c.AROUND,range:1},resourceSelector:{resourceTypeFilter:[o.COMMON]},triggerInterval:60,funcName:r.name},ability:2,healAbility:1,buildAble:{cost:40}},desc:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/IndependentProcessor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,t,i,r,o,c,u,s;return{setters:[function(e){n=e.extends},function(e){t=e.cclegacy},function(e){i=e.ModuleEffectTypeEnum,r=e.GroundTypeEnum,o=e.RangeTypeEnum},function(e){c=e.FRAME_RATE},function(e){u=e.ModuleName,s=e.TResourceType}],execute:function(){e("run",(function(e,t){e(a),t((function(e){return e.module.effect}),a.name,(function(e,t,r){var o=t.setting.consts,u=e.managers.gameLogicUtil.getAround4(t.position).filter((function(e){return null==e?void 0:e.module})).length,s=o.ability+(u?0:o.increaseAbility);e.managers.gameEntityManager.createAndRegisterBullet({effectType:i.PROCESS,ability:{processAbility:s},moveSpeed:2/c,realPosition:n({},t.position),target:r})}))})),t._RF.push({},"ef1c8qdZW1LSqWz0IGH8y+M","IndependentProcessor",void 0);var a={name:u.INDEPENDENT_PROCESSOR,groundType:r.INSULATION,funcs:{},consts:{effect:{range:{type:o.AROUND,range:1},resourceSelector:{resourceTypeFilter:[s.COMMON]},triggerInterval:60,funcName:u.INDEPENDENT_PROCESSOR},ability:1,increaseAbility:2,buildAble:{cost:40}},desc:{}};t._RF.pop()}}}));

System.register("chunks:///_virtual/InfoVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./EnumDefine.ts","./common.ts","./UIUtilities.ts","./ViewGlobal.ts"],(function(e){var i,t,n,o,l,r,a,u,s,d,c,m,p,f,g,b;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){l=e.cclegacy,r=e._decorator,a=e.Node,u=e.RichText,s=e.Label,d=e.Component},function(e){c=e.GlobalContext},function(e){m=e.TranslateScope},function(e){p=e.Timer},function(e){f=e.translateSettingString},function(e){g=e.InputMode,b=e.UIGlobalContext}],execute:function(){var y,I,v,x,T,D,N,h,M,F,w,E,z,O,U,_,A,C,L,B,S;l._RF.push({},"e5585OMnTFNwJ4Fq1DKaZyw","InfoVMgr",void 0);var R=r.ccclass,G=r.property;e("InfoVMgr",(y=R("InfoVMgr"),I=G({type:a,displayName:"地面信息面板"}),v=G({type:u,displayName:"地面信息文本"}),x=G({type:a,displayName:"模块信息面板"}),T=G({type:u,displayName:"模块名称文本"}),D=G({type:u,displayName:"模块描述文本"}),N=G({type:a,displayName:"资源信息面板"}),h=G({type:u,displayName:"资源名称文本"}),M=G({type:u,displayName:"资源描述文本"}),F=G({type:a,displayName:"建筑信息面板"}),y((z=i((E=function(e){function i(){for(var i,t=arguments.length,l=new Array(t),r=0;r<t;r++)l[r]=arguments[r];return i=e.call.apply(e,[this].concat(l))||this,n(i,"groundInfoForm",z,o(i)),n(i,"groundInfoText",O,o(i)),n(i,"moduleInfoForm",U,o(i)),n(i,"moduleNameText",_,o(i)),n(i,"moduleDescText",A,o(i)),n(i,"resourceInfoForm",C,o(i)),n(i,"resourceNameText",L,o(i)),n(i,"resourceDescText",B,o(i)),n(i,"buildingInfoForm",S,o(i)),i.buildingDescText=void 0,i.fixUpdateTimer=new p,i}t(i,e);var l=i.prototype;return l.loadRef=function(){var e;!this.buildingDescText&&(this.buildingDescText=null==(e=this.buildingInfoForm.getChildByName("TextDesc"))?void 0:e.getComponent(s))},l.start=function(){this.loadRef()},l.update=function(e){var i;if(this.fixUpdateTimer.addWait(e,.1)){var t=b.myInputSystem,n=c.context;if(n){var o=null!=(i=null==t?void 0:t.clickedPosition)?i:null==t?void 0:t.position,l=n.map.getAt(o),r=n.managers.translateManager.$;if(this.groundInfoForm.active=!!l&&t.inputMode==g.NONE){var a="地面类型: "+r(m.GROUND_NAME,l.groundType);this.groundInfoText.string=a}if((this.moduleInfoForm.active=!(null==l||!l.module)&&t.inputMode==g.NONE)&&(this.moduleNameText.string="模块: "+r(m.MODULE_NAME,l.module.name),this.moduleDescText.string="描述: ?"),t.inputMode===g.NONE){if(this.buildingInfoForm.active=!!t.mouseOverBuildAble){var u=n.managers.settingDataManager.getModule(t.mouseOverBuildAble);this.buildingDescText.string=f(n,m.MODULE_DESC,null==u?void 0:u.desc,u)}}else if(t.inputMode===g.BUILD_MODULE){if(this.buildingInfoForm.active=!!t.clickedBuildAble){var s=n.managers.settingDataManager.getModule(t.clickedBuildAble);this.buildingDescText.string=f(n,m.MODULE_DESC,null==s?void 0:s.desc,s)}}else this.buildingInfoForm.active=!1}}},i}(d)).prototype,"groundInfoForm",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=i(E.prototype,"groundInfoText",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=i(E.prototype,"moduleInfoForm",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=i(E.prototype,"moduleNameText",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=i(E.prototype,"moduleDescText",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=i(E.prototype,"resourceInfoForm",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=i(E.prototype,"resourceNameText",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=i(E.prototype,"resourceDescText",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=i(E.prototype,"buildingInfoForm",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=E))||w));l._RF.pop()}}}));

System.register("chunks:///_virtual/lan.ts",["cc","./EnumDefine.ts","./define.ts"],(function(E){var O,A,N,n,R,M,S;return{setters:[function(E){O=E.cclegacy},function(E){A=E.LangEnum,N=E.TranslateScope,n=E.GroundTypeEnum},function(E){R=E.ModuleName,M=E.ResourceName,S=E.ResourceBuffName}],execute:function(){E("init",(function(E){var O=E.$;if(E.lang!==A.CN)return;O(N.MODULE_NAME,R.END,"基地"),O(N.MODULE_NAME,R.START,"入口"),O(N.MODULE_NAME,R.PROCESSOR,"初级处理"),O(N.MODULE_NAME,R.FLIP,"初级翻转"),O(N.MODULE_NAME,R.ANALYZER,"初级分析"),O(N.MODULE_NAME,R.INDEPENDENT_PROCESSOR,"初级独立处理"),O(N.MODULE_NAME,R.COLLABORATIVE_PROCESSOR,"初级协同处理"),O(N.MODULE_NAME,R.HARMLESS_PROCESSOR,"初级无害化处理"),O(N.MODULE_NAME,R.RECYCLE,"初级回收"),O(N.MODULE_NAME,R.POLE_TRANSMISSION,"电极传输"),O(N.RESOURCE_NAME,M.META_DATA,"元数据"),O(N.RESOURCE_NAME,M.PERSISTENT_DATA,"持久数据"),O(N.RESOURCE_NAME,M.VOLATILE_DATA,"易失数据"),O(N.GROUND_NAME,n.INSULATION,"板面"),O(N.GROUND_NAME,n.WIRE,"导线"),O(N.GROUND_NAME,n.NONE,"未知"),O(N.GROUND_NAME,n.POLE,"电极"),O(N.BUFF_NAME,S.ReduceComplexity,"还原"),O(N.BUFF_NAME,S.ANALYZED,"被分析"),O(N.MODULE_DESC,R.PROCESSOR,"每[c.turn]回合 处理:[c.ability]"),O(N.MODULE_DESC,R.INDEPENDENT_PROCESSOR,"每[c.turn]回合 处理:[c.ability]\n如果四周没有其他模块,则 + [c.increaseAbility]"),O(N.MODULE_DESC,R.COLLABORATIVE_PROCESSOR,"每[c.turn]回合 处理:[c.ability]\n四周每有一个模块, + [c.increaseAbility]"),O(N.MODULE_DESC,R.FLIP,"每[c.turn]回合翻转数据\n持久数据 复杂度变为1/[c.multiples]\n易失数据 复杂度变为[c.multiples]"),O(N.MODULE_DESC,R.ANALYZER,"每[c.turn]回合给数据施加[c.ability]层被分析\n被分析:被处理时,复杂度额外降低n点,n为层数,每次生效减少一层"),O(N.MODULE_DESC,R.HARMLESS_PROCESSOR,"每[c.turn]回合 处理:[c.ability]\n如果销毁资源,然后恢复[c.healAbility]"),O(N.MODULE_DESC,R.RECYCLE,"每[c.turn]回合 销毁复杂度<=[c.ability]的资源,然后恢复[c.healAbility]生命值"),O(N.MODULE_DESC,R.POLE_TRANSMISSION,"每新波次回合 获得[c.value]价值")})),O._RF.push({},"c27e7ABUqxNeLkH+lXc3Jx2","lan",void 0),O._RF.pop()}}}));

System.register("chunks:///_virtual/Level.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"41b55t88tRH7ahl264EIlKF","Level",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/LevelItemVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./EnumDefine.ts"],(function(e){var t,n,i,o,r,l,a,c,s,u,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,a=e.Label,c=e.NodeEventType,s=e.Component},function(e){u=e.GlobalContext},function(e){p=e.TranslateScope}],execute:function(){var v,f,h,d,m;r._RF.push({},"00e13zBT/RFwbMKzVydO/2B","LevelItemVMgr",void 0);var y=l.ccclass,g=l.property;e("LevelItemVMgr",(v=y("LevelItemVMgr"),f=g({type:a}),v((m=t((d=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,i(t,"nameText",m,o(t)),t.level=void 0,t.onSelected=void 0,t}n(t,e);var r=t.prototype;return r.start=function(){},r.update=function(e){},r.init=function(e,t){this.level=e,this.onSelected=t,this.node.on(c.MOUSE_DOWN,this.onClick,this),this.nameText.string=u.translateManager.$(p.G_LEVEL_NAME,e.name)},r.onClick=function(){this.onSelected(this.level)},t}(s)).prototype,"nameText",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=d))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/LogicSystem.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"d36e32FqAZA5J5L97PP0ESu","LogicSystem",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./GameLogic.ts","./GameContextBuilder.ts","./BuildingManager.ts","./DamageManager.ts","./EventBus.ts","./FunctionManager.ts","./GameEntityManager.ts","./GameLogicUtils.ts","./MapUtil.ts","./ResearchManager.ts","./SettingDataManager.ts","./TranslateManager.ts","./GlobalContextImpl.ts","./common.ts","./EnumDefine.ts","./BuffDefine.ts","./EventDefine.ts","./GameData.ts","./GameEntity.ts","./Global.ts","./Level.ts","./LogicSystem.ts","./Mod2.ts","./SettingData.ts","./funcs.ts","./buff.ts","./main3.ts","./define.ts","./Analyzer.ts","./CollaborativeProcessor.ts","./End.ts","./Flip.ts","./HarmlessProcessor.ts","./IndependentProcessor.ts","./PolePowerStation.ts","./Processor.ts","./Recycle.ts","./Start.ts","./main4.ts","./main2.ts","./lan.ts","./main.ts","./mod.ts","./research.ts","./BottomMenuVMgr.ts","./CameraManager.ts","./GlobalInputEventManager.ts","./RenderManager.ts","./ResourceVMgr.ts","./UIUtilities.ts","./ViewGlobal.ts","./ModuleVMgr.ts","./MapUnitManager.ts","./AssetVMgr.ts","./BottomRightMenuVMgr.ts","./InfoVMgr.ts","./WaveInfoVMgr.ts","./BuildingItemVMgr.ts","./BuildingVMgr.ts","./LevelItemVMgr.ts","./SelectLevelVMgr.ts","./debug-view-runtime-control.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/main.ts",["cc","./define.ts"],(function(e){var c,t,n;return{setters:[function(e){c=e.cclegacy},function(e){t=e.ModuleName,n=e.ResourceName}],execute:function(){c._RF.push({},"1777cN0rQ1G05yHHSu+Bl7E","main",void 0);var a=[{name:n.META_DATA,complexity:2},{name:n.META_DATA,complexity:3},{__nop__:3}],i=[{name:n.META_DATA,complexity:3},{name:n.META_DATA,complexity:2},{__nop__:3}],u={name:"教程-处理",desc:"学习基础操作",width:6,height:4,waves:[{ticket:5,info:[[].concat(a,i,a,i,a,i,a,i,a,i,a,i)]}],wayPoints:[[{x:0,y:0},{x:2,y:0},{x:2,y:3},{x:5,y:3}]],asset:{hp:{cur:10,max:10},value:{cur:70,max:70},energy:{cur:0,max:0},baseResearch:{cur:0,max:0}},difficulty:0,limitModule:[t.PROCESSOR,t.COLLABORATIVE_PROCESSOR,t.INDEPENDENT_PROCESSOR],grounds:[]};e("levels",[u]);c._RF.pop()}}}));

System.register("chunks:///_virtual/main2.ts",["cc","./main3.ts","./define.ts"],(function(e){var n,a,c,s;return{setters:[function(e){n=e.cclegacy},function(e){a=e.FRAME_RATE},function(e){c=e.ResourceName,s=e.TResourceType}],execute:function(){e("init",(function(e,n,a){e.addResource(u),e.addResource(o),e.addResource(d)})),n._RF.push({},"2b616+aPHVIxbH6YSzB7pfW","main",void 0);var u={name:c.META_DATA,resourceType:s.COMMON,funcs:{},consts:{damage:2,addValue:5,moveSpeed:.5/a}},o={name:c.PERSISTENT_DATA,resourceType:s.COMMON,funcs:{},consts:{damage:2,addValue:8,moveSpeed:.5/a}},d={name:c.VOLATILE_DATA,resourceType:s.COMMON,funcs:{},consts:{damage:2,addValue:2,moveSpeed:.5/a}};n._RF.pop()}}}));

System.register("chunks:///_virtual/main3.ts",["cc","./EnumDefine.ts"],(function(e){var n,t,c;return{setters:[function(e){n=e.cclegacy,t=e.assert},function(e){c=e.AssetName}],execute:function(){e("init",(function(e,n){var t=[r];e.addFunction((function(e){return e.resource.selector}),"default",r.func),t.forEach((function(n){e.addFunction((function(e){return e.resource.selector}),n.name,n.func)})),[o].forEach((function(n){e.addFunction((function(e){return e.module.onNewWave}),n.name,n.func)}))})),n._RF.push({},"59f76bX7fpKzZ6uNJTA9OcJ","main",void 0);var r=e("CommonResourceSelector",{name:"CommonResourceSelector",func:function(e,n,c){t(!!c.setting.consts.effect);var r=c.setting.consts.effect.resourceSelector,o=!0;return o&&r.resourceTypeFilter&&(o=r.resourceTypeFilter.includes(n.setting.resourceType)),o&&r.resourceNameFilter&&(o=r.resourceNameFilter.includes(n.setting.name)),o&&r.maxComplexity&&(o=n.vars.complexity<=r.maxComplexity),o&&r.minComplexity&&(o=n.vars.complexity>=r.minComplexity),o}}),o=e("AddValuePerWave",{name:"AddValuePerWave",func:function(e,n){var t=n.setting.consts;e.managers.gameLogicUtil.addAsset(c.VALUE,t.value)}});e("FRAME_RATE",20);n._RF.pop()}}}));

System.register("chunks:///_virtual/main4.ts",["cc","./Analyzer.ts","./CollaborativeProcessor.ts","./End.ts","./Flip.ts","./HarmlessProcessor.ts","./IndependentProcessor.ts","./PolePowerStation.ts","./Processor.ts","./Recycle.ts","./Start.ts"],(function(n){var t,o,u,r,c,e,i,s,a,f,l;return{setters:[function(n){t=n.cclegacy},function(n){o=n.run},function(n){u=n.run},function(n){r=n.run},function(n){c=n.run},function(n){e=n.run},function(n){i=n.run},function(n){s=n.run},function(n){a=n.run},function(n){f=n.run},function(n){l=n.run}],execute:function(){n("init",(function(n,t,d){var P=function(o){n.addModule(o),o.consts.buildAble&&t.addBuildAble(o.name)};function m(n,t,o){d.managers.functionManager.addFunction(n,t,o)}[a,i,u,c,o,r,e,s,f,l].forEach((function(n){return n(P,m)}))})),t._RF.push({},"87cfe1qPBlHHqz+jUokB7kw","main",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/MapUnitManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./common.ts","./ViewGlobal.ts","./EnumDefine.ts"],(function(t){var o,n,i,e,s,u,c,a,p,l,r,d,h;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,e=t.Sprite,s=t.Node,u=t.Color,c=t.assert,a=t.Component},function(t){p=t.GlobalContext},function(t){l=t.MyPointClass},function(t){r=t.UIGlobalContext,d=t.InputMode},function(t){h=t.GroundTypeEnum}],execute:function(){var f;n._RF.push({},"c45fc6OVdNERImkTY6az4/W","MapUnitManager",void 0);var M=i.ccclass;t("MapUnitManager",M("MapUnitManager")(f=function(t){function n(){for(var o,n=arguments.length,i=new Array(n),e=0;e<n;e++)i[e]=arguments[e];return(o=t.call.apply(t,[this].concat(i))||this).bg=void 0,o.mapUnit=void 0,o.position=void 0,o}o(n,t);var i=n.prototype;return i.loadRef=function(){!this.bg&&(this.bg=this.getComponent(e))},i.start=function(){this.loadRef()},i.update=function(t){this.mapUnit},i.init=function(t){this.loadRef(),this.node.on(s.EventType.MOUSE_ENTER,this.onMouseEnter,this),this.node.on(s.EventType.MOUSE_LEAVE,this.onMouseOut,this),this.node.on(s.EventType.MOUSE_UP,this.onMouseClick,this),this.position=t.position,this.bg.color=t.groundType==h.INSULATION?new u(102,153,153):t.groundType==h.POLE?u.YELLOW:new u(187,140,68),this.mapUnit=t},i.onMouseEnter=function(t){r.myInputSystem.position=this.position},i.onMouseOut=function(t){this.position&&l.equals(this.position,r.myInputSystem.position)&&(r.myInputSystem.position=void 0)},i.onMouseClick=function(t){var o=r.myInputSystem;if(p.context&&p.context.alive)if(o.inputMode==d.BUILD_MODULE&&0==t.getButton()){c(!!o.clickedBuildAble,"建筑模式应该有选择的建筑");var n=p.context.managers.buildingManager.buildModule(p.context.map.getAt(this.position),o.clickedBuildAble);o.inputMode=d.NONE,o.clickedBuildAble=void 0,console.log("建造完成",JSON.stringify(n))}else o.inputMode==d.NONE&&0==t.getButton()&&(o.clickedPosition==this.position?o.clickedPosition=void 0:o.clickedPosition=this.position)},i.onDestroy=function(){this.node.off(s.EventType.MOUSE_UP,this.onMouseEnter,this),this.node.off(s.EventType.MOUSE_LEAVE,this.onMouseOut,this)},n}(a))||f);n._RF.pop()}}}));

System.register("chunks:///_virtual/MapUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts"],(function(t){var n,a,i;return{setters:[function(t){n=t.extends},function(t){a=t.cclegacy},function(t){i=t.bindAll}],execute:function(){a._RF.push({},"ffa52GU2SxFV7QZQzfXKabu","MapUtil",void 0);t("MapUtil",function(){function t(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.gameEntityManager=void 0,this.buffManager=void 0,this.gameLogicUtils=void 0}var a=t.prototype;return a.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.functionManager=t.managers.functionManager,this.eventBus=t.managers.eventBus,this.gameEntityManager=t.managers.gameEntityManager,this.buffManager=t.managers.buildingManager,this.gameLogicUtils=t.managers.gameLogicUtil,i(this)},a.inMap=function(t,n,a){return n>=0&&n<t.sizeX&&a>=0&&a<t.sizeY},a.distance2=function(t,n){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},a.approach=function(t,a,i){var e=this.distance2(t,a);if(e<=i)return n({},a,{arrive:!0});var s=i/e;return{x:t.x+(a.x-t.x)*s,y:t.y+(a.y-t.y)*s}},t}());a._RF.pop()}}}));

System.register("chunks:///_virtual/mod.ts",["cc","./EnumDefine.ts","./Mod2.ts","./buff.ts","./main3.ts","./define.ts","./main4.ts","./main2.ts","./lan.ts","./main.ts","./research.ts"],(function(e){var n,t,a,i,o,r,c,u,s,l,d;return{setters:[function(e){n=e.cclegacy},function(e){t=e.GroundTypeEnum},function(e){a=e.ModInfoClass},function(e){i=e.init},function(e){o=e.init},function(e){r=e.ModuleName,c=e.ResourceName},function(e){u=e.init},function(e){s=e.init},function(e){l=e.init},function(e){d=e.levels},null],execute:function(){var f;n._RF.push({},"f3ceb7gYblEyo11MaQKOPIw","mod",void 0);e("ModInfo",a(f=function(){function e(){this.name="core",this.desc="",this.dependence=[],this.conflict=[],this.version="0.0.1"}var n=e.prototype;return n.onLoad=function(){console.log("core loaded")},n.onApplicationLoaded=function(e,n,a){var i=[{x:0,y:0},{x:7,y:0},{x:7,y:7}],o={name:"demo",desc:"测试地图哦",width:8,height:8,difficulty:1,waves:[{ticket:5,info:[[{name:c.META_DATA,complexity:20}]]}],wayPoints:[i],grounds:[{pos:{x:2,y:2},ground:t.POLE}],asset:{hp:{cur:100,max:100},energy:{cur:100,max:100},value:{cur:1e3,max:1e3},baseResearch:{cur:100,max:100}}};a.levelManager.addLevel(o),d.forEach((function(e){a.levelManager.addLevel(e)}))},n.onGameContextCreated=function(e,n,t){var a=e.managers,c=a.gameEntityManager,d=a.translateManager,f=a.functionManager,m=a.settingDataManager,g=a.buildingManager,v=e.map;s(m),u(m,g,e),l(d),i(f,m),o(f),c.registerModule(c.createModule(r.START),v.mapUnits[0][0]),c.registerModule(c.createModule(r.END),v.mapUnits[v.sizeY-1][v.sizeX-1]),e.place.ends=v.filter((function(e){var n;return(null==(n=e.module)?void 0:n.name)==r.END})),e.place.starts=v.filter((function(e){var n;return(null==(n=e.module)?void 0:n.name)==r.START}))},e}())||f);n._RF.pop()}}}));

System.register("chunks:///_virtual/Mod2.ts",["cc"],(function(n){var o;return{setters:[function(n){o=n.cclegacy}],execute:function(){o._RF.push({},"f3452ROgKZGo5l7ggIy4NCF","Mod",void 0);var t=n("Mods",[]);n("ModInfoClass",(function(n){var o=new n;t.push(o)}));o._RF.pop()}}}));

System.register("chunks:///_virtual/ModuleVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnumDefine.ts"],(function(e){var t,i,n,r,a,o,l,c,s,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,l=e.RichText,c=e.Sprite,s=e.Component},function(e){f=e.TranslateScope}],execute:function(){var u,p,d,h,g,v,y;a._RF.push({},"0c4809RZZBIxo/PQieuBmnE","ModuleVMgr",void 0);var m=o.ccclass,M=o.property;e("ModuleVMgr",(u=m("ModuleVMgr"),p=M({type:l}),d=M({type:c,displayName:"效果进度条"}),u((v=t((g=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,n(t,"nameText",v,r(t)),n(t,"effectBar",y,r(t)),t.entity=void 0,t.mapUnit=void 0,t}i(t,e);var a=t.prototype;return a.start=function(){},a.initNew=function(e,t){var i=e.managers.translateManager.$,n=t.module;this.nameText.string=i(f.MODULE_NAME,n.name),this.entity=n,this.mapUnit=t},a.update=function(e){this.entity&&this.renderEffectColdDown()},a.renderEffectColdDown=function(){var e,t;if(this.entity.setting.consts.effect){this.effectBar.node.active=!0;var i=null==(e=this.entity.setting.consts.effect)?void 0:e.triggerInterval,n=null==(t=this.entity.vars.effect)?void 0:t.coldDown;if(i&&n){var r=(i-n)/i;this.effectBar.fillRange=r}else this.effectBar.fillRange=1}else this.effectBar.node.active=!1},t}(s)).prototype,"nameText",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=t(g.prototype,"effectBar",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g))||h));a._RF.pop()}}}));

System.register("chunks:///_virtual/PolePowerStation.ts",["cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,t,u,o;return{setters:[function(e){n=e.cclegacy},function(e){t=e.GroundTypeEnum},function(e){u=e.AddValuePerWave},function(e){o=e.ModuleName}],execute:function(){e("run",(function(e,n){e(c)})),n._RF.push({},"f73ca9/mJlIkJ51PlGyzYpR","PolePowerStation",void 0);var c={name:o.POLE_TRANSMISSION,groundType:t.POLE,funcs:{onNewWave:u.name},consts:{value:20,buildAble:{cost:50}},desc:{name:o.POLE_TRANSMISSION}};n._RF.pop()}}}));

System.register("chunks:///_virtual/Processor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,t,r,o,c,i,s,u;return{setters:[function(e){n=e.extends},function(e){t=e.cclegacy},function(e){r=e.ModuleEffectTypeEnum,o=e.GroundTypeEnum,c=e.RangeTypeEnum},function(e){i=e.FRAME_RATE},function(e){s=e.ModuleName,u=e.TResourceType}],execute:function(){e("run",(function(e,t){e(a),t((function(e){return e.module.effect}),a.name,(function(e,t,o){var c=t.setting.consts;e.managers.gameEntityManager.createAndRegisterBullet({effectType:r.PROCESS,ability:{processAbility:c.ability},moveSpeed:2/i,realPosition:n({},t.position),target:o})}))})),t._RF.push({},"a2c7eILobdHhrbeiRyUsdP8","Processor",void 0);var a={name:s.PROCESSOR,groundType:o.INSULATION,funcs:{},consts:{effect:{range:{type:c.AROUND,range:1},resourceSelector:{resourceTypeFilter:[u.COMMON]},triggerInterval:60,funcName:s.PROCESSOR},buildAble:{cost:30},ability:2},desc:{}};t._RF.pop()}}}));

System.register("chunks:///_virtual/Recycle.ts",["cc","./EnumDefine.ts","./define.ts"],(function(e){var n,t,c,r,u;return{setters:[function(e){n=e.cclegacy},function(e){t=e.GroundTypeEnum,c=e.RangeTypeEnum},function(e){r=e.ModuleName,u=e.TResourceType}],execute:function(){e("run",(function(e,n){e(i),n((function(e){return e.module.effect}),i.name,(function(e,n,t){var c=n.setting.consts;if(t.vars.complexity>c.ability)return{noColdDown:!0}}))})),n._RF.push({},"329f5gXboFLSI7iQDnGGXsd","Recycle",void 0);var i={name:r.RECYCLE,groundType:t.INSULATION,funcs:{},consts:{effect:{range:{type:c.AROUND,range:1},resourceSelector:{resourceTypeFilter:[u.COMMON]},triggerInterval:60,funcName:r.RECYCLE},ability:6,healAbility:2,buildAble:{cost:50}},desc:{name:r.RECYCLE}};n._RF.pop()}}}));

System.register("chunks:///_virtual/RenderManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./common.ts","./ResourceVMgr.ts","./UIUtilities.ts","./ModuleVMgr.ts","./MapUnitManager.ts"],(function(e){var i,t,r,o,n,a,s,u,p,c,l,d,f,m,g;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){n=e.cclegacy,a=e._decorator,s=e.Prefab,u=e.instantiate,p=e.Component},function(e){c=e.GlobalContext},function(e){l=e.differ},function(e){d=e.ResourceVMgr},function(e){f=e.getViewPositionVec3},function(e){m=e.ModuleVMgr},function(e){g=e.MapUnitManager}],execute:function(){var h,M,w,V,v,b,y,P,C;n._RF.push({},"8b898QPN3hLirOHCUF9G9O9","RenderManager",void 0);var R=a.ccclass,z=a.property;e("RenderManager",(h=R("RenderManager"),M=z({type:s,displayName:"模块预制体"}),w=z({type:s,displayName:"空地图块"}),V=z({type:s,displayName:"资源预制体"}),h((y=i((b=function(e){function i(){for(var i,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return i=e.call.apply(e,[this].concat(n))||this,r(i,"modulePrefab",y,o(i)),r(i,"emptyMapPrefab",P,o(i)),r(i,"resourcePrefab",C,o(i)),i.time=void 0,i.mapViews=void 0,i.resourceViews={},i}t(i,e);var n=i.prototype;return n.start=function(){this.time=0,this.render()},n.update=function(e){c.logic&&(this.time+=e,this.time>=.05/c.logic.gameSpeed&&(this.time-=.05/c.logic.gameSpeed,c.logic.nextTick(),this.render()))},n.createMapView=function(e){var i=u(this.emptyMapPrefab);i.parent=this.node;var t=f(e.position);i.position=t;var r=i.getComponent(g);return r.init(e),r},n.createModuleView=function(e,i){var t=u(this.modulePrefab),r=t.getComponent(m);return r.initNew(e,i),t.parent=this.node,t.position=f(i.position),r},n.render=function(){var e=this,i=c.logic.gameContext,t=i.map,r=t.sizeX,o=t.sizeY,n=t.mapUnits;this.initMapViews(o,r,n),this.updateModule(o,r,n,i);var a=l(this.resourceViews,i.entities.resources);a.add.forEach((function(i){var t=u(e.resourcePrefab);t.parent=e.node,t.position=f(i.vars.realPosition);var r=t.getComponent(d);r.init(i),e.resourceViews[i.eid]=r})),a.delete.forEach((function(i){e.resourceViews[i.resource.eid].node.destroy(),delete e.resourceViews[i.resource.eid]}))},n.initMapViews=function(e,i,t){if(!this.mapViews){this.mapViews=[];for(var r=0;r<e;r++){var o=[];this.mapViews.push(o);for(var n=0;n<i;n++){var a=t[r][n];o.push({mapGroundViewMgr:this.createMapView(a),mapUnit:a})}}}},n.updateModule=function(e,i,t,r){if(this.mapViews)for(var o=0;o<e;o++)for(var n=this.mapViews[o],a=0;a<i;a++){var s=n[a],u=t[o][a];s.moduleViewMgr&&!u.module?(s.moduleViewMgr&&s.moduleViewMgr.node.destroy(),n[a].moduleViewMgr=void 0):!s.moduleViewMgr&&u.module&&(n[a].moduleViewMgr=this.createModuleView(r,u))}},i}(p)).prototype,"modulePrefab",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=i(b.prototype,"emptyMapPrefab",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=i(b.prototype,"resourcePrefab",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=b))||v));n._RF.pop()}}}));

System.register("chunks:///_virtual/research.ts",["cc"],(function(c){var e;return{setters:[function(c){e=c.cclegacy}],execute:function(){c("init",(function(c){})),e._RF.push({},"6c9b98Q76VHtJ6oylkfxI40","research",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/ResearchManager.ts",["cc","./common.ts","./EnumDefine.ts"],(function(e){var t,n,s;return{setters:[function(e){t=e.cclegacy},function(e){n=e.bindAll},function(e){s=e.AssetName}],execute:function(){t._RF.push({},"1ec1fRqjixAAqq0rapSjbRj","ResearchManager",void 0);e("ResearchManager",function(){function e(){this.context=void 0,this.researches=[],this.researchesMap={}}var t=e.prototype;return t.getAll=function(){return this.researches},t.unlock=function(e){var t,n=this.researchesMap[e.name];return n||(this.addResearchAble(e),(n=this.researchesMap[e.name]).locked=!0),!n.locked||!!this.context.managers.gameLogicUtil.useAsset(s.RESEARCH_BASE,n.item.cost)&&(this.researchesMap[e.name].locked=!1,this.context.managers.buildingManager.unLockModules(null!=(t=n.item.unLockModules)?t:[]),!0)},t.addResearchAble=function(e){if(!this.researchesMap[e.name]){var t={locked:!0,item:e};this.researchesMap[e.name]=t,this.researches.push(t)}},t.setContext=function(e){this.context=e,n(this)},t.afterGameContextFullInit=function(){var e=new Set(this.researches.flatMap((function(e){return e.item.unLockModules})));this.context.managers.buildingManager.lockModules([].concat(e))},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/ResourceVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIUtilities.ts"],(function(e){var t,r,i,o,n,s,a,c,l,u,p,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){n=e.cclegacy,s=e._decorator,a=e.RichText,c=e.Sprite,l=e.Color,u=e.tween,p=e.Component},function(e){h=e.getViewPositionVec3}],execute:function(){var f,g,v,y,b,d,T;n._RF.push({},"2f81aCXZudNhop8Y3PgzLcA","ResourceVMgr",void 0);var m=s.ccclass,w=s.property;e("ResourceVMgr",(f=m("ResourceVMgr"),g=w({type:a}),v=w({type:c}),f((d=t((b=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return t=e.call.apply(e,[this].concat(n))||this,i(t,"numberText",d,o(t)),i(t,"bgSprite",T,o(t)),t.resource=void 0,t.lastTween=void 0,t}r(t,e);var n=t.prototype;return n.start=function(){},n.init=function(e){this.resource=e,this.numberText.string=""+e.vars.complexity,this.bgSprite.color=l.RED},n.update=function(e){var t=this;if(this.resource&&!this.lastTween){var r=this.resource.vars.realPosition;this.numberText.string=""+this.resource.vars.complexity,r={x:Math.floor(1e3*r.x)/1e3,y:Math.floor(1e3*r.y)/1e3};var i=h(r);this.lastTween=u(this.node),this.lastTween.to(0,{position:i}).call((function(){return t.lastTween=void 0})).start()}},t}(p)).prototype,"numberText",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=t(b.prototype,"bgSprite",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=b))||y));n._RF.pop()}}}));

System.register("chunks:///_virtual/SelectLevelVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameContextBuilder.ts","./GameLogic.ts","./GlobalContextImpl.ts","./EnumDefine.ts","./Mod2.ts","./ViewGlobal.ts","./LevelItemVMgr.ts"],(function(e){var t,n,r,i,l,o,a,c,s,u,p,f,v,d,g,b,h,L,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){l=e.cclegacy,o=e._decorator,a=e.Node,c=e.RichText,s=e.Prefab,u=e.instantiate,p=e.director,f=e.Component},function(e){v=e.GameContextBuilder},function(e){d=e.GameLogic},function(e){g=e.GlobalContext},function(e){b=e.TranslateScope},function(e){h=e.Mods},function(e){L=e.UIGlobalContext},function(e){m=e.LevelItemVMgr}],execute:function(){var y,x,C,G,M,S,w,E,I;l._RF.push({},"9682b2hp8pOu5ELftvUKQZ4","SelectLevelVMgr",void 0);var T=o.ccclass,V=o.property;e("SelectLevelVMgr",(y=T("SelectLevelVMgr"),x=V({type:a}),C=V({type:c}),G=V({type:s}),y((w=t((S=function(e){function t(){for(var t,n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return t=e.call.apply(e,[this].concat(l))||this,r(t,"levelContainer",w,i(t)),r(t,"descText",E,i(t)),r(t,"levelItemPrefab",I,i(t)),t.currentLevel=void 0,t}n(t,e);var l=t.prototype;return l.start=function(){var e=this;h.forEach((function(e){null==e.onApplicationLoaded||e.onApplicationLoaded([],[],g)})),this.levelContainer.children.forEach((function(e){return e.destroy()})),g.levelManager.getLevels().forEach((function(t){var n=u(e.levelItemPrefab);n.parent=e.levelContainer,n.getComponent(m).init(t,e.onSelected.bind(e))}))},l.onSelected=function(e){e.desc?(this.descText.string=g.translateManager.$(b.G_LEVEL_DESC,e.desc),this.currentLevel=e):this.descText.string=""},l.update=function(e){},l.onStartNewGame=function(){if(this.currentLevel){var e=new v;g.setGameContext(new d(e.buildByLevel(this.currentLevel))),L.clear(),p.loadScene("main")}else this.descText.string="please select level"},t}(f)).prototype,"levelContainer",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=t(S.prototype,"descText",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=t(S.prototype,"levelItemPrefab",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=S))||M));l._RF.pop()}}}));

System.register("chunks:///_virtual/SettingData.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"2443btoz0pAtpj6Ku66DwXZ","SettingData",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/SettingDataManager.ts",["cc","./common.ts"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy},function(t){n=t.bindAll}],execute:function(){e._RF.push({},"ac138Ldgi5AjoO4YC9BJ9z/","SettingDataManager",void 0);t("SettingDataManager",function(){function t(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.settings=void 0,this.settings={module:{},resource:{},buff:{resource:{}}},this.init()}var e=t.prototype;return e.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.functionManager=t.managers.functionManager,this.eventBus=t.managers.eventBus,n(this)},e.getResourceBuff=function(t){return this.settings.buff.resource[t]||console.warn("没有该buff name"+t),this.settings.buff.resource[t]},e.addResourceBuff=function(t){this.settings.buff.resource[t.name]=t},e.addModule=function(t){this.settings.module[t.name]=t},e.addResource=function(t){this.settings.resource[t.name]=t},e.getModule=function(t){return this.settings.module[t]},e.getResource=function(t){return this.settings.resource[t]},e.getModuleNames=function(){return Object.keys(this.settings.module)},e.init=function(){},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/Start.ts",["cc","./EnumDefine.ts","./define.ts"],(function(n){var e,t,i;return{setters:[function(n){e=n.cclegacy},function(n){t=n.GroundTypeEnum},function(n){i=n.ModuleName}],execute:function(){n("run",(function(n,e){n(r),e((function(n){return n.module.init}),r.name,(function(n,e){e.vars={wave:[],index:0}})),e((function(n){return n.module.onTick}),r.name,(function(n,e){var t=e.vars;if(t.index<t.wave.length){var i=t.wave[t.index];t.index++,i&&n.managers.gameEntityManager.registerResource(i,n.map.getAt(e.position))}}))})),e._RF.push({},"6eeb7VgYpxLxrSXilIoFLOq","Start",void 0);var r={name:i.START,groundType:t.NONE,funcs:{init:i.START,onTicket:i.START},consts:{}};e._RF.pop()}}}));

System.register("chunks:///_virtual/TranslateManager.ts",["cc","./common.ts","./EnumDefine.ts"],(function(n){var t,a,e;return{setters:[function(n){t=n.cclegacy},function(n){a=n.bindAll},function(n){e=n.LangEnum}],execute:function(){t._RF.push({},"378e2I6djtBorvOXQ4EL4P0","TranslateManager",void 0);n("TranslateManager",function(){function n(){var n=this;this.lang=e.CN,this.lanMap2={},this.$=void 0;this.$=function(t,a,e){if(!e)return n.getTranslate2(t,a);n.setTranslate2(t,a,e)}}var t=n.prototype;return t.setContext=function(n){a(this)},t.setTranslate2=function(n,t,a){var e=this.lanMap2[n];e||(e=this.lanMap2[n]={}),e[t]=a},t.getTranslate2=function(n,t){var a,e=this.lanMap2[n];return e||(e=this.lanMap2[n]={}),null!=(a=e[t])?a:n+"::"+t},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/UIUtilities.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewGlobal.ts"],(function(t){var e,n,r,i;return{setters:[function(t){e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,r=t.Vec3},function(t){i=t.UIGlobalContext}],execute:function(){function a(t,n,r){if("c.turn"===n)return r.c.effectColdDown;var i=n.split("."),a=r;if("p"==i[0])return"<img src='"+i[1]+"'/>";for(var c,l=e(i);!(c=l()).done;){if(void 0===(a=a[c.value]))return"???? not matched"+n+" ????"}return a}t({getViewPositionVec3:function(t){return new r(i.globalDiffer.x+i.mapItemSize.x*t.x,i.globalDiffer.y-i.mapItemSize.y*t.y)},translateSettingString:function(t,e,n,r){var i,c=t.managers.translateManager.$(e,null!=(i=null==n?void 0:n.name)?i:r.name),l={c:r.consts,v:{}},o=c.match(/\[(.*?)\]/g);return null==o||o.forEach((function(e){c=c.replace(e,a(t,e.slice(1,-1),l))})),c},translateString:function(t,e,n,r){var i,c=t.managers.translateManager.$(e,null!=(i=null==n?void 0:n.name)?i:r.name),l={c:r.setting.consts,v:r.vars},o=c.match(/\[(.*?)\]/g);return null==o||o.forEach((function(e){c=c.replace(e,a(t,e.slice(1,-1),l))})),c}}),n._RF.push({},"859d4Ljzi9Gq40VKU2yPC5a","UIUtilities",void 0);t("UseMemo",function(){function t(t,e,n){this.pre=void 0,this.callback=void 0,this.pre=t,this.callback=n?e.bind(n):e}return t.prototype.watch=function(t){t!==this.pre&&this.callback(t,this.pre),this.pre=t},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/ViewGlobal.ts",["cc","./common.ts"],(function(t){var e,i;return{setters:[function(t){e=t.cclegacy},function(t){i=t.bindAll}],execute:function(){e._RF.push({},"daee0q2Vj5DEqIMV4q8qyWX","ViewGlobal",void 0);var n=t("InputMode",{NONE:"none",BUILD_MODULE:"build_module"}),s=function(){function t(){this.listeners={},this.pub=this.pub.bind(this),this.sub=this.sub.bind(this)}var e=t.prototype;return e.pub=function(t,e){var i=this.listeners[t];i&&i.length&&i.forEach((function(t){t.listener(e)}))},e.sub=function(t,e,i){this.listeners[t]||(this.listeners[t]=[]),i&&(e=e.bind(i));var n=this.listeners[t].find((function(t){return t.listener==e&&(!i||t.$this==i)}));if(n){if(n.$this!=i)throw new Error("已经注册了该监听,但绑定的this不一致")}else this.listeners[t].push({listener:e,$this:i})},e.remove=function(t,e,i){if(this.listeners[t]){var n=this.listeners[t].findIndex((function(t){return t.listener==e&&(!i||t.$this==i)})),s=this.listeners[t][n];if(s)throw s.$this==i&&(this.listeners[t]=this.listeners[t].filter((function(t){return t!=s}))),new Error("已经注册了该监听,但解除绑定的this没有传")}},e.$=function(t){return t?this.sub:this.remove},e.clear=function(t){delete this.listeners[t]},t}(),r={inputMode:n.NONE},o=new s;i(o);var u=t("UIGlobalContext",{myInputSystem:r,globalUIEvent:o,mapItemSize:{x:100,y:100},globalDiffer:{x:0,y:0},clear:function(){u.myInputSystem={inputMode:n.NONE},u.globalUIEvent=new s}});e._RF.pop()}}}));

System.register("chunks:///_virtual/WaveInfoVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./EnumDefine.ts","./ViewGlobal.ts"],(function(e){var t,n,o,i,a,s,u,h,v,d,l;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,o=e._decorator,i=e.NodeEventType,a=e.RichText,s=e.Button,u=e.Label,h=e.Component},function(e){v=e.GlobalContext},function(e){d=e.TranslateScope},function(e){l=e.UIGlobalContext}],execute:function(){var m;n._RF.push({},"f4107h7KcJD44nnzmlP5fDZ","WaveInfoVMgr",void 0);var p=o.ccclass;o.property,e("WaveInfoVMgr",p("WaveInfoVMgr")(m=function(e){function n(){for(var t,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(t=e.call.apply(e,[this].concat(o))||this).waveInfoText=void 0,t.btnNext=void 0,t.waveDetailText=void 0,t.pauseGameButton=void 0,t.pauseGameButtonText=void 0,t.speedUpGameButton=void 0,t.speedUpGameButtonText=void 0,t}t(n,e);var o=n.prototype;return o.manageEvent=function(e){e?(this.node.on(i.MOUSE_ENTER,this.onMouseEnter,this,!0),this.node.on(i.MOUSE_LEAVE,this.onMouseLeave,this,!0)):(this.node.off(i.MOUSE_ENTER,this.onMouseEnter,this,!0),this.node.off(i.MOUSE_LEAVE,this.onMouseLeave,this,!0))},o.onMouseEnter=function(){l.myInputSystem.mousePointMenu=this.node},o.onMouseLeave=function(){l.myInputSystem.mousePointMenu===this.node&&(l.myInputSystem.mousePointMenu=void 0)},o.loadRef=function(){var e,t,n,o,h,d=this;(!this.waveInfoText&&(this.waveInfoText=null==(e=this.node.getChildByName("TextWave"))?void 0:e.getComponent(a)),this.btnNext)||(this.btnNext=null==(t=this.node.getChildByName("BtnNextWave"))?void 0:t.getComponent(s),this.btnNext.node.on(i.MOUSE_DOWN,this.on_nextWave,this),this.btnNext.node.on(i.MOUSE_ENTER,this.on_showDetail,this),this.btnNext.node.on(i.MOUSE_LEAVE,this.on_hideDetail,this));this.waveDetailText||(this.waveDetailText=null==(n=this.node.getChildByName("TextWaveInfo"))?void 0:n.getComponent(a),this.waveDetailText.node.active=!1);this.speedUpGameButton||(this.speedUpGameButton=null==(o=this.node.getChildByName("SpeedUpGame"))?void 0:o.getComponent(s),this.speedUpGameButtonText=this.speedUpGameButton.node.getComponentInChildren(u),this.speedUpGameButtonText.string="1X",this.speedUpGameButton.node.on(i.MOUSE_UP,(function(){var e=v.logic;e&&(1===e.gameSpeed?e.gameSpeed=2:2===e.gameSpeed?e.gameSpeed=.5:.5===e.gameSpeed&&(e.gameSpeed=1),d.speedUpGameButtonText.string=e.gameSpeed+"X")})));this.pauseGameButton||(this.pauseGameButton=null==(h=this.node.getChildByName("PauseGame"))?void 0:h.getComponent(s),this.pauseGameButtonText=this.pauseGameButton.node.getComponentInChildren(u),this.pauseGameButtonText.string="暂停",this.pauseGameButton.node.on(i.MOUSE_UP,(function(){var e=v.logic;e&&(e.pause=!e.pause,d.pauseGameButtonText.string=e.pause?"开始":"暂停",d.speedUpGameButton.node.active=!e.pause)})))},o.start=function(){this.loadRef(),this.manageEvent(!0)},o.onDestroy=function(){this.manageEvent(!1)},o.update=function(e){var t=v.logic;if(t&&t.gameContext){if(t.gameContext.alive){var n=t.gameContext.wavesInfo;this.waveInfoText.string="波次:"+n.nextPtr+"/"+n.waves.length+"\n时间:"+Math.floor(t.gameContext.tick/20)}else this.waveInfoText.string="已结束\n时间:"+Math.floor(t.gameContext.tick/20);if(this.waveDetailText.node.active){var o=t.gameContext.managers.translateManager.$,i=t.gameContext.wavesInfo,a=i.waves[i.nextPtr];if(!a)return this.waveDetailText.node.active=!1,void(this.waveDetailText.string="");var s="时间:"+Math.floor(a.ticket/20)+"\n";a.info.forEach((function(e){e.forEach((function(e){e.name&&(s+=o(d.RESOURCE_NAME,e.name)+":(复杂度)"+e.complexity+"\n")}))})),this.waveDetailText.string=s}}},o.on_nextWave=function(e){var t=v.logic;0===e.getButton()&&t&&t.gameContext&&t.nextWaveLogic(t.gameContext,!0)},o.on_showDetail=function(e){this.waveDetailText.string="",this.waveDetailText.node.active=!0},o.on_hideDetail=function(e){this.waveDetailText.node.active=!1},n}(h))||m);n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});