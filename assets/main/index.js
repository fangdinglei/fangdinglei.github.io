System.register("chunks:///_virtual/Analyzer.ts",["cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,u,t,c,o,f;return{setters:[function(e){n=e.cclegacy},function(e){u=e.GroundTypeEnum},function(e){t=e.ResourceTypeSelector},function(e){c=e.ResourceBuffName,o=e.ModuleName,f=e.TResourceType}],execute:function(){e("run",(function(e,n){e(s),n((function(e){return e.module.effect}),s.name,(function(e,n){var u=n.resource,t={level:n.module.setting.consts.ability};e.managers.gameLogicUtils.addBuffToResource(u,c.ANALYZED,t)}))})),n._RF.push({},"136f9vx4ChG2KkkkOl2zqoW","Analyzer",void 0);var s={name:o.ANALYZER,groundType:u.WIRE,effect:{funcName:o.ANALYZER,selector:{func:t.name}},funcs:{},consts:{effectColdDown:3,wantResourceType:f.COMMON,ability:2,maxBuffLevelCount:5,buildAble:{cost:50}},desc:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/AssetVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts"],(function(e){var t,r,n,o,i,a,s,c,l,p,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,s=e.Prefab,c=e.instantiate,l=e.RichText,p=e.Component},function(e){u=e.GlobalContext}],execute:function(){var f,h,g,v,b;i._RF.push({},"6586bZ+91RB/bhtproKPyGq","AssetVMgr",void 0);var d=a.ccclass,y=a.property;e("AssetVMgr",(f=d("AssetVMgr"),h=y({type:s}),f((b=t((v=function(e){function t(){for(var t,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,n(t,"infoPrefab",b,o(t)),t.nodes={},t}r(t,e);var i=t.prototype;return i.start=function(){},i.update=function(e){var t=u.logic,r={hp:"生命",value:"价值",baseResearch:"科研",energy:"能量"};if(t&&t.gameContext){var n=t.gameContext.asset;for(var o in n){var i,a=n[o];if(!this.nodes[o]){var s=c(this.infoPrefab);s.parent=this.node;var p=s.getComponent(l);this.nodes[o]=p}this.nodes[o].string=((null!=(i=r[o])?i:o)+":"+a.cur).padEnd(10," ")}}},t}(p)).prototype,"infoPrefab",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=v))||g));i._RF.pop()}}}));

System.register("chunks:///_virtual/BottomMenuVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,n,e,r;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,r=t.Component}],execute:function(){var u;n._RF.push({},"0fc12Ej/apPj6Ls39iVKSeL","BottomMenuVMgr",void 0);var c=e.ccclass;e.property,t("BottomMenuVMgr",c("BottomMenuVMgr")(u=function(t){function n(){return t.apply(this,arguments)||this}o(n,t);var e=n.prototype;return e.start=function(){},e.update=function(t){},n}(r))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/BottomRightMenuVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewGlobal.ts"],(function(t){var n,o,e,s,i,u;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,s=t.NodeEventType,i=t.Component},function(t){u=t.UIGlobalContext}],execute:function(){var r;o._RF.push({},"366acyqI4pHro5/HPqgT82W","BottomRightMenuVMgr",void 0);var h=e.ccclass;e.property,t("BottomRightMenuVMgr",h("BottomRightMenuVMgr")(r=function(t){function o(){return t.apply(this,arguments)||this}n(o,t);var e=o.prototype;return e.manageEvent=function(t){t?(this.node.on(s.MOUSE_ENTER,this.onMouseEnter,this,!0),this.node.on(s.MOUSE_LEAVE,this.onMouseLeave,this,!0)):(this.node.off(s.MOUSE_ENTER,this.onMouseEnter,this,!0),this.node.off(s.MOUSE_LEAVE,this.onMouseLeave,this,!0))},e.start=function(){this.manageEvent(!0)},e.onDestroy=function(){this.onMouseLeave(),this.manageEvent(!1)},e.update=function(t){},e.onMouseEnter=function(){u.myInputSystem.mousePointMenu=this.node},e.onMouseLeave=function(){u.myInputSystem.mousePointMenu===this.node&&(u.myInputSystem.mousePointMenu=void 0)},o}(i))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/buff.ts",["cc","./EnumDefine.ts","./BuffDefine.ts","./common.ts","./define.ts"],(function(e){var n,u,o,f,t;return{setters:[function(e){n=e.cclegacy},function(e){u=e.ResourceDamageSourceEnum},function(e){o=e.ResourceBuff},function(e){f=e.assert},function(e){t=e.ResourceBuffName}],execute:function(){e("init",(function(e,n,u){[r].forEach((function(n){return e.addFunction((function(e){return e.resource.buff.onDestroy}),n.name,n.func)})),[a].forEach((function(n){return e.addFunction((function(e){return e.resource.buff.beforeDamaged}),n.name,n.func)})),[s,i].forEach((function(e){return n.addResourceBuff(e)}))})),n._RF.push({},"872e1e5uuNJy6/2PXlCWYFp","buff",void 0);var c=o.BuffDestroyReasonEnum,r={name:t.ReduceComplexity,func:function(e,n,o,t){var r;(f(!!o.vars.complexity),t===c.TIME)&&e.managers.gameLogicUtils.damageToResource(n,null!=(r=o.vars.complexity)?r:1,u.BUFF,{modifyAble:!1,dieAble:!1})}},a={name:t.ANALYZED,func:function(e,n,u){f(!!n.vars.level),u.modifyAble&&(u.relDamage+=n.vars.level,n.vars.level--,n.vars.level<=0&&(n.vars.leftTimes=0))}},s={name:t.ReduceComplexity,func:{onDestroy:r.name,onRepeated:void 0},consts:{maxTime:5}},i={name:t.ANALYZED,func:{beforeDamaged:a.name,onRepeated:o.RepeatedBuffResolutionEnum.NUM_ADD},consts:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/BuffDefine.ts",["cc"],(function(e){var E;return{setters:[function(e){E=e.cclegacy}],execute:function(){var u,R;e("ResourceBuff",void 0),E._RF.push({},"59d24W4wv9CHIaVX1UJ55KE","BuffDefine",void 0),(R=u||(u=e("ResourceBuff",{}))).BuffDestroyReasonEnum={TIMES:"TIMES",TIME:"TIME",RESOURCE_DESTROY:"RESOURCE_DESTROY"},R.RepeatedBuffResolutionEnum={IGNORE:"IGNORE",REPLACE:"REPLACE",ABANDON:"ABANDON",NUM_ADD:"NUM_ADD",OTHER:"自定义名称"},E._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingItemVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewGlobal.ts"],(function(t){var e,i,n,o,s,u,l,h,c;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.RichText,s=t.NodeEventType,u=t.Color,l=t.Component},function(t){h=t.UIGlobalContext,c=t.InputMode}],execute:function(){var r;i._RF.push({},"68daeHYI0BAYpFkbsSUA/xZ","BuildingItemVMgr",void 0);var d=n.ccclass;t("BuildingItemVMgr",d("BuildingItemVMgr")(r=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).buildingName=void 0,e.text=void 0,e}e(i,t);var n=i.prototype;return n.start=function(){this.initRef(),this.manageEvent(!0)},n.initRef=function(){!this.text&&(this.text=this.getComponent(o))},n.manageEvent=function(t){t?(this.node.on(s.MOUSE_ENTER,this.onMouseEnter,this),this.node.on(s.MOUSE_DOWN,this.onMouseClick,this),this.node.on(s.MOUSE_LEAVE,this.onMouseLeave,this)):(this.node.off(s.MOUSE_ENTER,this.onMouseEnter,this),this.node.off(s.MOUSE_DOWN,this.onMouseClick,this),this.node.off(s.MOUSE_LEAVE,this.onMouseLeave,this))},n.init=function(t){this.buildingName=t,this.initRef()},n.update=function(t){this.text&&(this.text.fontColor=h.myInputSystem.clickedBuildAble===this.buildingName&&h.myInputSystem.inputMode===c.BUILD_MODULE?u.BLUE:u.WHITE)},n.onDestroy=function(){this.manageEvent(!1)},n.onMouseEnter=function(t){this.buildingName&&(h.myInputSystem.mouseOverBuildAble=this.buildingName)},n.onMouseLeave=function(t){this.buildingName&&h.myInputSystem.mouseOverBuildAble===this.buildingName&&(h.myInputSystem.mouseOverBuildAble=void 0)},n.onMouseClick=function(t){0==t.getButton()&&(h.myInputSystem.inputMode=c.BUILD_MODULE,h.myInputSystem.clickedBuildAble=this.buildingName)},i}(l))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingManager.ts",["cc","./EnumDefine.ts","./EventDefine.ts"],(function(e){var t,n,i,u;return{setters:[function(e){t=e.cclegacy},function(e){n=e.GroundTypeEnum,i=e.AssetName},function(e){u=e.GameLogicEvent}],execute:function(){t._RF.push({},"19f71006hNN54H7IYxuTjfI","BuildingManager",void 0);e("BuildingManager",function(){function e(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.gameLogicUtils=void 0,this.gameEntityManager=void 0,this.lockChangeEvent=!0,this.buildAbleModules={},this.lockedModules={}}var t=e.prototype;return t.setContext=function(e){this.context=e,this.settingDataManager=e.managers.settingDataManager,this.functionManager=e.managers.functionManager,this.eventBus=e.managers.eventBus,this.gameLogicUtils=e.managers.gameLogicUtils,this.gameEntityManager=e.managers.gameEntityManager},t.afterModLoad=function(){this.lockChangeEvent=!1,this.onBuildModuleChange()},t.canBuildAt=function(e,t){var i=this.settingDataManager;if(e.module)return!1;var u="string"==typeof t?i.getModule(t):t;return u.groundType===n.NONE||e.groundType===u.groundType},t.getModuleCost=function(e){var t=this.settingDataManager,n="string"==typeof e?t.getModule(e):e,i=n.consts.buildAble;if(!i)return 1/0;if(!i.punishment)return i.cost;var u=this.gameLogicUtils.countModuleByName(n.name);return i.cost+u*i.punishment},t.canBuildModule=function(e,t){var n=this.settingDataManager.getModule(t);if(!this.canBuildAt(e,n))return!1;var u=this.getModuleCost(n);return!(this.context.asset.value.cur<u)&&this.gameLogicUtils.useAsset(i.VALUE,u)},t.buildModule=function(e,t){if(this.canBuildModule(e,t)){var n=this.gameEntityManager.createModule(t);return this.gameEntityManager.registerModule(n,e),n}},t.onBuildModuleChange=function(){if(!this.lockChangeEvent){var e={buildAbleModules:this.getBuildAbleModules()};this.eventBus.pub(u.BUILD_ABLE_MODULE_CHANGE,e)}},t.addBuildAble=function(e){this.buildAbleModules[e]||(this.buildAbleModules[e]=!0,this.onBuildModuleChange())},t.removeBuildAble=function(e){this.buildAbleModules[e]&&(this.buildAbleModules[e]=!1,this.onBuildModuleChange())},t.getBuildAbleModules=function(){var e=[];for(var t in this.buildAbleModules)this.buildAbleModules[t]&&!this.lockedModules[t]&&e.push(t);return e},t.isLocked=function(e){return this.lockedModules[e]},t.unLockModules=function(e){var t=this;e.forEach((function(e){delete t.lockedModules[e]}))},t.lockModules=function(e){var t=this;e.forEach((function(e){t.lockedModules[e]=!0}))},t.lockAllExcept=function(e){var t=this;Object.keys(this.buildAbleModules).forEach((function(n){t.lockedModules[n]=!e.includes(n)}))},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./common.ts","./EnumDefine.ts","./EventDefine.ts","./ViewGlobal.ts","./BuildingItemVMgr.ts"],(function(e){var t,n,i,l,o,u,a,s,r,d,c,b,g,h,f,p,M,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,l=e.assertThisInitialized},function(e){o=e.cclegacy,u=e._decorator,a=e.Prefab,s=e.Input,r=e.instantiate,d=e.RichText,c=e.Component},function(e){b=e.GlobalContext},function(e){g=e.differ},function(e){h=e.TranslateScope},function(e){f=e.GameLogicEvent},function(e){p=e.UIGlobalContext,M=e.InputMode},function(e){v=e.BuildingItemVMgr}],execute:function(){var A,m,E,B,y;o._RF.push({},"1e77b7jtQxMAZIWaSFE+erv","BuildingVMgr",void 0);var C=u.ccclass,I=u.property;e("BuildingVMgr",(A=C("BuildingVMgr"),m=I({type:a,displayName:"建筑项预制体"}),A((y=t((B=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return t=e.call.apply(e,[this].concat(o))||this,i(t,"selectAblePrefab",y,l(t)),t.buildAbleChanged=!0,t.buildAbleModules=void 0,t.lastRenderAbleModules={},t}n(t,e);var o=t.prototype;return o.onBuildAbleChangeEvent=function(e,t,n){this.buildAbleChanged=!0,this.buildAbleModules=n.buildAbleModules},o.onBuildModule=function(e,t,n){this.buildAbleChanged=!0},o.onRightClick=function(e){2==e.getButton()&&(p.myInputSystem.inputMode=M.NONE,p.myInputSystem.clickedBuildAble=void 0)},o.manageEvent=function(e){var t=e?b.context.managers.eventBus.sub:b.context.managers.eventBus.remove,n=e?p.globalUIEvent.sub:p.globalUIEvent.remove;t(f.BUILD_ABLE_MODULE_CHANGE,this.onBuildAbleChangeEvent,this),t(f.NEW_MODULE,this.onBuildModule,this),n(s.EventType.MOUSE_DOWN,this.onRightClick,this)},o.start=function(){this.manageEvent(!0)},o.onDestroy=function(){this.manageEvent(!1)},o.resetBuildAbleUI=function(){var e=this,t=b.context;this.buildAbleModules||(this.buildAbleModules=t.managers.buildingManager.getBuildAbleModules()),this.buildAbleChanged=!1;var n=this.buildAbleModules.reduce((function(e,t){return e[t]=t,e}),{}),i=g(this.lastRenderAbleModules,n),l=t.managers.translateManager,o=t.managers.buildingManager;i.add.forEach((function(t){var n=l.$(h.MODULE_NAME,t),i=r(e.selectAblePrefab);i.parent=e.node,i.getComponent(d).string=n+" cost:"+o.getModuleCost(t);var u=i.getComponent(v);u.init(t),e.lastRenderAbleModules[t]=u})),i.delete.forEach((function(t){delete e.lastRenderAbleModules[t.buildingName],t.node.destroy()}))},o.update=function(e){b.context&&this.buildAbleChanged&&this.resetBuildAbleUI()},o.onClickBuildingButton=function(){},t}(c)).prototype,"selectAblePrefab",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=B))||E));o._RF.pop()}}}));

System.register("chunks:///_virtual/CameraManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameLogic.ts","./GameContextBuilder.ts","./GlobalContextImpl.ts","./Mod2.ts","./ViewGlobal.ts"],(function(t){var e,n,o,i,a,s,r,u,c,l,g,p,h,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){a=t.cclegacy,s=t._decorator,r=t.Node,u=t.Vec2,c=t.Component},function(t){l=t.GameLogic},function(t){g=t.GameContextBuilder},function(t){p=t.GlobalContext},function(t){h=t.Mods},function(t){f=t.UIGlobalContext}],execute:function(){var v,d,m,M,y,E;a._RF.push({},"8623flulA5K+4h5udynbbwd","CameraManager",void 0);var b=s.ccclass,C=s.property;t("CameraManager",(v=b("CameraManager"),d=C({type:r}),v(((E=function(t){function e(){var e;if(e=t.call(this)||this,o(e,"camera",y,i(e)),e.isDragging=!1,e.startPos=void 0,p.logic)return i(e);h.forEach((function(t){null==t.onApplicationLoaded||t.onApplicationLoaded([],[],p)}));var n=new g;return p.setGameContext(new l(n.buildByLevel(p.levelManager.getLevels()[0]))),e}n(e,t);var a=e.prototype;return a.start=function(){e.INSTANCE=this},a.update=function(t){},a.manageEvent=function(t){var e=f.globalUIEvent.$(!0);e(r.EventType.MOUSE_DOWN,this.onMouseDown,this),e(r.EventType.MOUSE_MOVE,this.onMouseMove,this),e(r.EventType.MOUSE_UP,this.onMouseUp,this),e(r.EventType.MOUSE_LEAVE,this.onMouseUp,this)},a.onLoad=function(){this.manageEvent(!0),this.isDragging=!1,this.startPos=new u(0,0)},a.onMouseDown=function(t){f.myInputSystem.mousePointMenu||(this.startPos=t.getLocation(),this.isDragging=!0)},a.onMouseMove=function(t){if(this.isDragging&&this.camera){var e=t.getLocation().subtract(this.startPos);this.camera.position=this.node.position.add3f(-e.x,-e.y,0),this.startPos=t.getLocation()}},a.onMouseUp=function(){this.isDragging=!1},a.onDestroy=function(){this.manageEvent(!1)},e}(c)).INSTANCE=void 0,y=e((M=E).prototype,"camera",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=M))||m));a._RF.pop()}}}));

System.register("chunks:///_virtual/CollaborativeProcessor.ts",["cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,t,o,c,u,i;return{setters:[function(e){n=e.cclegacy},function(e){t=e.ResourceDamageSourceEnum,o=e.GroundTypeEnum},function(e){c=e.ResourceTypeSelector},function(e){u=e.ModuleName,i=e.TResourceType}],execute:function(){e("run",(function(e,n){e(s),n((function(e){return e.module.effect}),s.name,(function(e,n){var o=n.resource,c=n.module,u=e.managers.gameLogicUtils.getAround4(c.position).filter((function(e){return null==e?void 0:e.module})).length,i=c.setting.consts.ability+u*c.setting.consts.increaseAbility;e.managers.gameLogicUtils.damageToResource(o,i,t.MODULE_PROCESSOR)}))})),n._RF.push({},"4fb19qflWJCzLnM3xxm4Q/f","CollaborativeProcessor",void 0);var s={name:u.COLLABORATIVE_PROCESSOR,groundType:o.WIRE,effect:{funcName:u.COLLABORATIVE_PROCESSOR,selector:{func:c.name}},funcs:{},consts:{effectColdDown:3,wantResourceType:i.COMMON,ability:2,increaseAbility:1,buildAble:{cost:70}},desc:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/common.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.js","./EnumDefine.ts"],(function(t){var r,e,n,i,o,s,u;return{setters:[function(t){r=t.createForOfIteratorHelperLoose,e=t.inheritsLoose,n=t.wrapNativeSuper},function(t){i=t.cclegacy},function(t){o=t.stringify,s=t.parse},function(t){u=t.DirectionTypeEnum}],execute:function(){var f;t({assert:function(t,r){if(!t)throw console.error("assert error"+(null!=r?r:"")),new Error("assert error"+(null!=r?r:""))},bindAll:function(t){for(var e,n=r(Object.getOwnPropertyNames(Object.getPrototypeOf(t)));!(e=n()).done;){var i=e.value;"function"==typeof t[i]&&(t[i]=t[i].bind(t))}},differ:function(t,r){var e={add:[],modify:[],delete:[]};for(var n in t){var i=t[n],o=r[n];i&&o?e.modify.push({oldObj:i,newObj:o}):i&&e.delete.push(i)}for(var s in r){var u=t[s],f=r[s];u||e.add.push(f)}return e},differObject2:function(t,r){var e={add:[],modify:[],delete:[]};for(var n in t){var i=t[n],o=r[n];i&&o?e.modify.push({key:n,oldObj:i,newObj:o}):i&&e.delete.push({obj:i,key:n})}for(var s in r){var u=t[s],f=r[s];u||e.add.push({obj:f,key:s})}return e}}),i._RF.push({},"2e0ddWnOrtAyYuiNM5hMk0F","common",void 0);var a=t("MyPoint",function(){function t(t,r){this.x=void 0,this.y=void 0,this.x=t,this.y=r}var r=t.prototype;return r.pointOfDirection=function(r){if(r==u.DOWN)return new t(this.x,this.y-1);if(r==u.UP)return new t(this.x,this.y+1);if(r==u.LEFT)return new t(this.x-1,this.y);if(r==u.RIGHT)return new t(this.x+1,this.y);throw new Error("未知方向")},r.equals=function(t){return t&&t.x==this.x&&t.y==this.y},t.equals=function(t,r){return null==t&&null==r||t&&r&&t.x==r.x&&r.y==t.y},t}());f=a,a.ZERO=new f(0,0);t("Timer",function(){function t(){this.time=0}var r=t.prototype;return r.add=function(t){this.time+=t},r.wait=function(t){return this.time>=t&&(this.time=0,!0)},r.addWait=function(t,r){return this.time+=t,this.time>=r&&(this.time=0,!0)},t}());t("GameOverError",function(t){function r(r){var e;return(e=t.call(this,"游戏结束"+r)||this).success=void 0,e.success=r,e}return e(r,t),r}(n(Error))),t("JSON",{stringify:o,parse:s});i._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/define.ts",["cc"],(function(R){var E;return{setters:[function(R){E=R.cclegacy}],execute:function(){E._RF.push({},"5a81ew3SrdPMKPM3AgTE6wf","define",void 0);R("ModuleName",{START:"MN_START",END:"MN_END",PROCESSOR:"MN_PROCESS",INDEPENDENT_PROCESSOR:"MN_INDEPENDENT_PROCESSOR",COLLABORATIVE_PROCESSOR:"MN_COLLABORATIVE_PROCESSOR",HARMLESS_PROCESSOR:"MN_HARMLESS_PROCESSOR",RECYCLE:"MN_RECYCLE",FLIP:"MN_FLIP",ANALYZER:"MN_ANALYZER",POWERFUL_PROCESSOR:"MN_POWERFUL_PROCESSOR",REINFORCER:"MN_REINFORCER",LABORATORY:"MN_LABORATORY",OPERATIONS:"MN_OPERATIONS",JAMMER:"MN_JAMMER",MAINTENANCE:"MN_MAINTENANCE",POLE_TRANSMISSION:"MN_POLE_TRANSMISSION",FORGET:"MN_FORGET",CALCULATOR:"MN_CALCULATOR",INTERCEPTOR:"MN_INTERCEPTOR",POLE_POWER_STATION:"MN_POLE_POWER_STATION",CAPACITANCE:"MN_CAPACITANCE",POWERED_LABORATORY:"MN_POWERED_LABORATORY",POWERED_PROCESSOR:"MN_POWERED_PROCESSOR",POWERED_FLIP:"MN_POWERED_FLIP",REFACTOR:"MN_REFACTOR",SUICIDAL_PROCESS:"MN_SUICIDAL_PROCESS",PROCESS_ACCELERATOR:"MN_PROCESS_ACCELERATOR"}),R("ResourceName",{META_DATA:"RT_META_DATA",PERSISTENT_DATA:"RT_PERSISTENT_DATA",VOLATILE_DATA:"RT_VOLATILE_DATA",BACKUP_DATA:"RT_BACKUP_DATA",DISTRIBUTED_DATA:"RT_DISTRIBUTED_DATA",BUG:"RT_BUG",VULNERABILITY:"RT_VULNERABILITY",ENERGY:"RT_ENERGY",VALUE:"RT_VALUE"}),R("TResourceType",{COMMON:"TL_COMMON",DANGER:"TL_DANGER",SPECIAL:"TL_SPECIAL"}),R("ResourceBuffName",{ReduceComplexity:"RBN_ReduceComplexity",ANALYZED:"RBN_Analyzed"});E._RF.pop()}}}));

System.register("chunks:///_virtual/DemoBuilder.ts",["cc","./define.ts","./GameLogic.ts","./GameContextBuilder.ts"],(function(e){var t,i,n,o;return{setters:[function(e){t=e.cclegacy},function(e){i=e.ResourceName},function(e){n=e.GameLogic},function(e){o=e.GameContextBuilder}],execute:function(){t._RF.push({},"d5530gp7dNANrO9BtZyYJcF","DemoBuilder",void 0);e("DemoBuilder",function(){function e(){this.gameLogic=void 0}var t=e.prototype;return t.build=function(){var e=[],t={ticket:5,info:[[{name:i.META_DATA,complexity:20},{name:i.META_DATA,complexity:11},{name:i.PERSISTENT_DATA,complexity:12},{name:i.VOLATILE_DATA,complexity:13}]]};e.push(t);var c=(new o).build(e),u=new n(c);return this.gameLogic=u,u},t.run=function(){var e=this;this.gameLogic?this.gameLogic.nextTick():this.gameLogic=this.build(),setTimeout((function(){e.run()}),1e3)},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/End.ts",["cc","./EnumDefine.ts","./define.ts"],(function(e){var n,r,u,t;return{setters:[function(e){n=e.cclegacy},function(e){r=e.ResourceDamageSourceEnum,u=e.GroundTypeEnum},function(e){t=e.ModuleName}],execute:function(){e("run",(function(e,n){e(c),n((function(e){return e.module.effect}),c.name,(function(e,n){if(n.resource&&n.module){var u=n.resource.setting.funcs.onArriveEnd,t=e.managers.functionManager.getFunction((function(e){return e.resource.onArriveEnd}),u);t&&t(e,n.resource,n),e.managers.gameEntityManager.deRegisterResource(n.resource,r.ENTER)}}))})),n._RF.push({},"0dc2eawk+9ITJ0R8JFtOotB","End",void 0);var c={name:t.END,groundType:u.NONE,funcs:{},effect:{funcName:t.END},consts:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/EnumDefine.ts",["cc"],(function(E){var e;return{setters:[function(E){e=E.cclegacy}],execute:function(){e._RF.push({},"a43058pmOVBs6YdMBqWoFqm","EnumDefine",void 0);E("DirectionTypeEnum",{UP:"U",DOWN:"D",LEFT:"L",RIGHT:"R"}),E("GroundTypeEnum",{NONE:"GT_NONE",WIRE:"GT_WIRE",INSULATION:"GT_INSULATION",POLE:"POLE"}),E("ResourceDamageSourceEnum",{UNKNOWN:"UNKNOWN",MODULE_PROCESSOR:"MODULE_PROCESSOR",MODULE_CONSUME:"MODULE_CONSUME",ENTER:"ENTER",BUFF:"BUFF"}),E("AssetName",{VALUE:"value",ENERGY:"energy",RESEARCH_BASE:"baseResearch"}),E("TranslateScope",{MODULE_NAME:"0",MODULE_DESC:"1",RESOURCE_NAME:"10",RESOURCE_DESC:"11",BUFF_NAME:"20",BUFF_DESC:"21",GROUND_NAME:"100",G_LEVEL_NAME:"1000",G_LEVEL_DESC:"1001"}),E("LangEnum",{CN:"cn",EN:"en"});e._RF.pop()}}}));

System.register("chunks:///_virtual/EventBus.ts",["cc","./common.ts"],(function(t){var n,e;return{setters:[function(t){n=t.cclegacy},function(t){e=t.bindAll}],execute:function(){n._RF.push({},"03166inDCZOJqLj5vAM11px","EventBus",void 0);t("EventBus",function(){function t(){this.listeners={},this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0}var n=t.prototype;return n.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.functionManager=t.managers.functionManager,this.eventBus=t.managers.eventBus,e(this)},n.pub=function(t,n){var e=this,i=this.listeners[t];i&&i.length&&i.forEach((function(i){i.listener(e.context,t,n)}))},n.sub=function(t,n,e){this.listeners[t]||(this.listeners[t]=[]),e&&(n=n.bind(e));var i=this.listeners[t].find((function(t){return t.listener==n&&(!e||t.$this==e)}));if(i){if(i.$this!=e)throw new Error("已经注册了该监听,但绑定的this不一致")}else this.listeners[t].push({listener:n,$this:e})},n.targetOff=function(t){if(t)for(var n=0,e=Object.keys(this.listeners);n<e.length;n++){var i=e[n],s=this.listeners[i];s.findIndex((function(n){return n.$this==t}))>=0&&(this.listeners[i]=s.filter((function(n){return n.$this==t})))}},n.remove=function(t,n,e){if(this.listeners[t]){var i=this.listeners[t].findIndex((function(t){return t.listener==n&&(!e||t.$this==e)})),s=this.listeners[t][i];if(s)throw s.$this==e&&(this.listeners[t]=this.listeners[t].filter((function(t){return t!=s}))),new Error("已经注册了该监听,但解除绑定的this没有传")}},n.clear=function(t){delete this.listeners[t]},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/EventDefine.ts",["cc"],(function(E){var S;return{setters:[function(E){S=E.cclegacy}],execute:function(){S._RF.push({},"574ebvJ6nhCN4KDZQwOAIJo","EventDefine",void 0);E("GameLogicEvent",{RESOURCE_DESTROYED:"RESOURCE_DESTROYED",GAME_FAIL:"GAME_FAIL",GAME_SUCCESS:"GAME_SUCCESS",ASSET_ADD:"ASSET_ADD",ASSET_USE:"ASSET_USE",BUILD_ABLE_MODULE_CHANGE:"BUILD_ABLE_MODULE_CHANGE",NEW_MODULE:"BUILD_MODULE"});S._RF.pop()}}}));

System.register("chunks:///_virtual/Flip.ts",["cc","./common.ts","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,c,o,u,t,s,r;return{setters:[function(e){n=e.cclegacy},function(e){c=e.assert},function(e){o=e.GroundTypeEnum},function(e){u=e.ResourceNameSelector},function(e){t=e.ResourceName,s=e.ResourceBuffName,r=e.ModuleName}],execute:function(){e("run",(function(e,n){e(i),n((function(e){return e.module.effect}),i.name,(function(e,n){var o=n.resource,u=n.module.setting.consts,r=e.managers.gameLogicUtils;if(o.name===t.PERSISTENT_DATA)r.doMultipleToResource(o,1/u.multiples),r.changeResourceType(o,t.VOLATILE_DATA);else if(o.name===t.VOLATILE_DATA){var i=r.doMultipleToResource(o,u.multiples);r.changeResourceType(o,t.PERSISTENT_DATA),i>0&&r.addBuffToResource(o,s.ReduceComplexity,{leftTime:u.recoverTime,complexity:i})}else c(!1,"翻转不能接受该资源类型"+o.name)}))})),n._RF.push({},"00f66LZDrdHQpCL6ATWietQ","Flip",void 0);var i={name:r.FLIP,groundType:o.WIRE,effect:{funcName:r.FLIP,selector:{func:u.name}},funcs:{},consts:{effectColdDown:3,resourceNameFilter:[t.PERSISTENT_DATA,t.VOLATILE_DATA],multiples:2,recoverTime:5,buildAble:{cost:100}},desc:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/funcs.ts",["cc"],(function(){var c;return{setters:[function(t){c=t.cclegacy}],execute:function(){c._RF.push({},"d37a4bGlO5JN4Q+QNFidpxW","funcs",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/FunctionManager.ts",["cc","./common.ts"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy},function(t){n=t.bindAll}],execute:function(){e._RF.push({},"b054eT87TdBJ75tEpDUFERk","FunctionManager",void 0);t("FunctionManager",function(){function t(){this.context=void 0,this.settingDataManager=void 0,this.eventBus=void 0,this.lifeCycle=void 0,this.module=void 0,this.resource=void 0,this.lifeCycle={afterTicket:{},beforeTicket:{}},this.module={effect:{},onTick:{},onBuild:{},init:{},onNewWave:{}},this.resource={onArriveEnd:{},onTick:{},onMove:{},onDestroy:{},init:{},selector:{},buff:{init:{},onTick:{},onDestroy:{},beforeDamaged:{},onRepeat:{}}}}var e=t.prototype;return e.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.eventBus=t.managers.eventBus,n(this)},e.addFunction=function(t,e,n){if(e){var i=t(this);if(!i)throw new Error("未知方法 funcName:"+e);if(i[e])throw new Error("方法已经存在funcName:"+e);i[e]=n}},e.getFunction=function(t,e){if(e){var n=t(this);if(!n)throw new Error("未知方法 funcName:"+e);var i=n[e];if(!i)throw new Error("未知方法 funcName:"+e);return i}},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/GameContextBuilder.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./BuildingManager.ts","./EventBus.ts","./FunctionManager.ts","./GameEntityManager.ts","./GameLogicUtils.ts","./ResearchManager.ts","./SettingDataManager.ts","./TranslateManager.ts","./EnumDefine.ts","./GameData.ts","./Mod2.ts"],(function(n){var t,e,i,a,o,s,r,u,p,c,g,d,l,m,f;return{setters:[function(n){t=n.extends},function(n){e=n.cclegacy},function(n){i=n.assert,a=n.MyPoint},function(n){o=n.BuildingManager},function(n){s=n.EventBus},function(n){r=n.FunctionManager},function(n){u=n.GameEntityManager},function(n){p=n.GameLogicUtils},function(n){c=n.ResearchManager},function(n){g=n.SettingDataManager},function(n){d=n.TranslateManager},function(n){l=n.GroundTypeEnum},function(n){m=n.GameMap},function(n){f=n.Mods}],execute:function(){e._RF.push({},"0e675i0inRPQ7yBCirXImk6","GameContextBuilder",void 0);n("GameContextBuilder",function(){function n(){}var e=n.prototype;return e.buildEmptyAsset=function(){return{hp:{cur:100,max:100},energy:{cur:0,max:0},value:{cur:1e3,max:2e3},baseResearch:{cur:0,max:2e3}}},e.buildManagers=function(n){return n.managers={functionManager:new r,eventBus:new s,gameEntityManager:new u,settingDataManager:new g,gameLogicUtils:new p,buildingManager:new o,translateManager:new d,researchManager:new c},n.managers},e.build=function(n){var t=new m;t.sizeX=t.sizeY=8,t.mapUnits=[];for(var e=[],i=0;i<t.sizeY;i++){var o=[];t.mapUnits.push(o);for(var s=0;s<t.sizeX;s++){var r=0==i||s==t.sizeX-1?l.WIRE:l.INSULATION,u={module:void 0,position:new a(s,i),groundType:r};r==l.WIRE&&e.push(u),o.push(u)}}var p=t.mapUnits[0][0],c=t.mapUnits[t.sizeY-1][t.sizeX-1],g={eidPtr:0,tick:0,modules:{},resources:{},moduleMapUnits:[],map:t,alive:!0,asset:this.buildEmptyAsset(),research:{unlocked:{}},wavesInfo:{waves:n,nextPtr:0},place:{ends:[],starts:[]},roads:[{rid:0,start:p,end:c,wayPoints:e}],managers:{},cache:{},temp:{}},d=this.buildManagers(g),y=(d.gameEntityManager,d.buildingManager);return Object.values(g.managers).forEach((function(n){return n.setContext(g)})),f.forEach((function(n){null==n.onGameContextCreated||n.onGameContextCreated(g,[],[])})),y.afterModLoad(),g},e.buildByLevel=function(n){var e=new m;e.sizeX=n.width,e.sizeY=n.height,e.mapUnits=[];for(var o=0;o<e.sizeY;o++){var s=[];e.mapUnits.push(s);for(var r=0;r<e.sizeX;r++){var u=l.INSULATION,p={module:void 0,position:new a(r,o),groundType:u};s.push(p)}}var c=[];n.wayPoints.forEach((function(n){var t=[];c.push(t);var a=e.getAt(n[0]);i(!!a,"配置的路径超出地图范围"+JSON.stringify(n[0]));for(var o=1;o<n.length;o++){var s=e.getAt(n[o]);if(i(!!s,"配置的路径超出地图范围"+JSON.stringify(n[0])),a.position.x!==s.position.x&&a.position.y===s.position.y)for(var r=a.position.x>s.position.x?-1:1,u=a.position.x;u<s.position.x;u+=r){var p=e.getAt({x:u,y:s.position.y});p.groundType=l.WIRE,t.push(p)}else if(a.position.x===s.position.x&&a.position.y!==s.position.y)for(var g=a.position.y>s.position.y?-1:1,d=a.position.y;d<s.position.y;d+=g){var m=e.getAt({x:s.position.x,y:d});m.groundType=l.WIRE,t.push(m)}else if(a.position.x-s.position.x!=0&&Math.abs(a.position.x-s.position.x)==Math.abs(a.position.y-s.position.y))for(var f=a.position.x>s.position.x?-1:1,y=a.position.y>s.position.y?-1:1,v=a.position.x,h=a.position.y;v<s.position.x;v+=f,h+=y){var x=e.getAt({x:v,y:h});x.groundType=l.WIRE,t.push(x)}else i(!1,"不支持该路径方式");a=s}a.groundType=l.WIRE,t.push(a)})),n.grounds.forEach((function(n){var t=e.getAt(n.pos);i(!!t,"配置的地面类型超出地图范围"+JSON.stringify(n.pos)),t.groundType=n.ground}));var g=c.map((function(n){return n[0]})),d=c.map((function(n){return n[n.length-1]})),y=c.map((function(n,t){return{rid:t+1,start:n[0],end:n[n.length-1],wayPoints:n}})),v=t({},this.buildCommonData(),{asset:n.asset,map:e,wavesInfo:{nextPtr:0,waves:n.waves},place:{ends:d,starts:g},roads:y}),h=this.buildManagers(v),x=(h.gameEntityManager,h.buildingManager);return Object.values(v.managers).forEach((function(n){return n.setContext(v)})),f.forEach((function(n){null==n.onGameContextCreated||n.onGameContextCreated(v,[],[])})),n.limitModule&&x.lockAllExcept(n.limitModule),x.afterModLoad(),v},e.buildCommonData=function(){return{eidPtr:0,tick:0,modules:{},resources:{},moduleMapUnits:[],alive:!0,research:{unlocked:{}},managers:{},cache:{},temp:{}}},n}());e._RF.pop()}}}));

System.register("chunks:///_virtual/GameData.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"97a64W8Nq5L87uPIWLZb9H6","GameData",void 0);t("GameMap",function(){function t(){this.sizeX=void 0,this.sizeY=void 0,this.mapUnits=void 0,this.sizeX=50,this.sizeY=50,this.mapUnits=[]}var i=t.prototype;return i.filter=function(t){for(var i=[],s=0;s<this.sizeY;s++)for(var e=this.mapUnits[s],n=0;n<this.sizeX;n++)t(e[n])&&i.push(e[n]);return i},i.getAt=function(t){if(t)return this.mapUnits[t.y][t.x]?this.mapUnits[t.y][t.x]:void 0},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/GameEntity.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"9bb22mgtOFDYLoazN+A6QIc","GameEntity",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/GameEntityManager.ts",["cc","./common.ts","./EnumDefine.ts","./EventDefine.ts"],(function(e){var t,n,i,s,o,r;return{setters:[function(e){t=e.cclegacy},function(e){n=e.bindAll,i=e.MyPoint},function(e){s=e.ResourceDamageSourceEnum,o=e.AssetName},function(e){r=e.GameLogicEvent}],execute:function(){t._RF.push({},"d5efcOnCFFNYrqF0YdISqq5","GameEntityManager",void 0);e("GameEntityManager",function(){function e(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.gameLogicUtils=void 0}var t=e.prototype;return t.setContext=function(e){this.context=e,this.settingDataManager=e.managers.settingDataManager,this.functionManager=e.managers.functionManager,this.eventBus=e.managers.eventBus,this.gameLogicUtils=e.managers.gameLogicUtils,n(this)},t._buildModule=function(e,t){return{eid:e,alive:!0,position:i.ZERO,name:t.name,setting:t,effect:{timer:0},cache:{},store:{staging:[]},vars:{}}},t._buildResource=function(e,t,n,s){return{eid:e,name:t.name,setting:t,complexity:n,vars:null!=s?s:{},buffs:[],cache:{},alive:!0,position:i.ZERO}},t.createModule=function(e){var t=this.settingDataManager.getModule(e);if(!t)throw new Error("配置不存在"+e);var n=this._buildModule(++this.context.eidPtr,t),i=null==t?void 0:t.funcs.init,s=this.functionManager.getFunction((function(e){return e.module.init}),i);return null==s||s(this.context,n),n},t.registerModule=function(e,t){var n=this.context;t.module=e,e.position=t.position,n.modules[e.eid]=e,n.moduleMapUnits.push(t);var i={module:e};return n.managers.eventBus.pub(r.NEW_MODULE,i),e},t.createResource=function(e,t,n){var i=this.context,s=this.settingDataManager.getResource(e);if(!s)throw new Error("配置不存在"+e);var o=this._buildResource(++i.eidPtr,s,t,n),r=null==s?void 0:s.funcs.init,u=this.functionManager.getFunction((function(e){return e.resource.init}),r);return null==u||u(i,o),o},t.registerResource=function(e,t){return t.resource=e,e.position=t.position,this.context.resources[e.eid]=e,e},t.deRegisterResource=function(e,t){delete this.context.resources[e.eid],e.alive=!1;var n=this.context.map.getAt(e.position);(null==n?void 0:n.resource)===e&&(n.resource=void 0);var i={damageSource:t,resource:e};this.gameLogicUtils.checkResourceBuffDestroy(e);var u=this.functionManager.getFunction((function(e){return e.resource.onDestroy}),e.setting.funcs.onDestroy);u&&u(this.context,i);var a=e.setting.consts;return a.addValue&&[s.MODULE_PROCESSOR,s.MODULE_CONSUME,s.ENTER,s.BUFF].includes(t)&&this.gameLogicUtils.addAsset(o.VALUE,a.addValue),a.addEnergy&&[,s.ENTER].includes(t)&&this.gameLogicUtils.addAsset(o.ENERGY,a.addEnergy),a.damage&&[,s.ENTER].includes(t)&&this.gameLogicUtils.addAsset(o.ENERGY,a.damage),this.eventBus.pub(r.RESOURCE_DESTROYED,i),e},t.deRegisterModule=function(e){var t=this.context.map.getAt(e.position);return t&&delete t.module,delete this.context.modules[e.eid],this.context.moduleMapUnits=this.context.moduleMapUnits.filter((function(e){return!!e.module})),e},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/GameLogic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EventDefine.ts"],(function(e){var n,t,o,i;return{setters:[function(e){n=e.createForOfIteratorHelperLoose},function(e){t=e.cclegacy},function(e){o=e.GameOverError},function(e){i=e.GameLogicEvent}],execute:function(){t._RF.push({},"282660ewJNO3oyeER5uZRTk","GameLogic",void 0);e("GameLogic",function(){function e(e){this.pause=!1,this.gameContext=void 0,this.gameContext=e}var t=e.prototype;return t.init=function(){},t.getFunction=function(e,n){if(n)return this.gameContext.managers.functionManager.getFunction(e,n)},t.nextTick=function(){if(!this.pause)try{if(this.gameContext.alive&&(this.mainLogic(),!this.gameContext.alive))throw new o(!1)}catch(e){if(e instanceof o)this.gameContext.alive=!1,e.success?this.gameContext.managers.eventBus.pub(i.GAME_SUCCESS,void 0):this.gameContext.managers.eventBus.pub(i.GAME_FAIL,void 0);else console.log(e)}},t.mainLogic=function(){var e=this.gameContext;e.alive&&(e.temp={},this.beforeTickLogic(e),this.onTickLogic(),this.moveNextLogic(e),this.moduleLogic(e),this.entityAliveJudgeLogic(e),this.nextWaveLogic(e),this.afterTickLogic(e),e.tick++,this.debuggerChecker(e))},t.matchEffect=function(e,n,t,o){return!n||(n.func?e.managers.functionManager.getFunction((function(e){return e.resource.selector}),n.func)(e,t,o):void(n.or?alert("暂时不支持这种筛选器"):console.warn("指定了筛选器，但是没有指定筛选方式",JSON.stringify(null==(i=o.module)?void 0:i.setting))));var i},t.moduleLogic=function(e){var n=this;e.roads.forEach((function(t){for(var o=t.wayPoints.length-1;o>=1;o--){var i=t.wayPoints[o];if(i.module){var r=i.module,c=r.setting.effect;if(!c)return;var a=r.vars;if(a.effectColdDownTimer=void 0===a.effectColdDownTimer?0:a.effectColdDownTimer>=1?a.effectColdDownTimer-1:0,i.resource&&a.effectColdDownTimer<=0&&n.matchEffect(e,c.selector,i.resource,i)){var u=n.getFunction((function(e){return e.module.effect}),c.funcName),s=null==u?void 0:u(n.gameContext,i);if(null==s||!s.noColdDown){var f,l=null!=(f=r.setting.consts.effectColdDown)?f:1;a.effectColdDownTimer=l}}}}}))},t.onTickLogic=function(){var e=this,n=this.gameContext;n.moduleMapUnits.forEach((function(n){var t,o;null==(t=e.getFunction((function(e){return e.module.onTick}),null==(o=n.module.setting)||null==(o=o.funcs)?void 0:o.onTicket))||t(e.gameContext,n)})),Object.values(n.resources).forEach((function(t){var o,i;t.complexity&&(null==(o=e.getFunction((function(e){return e.resource.onTick}),null==(i=t.setting)||null==(i=i.funcs)?void 0:i.onTicket))||o(n,t),t.buffs.forEach((function(o){var i;null==(i=e.getFunction((function(e){return e.resource.buff.onTick}),o.setting.func.onTick))||i(n,t,o),void 0!==o.vars.leftTime&&o.vars.leftTime--})),n.managers.gameLogicUtils.checkResourceBuffDestroy(t))}))},t.beforeTickLogic=function(e){Object.values(e.managers.functionManager.lifeCycle.beforeTicket).forEach((function(n){return null==n?void 0:n(e)}))},t.afterTickLogic=function(e){Object.values(e.managers.functionManager.lifeCycle.afterTicket).forEach((function(n){return null==n?void 0:n(e)}))},t.moveNextLogic=function(e){e.roads.forEach((function(e){for(var n=e.wayPoints.length-1;n>0;n--){var t=e.wayPoints[n],o=e.wayPoints[n-1];!t.resource&&o.resource&&(t.resource=o.resource,t.resource.position=t.position,o.resource=void 0)}}))},t.nextWaveLogic=function(e,t){void 0===t&&(t=!1);var i=e.wavesInfo,r=i.nextPtr<i.waves.length?i.waves[i.nextPtr]:null;if(r&&(t||r.ticket<=e.tick)){if(r.info.length!=e.place.starts.length)throw new Error("波次数据和出生点数量不一致");i.nextPtr++,e.place.starts.forEach((function(t,o){var i=t.module.vars;i.index<i.wave.length?i.wave.splice(0,i.index):i.wave=[],i.index=0;for(var c,a=r.info[o],u=n(a);!(c=u()).done;){var s=c.value;if(s.name){var f=e.managers.gameEntityManager.createResource(s.name,s.complexity,s.ext);i.wave.push(f),f&&(e.resources[f.eid]=f)}else if(s.__nop__)for(var l=0;l<s.__nop__;l++)i.wave.push(void 0)}})),e.moduleMapUnits.filter((function(e){return e.module&&e.module.setting.funcs.onNewWave})).forEach((function(n){var t=n.module;e.managers.functionManager.getFunction((function(e){return e.module.onNewWave}),t.setting.funcs.onNewWave)(e,n)}))}else if(!t&&!r&&this.hasNoResources(e))throw new o(!0)},t.hasNoResources=function(e){return!Object.keys(e.resources).length&&e.place.starts.every((function(e){var n=e.module.vars;return n.index>=n.wave.length}))},t.entityAliveJudgeLogic=function(e){Object.values(e.resources).forEach((function(e){e.complexity||console.warn("漏网之鱼",JSON.stringify(e))}))},t.debuggerChecker=function(e){e.asset.hp.cur<=0&&e.alive&&console.warn("context 存活状态异常 ",e.asset.hp.cur,e.alive)},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/GameLogicUtils.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EnumDefine.ts","./BuffDefine.ts","./EventDefine.ts"],(function(e){var t,n,r,o,i,a,s,u,f;return{setters:[function(e){t=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy},function(e){r=e.bindAll,o=e.differObject2,i=e.JSON,a=e.assert},function(e){s=e.ResourceDamageSourceEnum},function(e){u=e.ResourceBuff},function(e){f=e.GameLogicEvent}],execute:function(){n._RF.push({},"7b66afG9BVCMbGK8oqUpg63","GameLogicUtils",void 0);e("GameLogicUtils",function(){function e(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.gameEntityManager=void 0,this.doDamageToResourceOptions={modifyAble:!0,dieAble:!1},this.direction4=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}]}var n=e.prototype;return n.setContext=function(e){this.context=e,this.settingDataManager=e.managers.settingDataManager,this.functionManager=e.managers.functionManager,this.eventBus=e.managers.eventBus,this.gameEntityManager=e.managers.gameEntityManager,r(this)},n.addBuffToResource=function(e,n,r){var a,s=this.settingDataManager.getResourceBuff(n);if(s){var f={name:s.name,setting:s,vars:null!=r?r:{},resource:e},c=e.buffs.findIndex((function(e){return e.name===s.name})),g=u.RepeatedBuffResolutionEnum,l=null!=(a=s.func.onRepeated)?a:g.REPLACE;c<0&&(l=g.IGNORE);var m=["leftTime","leftTimes"];if(g.IGNORE===l)e.buffs.push(f);else if(g.REPLACE===l)e.buffs[c];else if(g.ABANDON===l);else if(g.NUM_ADD===l){var h=e.buffs[c],v=o(h.vars,f.vars);if(v.delete.length||v.add.length)throw new Error("buff 合并失败 "+g.NUM_ADD+"  "+i.stringify(h)+"  "+i.stringify(f)+"  不能和差异数据");for(var d,y={},p=t(v.modify);!(d=p()).done;){var D=d.value,R=D.key,b=D.oldObj,E=D.newObj;if(m.includes(R)){if(b!==E)throw new Error("buff 合并失败 "+g.NUM_ADD+"  "+i.stringify(h)+"  "+i.stringify(f)+"  不能有不同的生命周期参数"+R+" 剩余时间等");y[R]=b}else{if(typeof b!=typeof E||"number"!=typeof b)throw new Error("buff 合并失败 "+g.NUM_ADD+"  "+i.stringify(h)+"  "+i.stringify(f)+"  key"+R+" 必须是数字");y[R]=b+E}}e.buffs[c].vars=y}else{var x=this.functionManager.getFunction((function(e){return e.resource.buff.onRepeat}),s.func.onRepeated);x&&(e.buffs[c]=x(this.context,e.buffs[c],f))}}},n.damageToHome=function(e){if(a(e>=0),0!=e){var t=this.context.asset.hp;t.cur-=e,t.cur<=0&&(this.context.alive=!1)}},n.damageToResource=function(e,t,n,r){var o,i;a(t>=0),0!=t&&0!=e.alive&&(r=null!=(o=r)?o:this.doDamageToResourceOptions,n=null!=(i=n)?i:s.UNKNOWN,t=this.doDamageToResource_CalculateBuff(t,e,n,r),e.complexity-=r.dieAble?Math.min(t,e.complexity-1):t,(e.complexity<=0||!e.alive)&&(console.log("gc"),this.gameEntityManager.deRegisterResource(e,n)))},n.forceDestroyResource=function(e,t){this.context.map.getAt(e.position);this.gameEntityManager.deRegisterResource(e,null!=t?t:s.UNKNOWN)},n.checkResourceBuffDestroy=function(e){var t=this;e.buffs=e.buffs.filter((function(n){var r,o=void 0;return e.alive||(o=u.BuffDestroyReasonEnum.RESOURCE_DESTROY),void 0!==n.vars.leftTime&&n.vars.leftTime<=0&&(o=u.BuffDestroyReasonEnum.TIME),void 0!==n.vars.leftTimes&&n.vars.leftTimes<=0&&(o=u.BuffDestroyReasonEnum.TIMES),!o||(null==(r=t.functionManager.getFunction((function(e){return e.resource.buff.onDestroy}),n.setting.func.onDestroy))||r(t.context,n.resource,n,o),!1)}))},n.doDamageToResource_CalculateBuff=function(e,t,n,r){var o=this,i={orgDamage:e,relDamage:e,target:t,damageSource:n,modifyAble:r.modifyAble};return t.buffs.forEach((function(r){var s=r.setting.func.beforeDamaged;if(s){var u=o.functionManager.getFunction((function(e){return e.resource.buff.beforeDamaged}),s);u&&(u(o.context,r,i),a(i.orgDamage==e&&i.target==t&&i.damageSource==n))}})),this.checkResourceBuffDestroy(t),r.modifyAble?i.relDamage:e},n.doMultipleToResource=function(e,t){if(a(t>0),0==e.alive)return 0;var n=e.complexity,r=e.complexity*t;return r=Math.max(Math.floor(r),1),e.complexity=r,r-n},n.changeResourceType=function(e,t){var n=this.settingDataManager.getResource(t);if(!n)throw new Error("changeResourceType no setting name:"+t);e.name=n.name,e.setting=n},n.addAsset=function(e,t){if(a(t>0),0!=t){var n=this.context.asset[e],r=n.cur;n.cur=Math.min(r+t,n.max);var o={original:r,current:n.cur,wantAmount:t};this.eventBus.pub(f.ASSET_USE,o)}},n.canUseAsset=function(e,t){return a(t>0),0==t||!(this.context.asset[e].cur<t)},n.useAsset=function(e,t){if(a(t>0),0==t)return!0;var n=this.context.asset[e],r=n.cur;if(r<t)return!1;n.cur-=t;var o={original:r,current:n.cur,wantAmount:t,forceUse:!1};return this.eventBus.pub(f.ASSET_USE,o),!0},n.countModuleByName=function(e){return Object.values(this.context.modules).filter((function(t){return t.name===e})).length},n.getAround4=function(e){var t=this.context.map,n=[];return this.direction4.forEach((function(r){var o=t.mapUnits[e.y+r.y];o?n.push(o[e.x+r.x]):n.push(void 0)})),n},n.healToHome=function(e){if(a(e>=0),e){var t=this.context.asset.hp;t.cur+=Math.max(Math.min(e,t.max-t.cur),0)}},e}());n._RF.pop()}}}));

System.register("chunks:///_virtual/Global.ts",["cc"],(function(){var t;return{setters:[function(c){t=c.cclegacy}],execute:function(){t._RF.push({},"94178Nhx+hEb6UYHwHAQo+1","Global",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/GlobalContextImpl.ts",["cc","./TranslateManager.ts"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy},function(t){n=t.TranslateManager}],execute:function(){e._RF.push({},"e2256zqChxOG7/BBwE9t4A4","GlobalContextImpl",void 0);var i=function(){function t(){this.levels={}}var e=t.prototype;return e.addLevel=function(t){this.levels[t.name]=t},e.getLevels=function(){return Object.values(this.levels)},e.getLevel=function(t){return this.levels[t]},t}();t("GlobalContext",new(function(){function t(){this.logic=void 0,this.context=void 0,this.levelManager=new i,this.translateManager=new n,this.gameUpdateTimer=void 0}var e=t.prototype;return e.setGameContext=function(t){t?(this.logic=t,this.context=t.gameContext,this.gameUpdateTimer&&clearTimeout(this.gameUpdateTimer)):(this.logic=void 0,this.context=void 0)},e.run=function(){var t=this;this.logic&&(this.logic.nextTick(),this.gameUpdateTimer=setTimeout((function(){t.run()}),1e3))},t}()));e._RF.pop()}}}));

System.register("chunks:///_virtual/GlobalInputEventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewGlobal.ts"],(function(n){var t,e,o,i,s,u,a,p;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator,i=n.Input,s=n.input,u=n.NodeEventType,a=n.Component},function(n){p=n.UIGlobalContext}],execute:function(){var r;e._RF.push({},"bcceeeXtw9MwKkTM7PMBxKX","GlobalInputEventManager",void 0);var E=o.ccclass;o.property,n("GlobalInputEventManager",E("GlobalInputEventManager")(r=function(n){function e(){return n.apply(this,arguments)||this}t(e,n);var o=e.prototype;return o.mouseDown=function(n){p.globalUIEvent.pub(i.EventType.MOUSE_DOWN,n)},o.mouseUp=function(n){p.globalUIEvent.pub(i.EventType.MOUSE_UP,n)},o.mouseMove=function(n){p.globalUIEvent.pub(i.EventType.MOUSE_MOVE,n)},o.manageEvent=function(n){var t=n?s.on.bind(s):s.off.bind(s),e=n?this.node.on.bind(this.node):this.node.off.bind(this.node);t(i.EventType.MOUSE_DOWN,this.mouseDown,this),t(i.EventType.MOUSE_UP,this.mouseUp,this),t(i.EventType.MOUSE_MOVE,this.mouseMove,this),e(u.MOUSE_DOWN,this.mouseDown,this),e(u.MOUSE_UP,this.mouseUp,this),e(u.MOUSE_MOVE,this.mouseMove,this)},o.start=function(){this.manageEvent(!0)},o.onDestroy=function(){this.manageEvent(!1)},e}(a))||r);e._RF.pop()}}}));

System.register("chunks:///_virtual/HarmlessProcessor.ts",["cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,c,t,s,o,u;return{setters:[function(e){n=e.cclegacy},function(e){c=e.ResourceDamageSourceEnum,t=e.GroundTypeEnum},function(e){s=e.ResourceTypeSelector},function(e){o=e.ModuleName,u=e.TResourceType}],execute:function(){e("run",(function(e,n){e(i),n((function(e){return e.module.effect}),i.name,(function(e,n){var t=n.resource,s=n.module;e.managers.gameLogicUtils.damageToResource(t,s.setting.consts.ability,c.MODULE_PROCESSOR),t.alive||e.managers.gameLogicUtils.healToHome(s.setting.consts.healAbility)}))})),n._RF.push({},"bcd5e3cdwtPEpG9lBRPiqvs","HarmlessProcessor",void 0);var i={name:o.HARMLESS_PROCESSOR,groundType:t.WIRE,effect:{funcName:o.HARMLESS_PROCESSOR,selector:{func:s.name}},funcs:{},consts:{effectColdDown:3,wantResourceType:u.COMMON,ability:2,healAbility:1,buildAble:{cost:40}},desc:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/IndependentProcessor.ts",["cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,t,c,o,u,s;return{setters:[function(e){n=e.cclegacy},function(e){t=e.ResourceDamageSourceEnum,c=e.GroundTypeEnum},function(e){o=e.ResourceTypeSelector},function(e){u=e.ModuleName,s=e.TResourceType}],execute:function(){e("run",(function(e,n){e(i),n((function(e){return e.module.effect}),i.name,(function(e,n){var c=n.resource,o=n.module,u=e.managers.gameLogicUtils.getAround4(o.position).filter((function(e){return null==e?void 0:e.module})).length,s=o.setting.consts.ability+(u?0:o.setting.consts.increaseAbility);e.managers.gameLogicUtils.damageToResource(c,s,t.MODULE_PROCESSOR)}))})),n._RF.push({},"ef1c8qdZW1LSqWz0IGH8y+M","IndependentProcessor",void 0);var i={name:u.INDEPENDENT_PROCESSOR,groundType:c.WIRE,effect:{funcName:u.INDEPENDENT_PROCESSOR,selector:{func:o.name}},funcs:{},consts:{effectColdDown:3,wantResourceType:s.COMMON,ability:1,increaseAbility:2,buildAble:{cost:40}},desc:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/InfoVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./EnumDefine.ts","./common.ts","./UIUtilities.ts","./ViewGlobal.ts"],(function(e){var i,t,n,o,r,l,a,u,s,c,m,d,p,f,g,b;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,a=e.Node,u=e.RichText,s=e.Label,c=e.Component},function(e){m=e.GlobalContext},function(e){d=e.TranslateScope},function(e){p=e.Timer},function(e){f=e.translateSettingString},function(e){g=e.InputMode,b=e.UIGlobalContext}],execute:function(){var y,v,x,N,I,T,h,D,M,F,E,w,O,U,z,_,A,C,B,L,R;r._RF.push({},"e5585OMnTFNwJ4Fq1DKaZyw","InfoVMgr",void 0);var S=l.ccclass,G=l.property;e("InfoVMgr",(y=S("InfoVMgr"),v=G({type:a,displayName:"地面信息面板"}),x=G({type:u,displayName:"地面信息文本"}),N=G({type:a,displayName:"模块信息面板"}),I=G({type:u,displayName:"模块名称文本"}),T=G({type:u,displayName:"模块描述文本"}),h=G({type:a,displayName:"资源信息面板"}),D=G({type:u,displayName:"资源名称文本"}),M=G({type:u,displayName:"资源描述文本"}),F=G({type:a,displayName:"建筑信息面板"}),y((O=i((w=function(e){function i(){for(var i,t=arguments.length,r=new Array(t),l=0;l<t;l++)r[l]=arguments[l];return i=e.call.apply(e,[this].concat(r))||this,n(i,"groundInfoForm",O,o(i)),n(i,"groundInfoText",U,o(i)),n(i,"moduleInfoForm",z,o(i)),n(i,"moduleNameText",_,o(i)),n(i,"moduleDescText",A,o(i)),n(i,"resourceInfoForm",C,o(i)),n(i,"resourceNameText",B,o(i)),n(i,"resourceDescText",L,o(i)),n(i,"buildingInfoForm",R,o(i)),i.buildingDescText=void 0,i.fixUpdateTimer=new p,i}t(i,e);var r=i.prototype;return r.loadRef=function(){var e;!this.buildingDescText&&(this.buildingDescText=null==(e=this.buildingInfoForm.getChildByName("TextDesc"))?void 0:e.getComponent(s))},r.start=function(){this.loadRef()},r.update=function(e){var i;if(this.fixUpdateTimer.addWait(e,.1)){var t=b.myInputSystem,n=m.context;if(n){var o=null!=(i=null==t?void 0:t.clickedPosition)?i:null==t?void 0:t.position,r=n.map.getAt(o),l=n.managers.translateManager.$;if(this.groundInfoForm.active=!!r&&t.inputMode==g.NONE){var a="地面类型: "+l(d.GROUND_NAME,r.groundType);this.groundInfoText.string=a}if(this.resourceInfoForm.active=!(null==r||!r.resource)&&t.inputMode==g.NONE){var u="资源: "+l(d.RESOURCE_NAME,r.resource.name)+"   复杂度:"+r.resource.complexity;r.resource.buffs.length&&(u+=" buff: ["+r.resource.buffs.map((function(e){return l(d.BUFF_NAME,e.name)+(e.vars.level?" 层数 "+e.vars.level:"")+(e.vars.complexity?" 复杂度 "+e.vars.complexity:"")})).join(" || ")+" ]"),this.resourceNameText.string=u,this.resourceDescText.string="描述: ?"}if((this.moduleInfoForm.active=!(null==r||!r.module)&&t.inputMode==g.NONE)&&(this.moduleNameText.string="模块: "+l(d.MODULE_NAME,r.module.name),this.moduleDescText.string="描述: ?"),t.inputMode===g.NONE){if(this.buildingInfoForm.active=!!t.mouseOverBuildAble){var s=n.managers.settingDataManager.getModule(t.mouseOverBuildAble);this.buildingDescText.string=f(n,d.MODULE_DESC,null==s?void 0:s.desc,s)}}else if(t.inputMode===g.BUILD_MODULE){if(this.buildingInfoForm.active=!!t.clickedBuildAble){var c=n.managers.settingDataManager.getModule(t.clickedBuildAble);this.buildingDescText.string=f(n,d.MODULE_DESC,null==c?void 0:c.desc,c)}}else this.buildingInfoForm.active=!1}}},i}(c)).prototype,"groundInfoForm",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=i(w.prototype,"groundInfoText",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=i(w.prototype,"moduleInfoForm",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=i(w.prototype,"moduleNameText",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=i(w.prototype,"moduleDescText",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=i(w.prototype,"resourceInfoForm",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=i(w.prototype,"resourceNameText",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=i(w.prototype,"resourceDescText",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=i(w.prototype,"buildingInfoForm",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=w))||E));r._RF.pop()}}}));

System.register("chunks:///_virtual/lan.ts",["cc","./EnumDefine.ts","./define.ts"],(function(E){var O,A,N,n,R,M,S;return{setters:[function(E){O=E.cclegacy},function(E){A=E.LangEnum,N=E.TranslateScope,n=E.GroundTypeEnum},function(E){R=E.ModuleName,M=E.ResourceName,S=E.ResourceBuffName}],execute:function(){E("init",(function(E){var O=E.$;if(E.lang!==A.CN)return;O(N.MODULE_NAME,R.END,"基地"),O(N.MODULE_NAME,R.START,"入口"),O(N.MODULE_NAME,R.PROCESSOR,"初级处理"),O(N.MODULE_NAME,R.FLIP,"初级翻转"),O(N.MODULE_NAME,R.ANALYZER,"初级分析"),O(N.MODULE_NAME,R.INDEPENDENT_PROCESSOR,"初级独立处理"),O(N.MODULE_NAME,R.COLLABORATIVE_PROCESSOR,"初级协同处理"),O(N.MODULE_NAME,R.HARMLESS_PROCESSOR,"初级无害化处理"),O(N.MODULE_NAME,R.RECYCLE,"初级回收"),O(N.MODULE_NAME,R.POLE_TRANSMISSION,"电极传输"),O(N.RESOURCE_NAME,M.META_DATA,"元数据"),O(N.RESOURCE_NAME,M.PERSISTENT_DATA,"持久数据"),O(N.RESOURCE_NAME,M.VOLATILE_DATA,"易失数据"),O(N.GROUND_NAME,n.INSULATION,"板面"),O(N.GROUND_NAME,n.WIRE,"导线"),O(N.GROUND_NAME,n.NONE,"未知"),O(N.GROUND_NAME,n.POLE,"电极"),O(N.BUFF_NAME,S.ReduceComplexity,"还原"),O(N.BUFF_NAME,S.ANALYZED,"被分析"),O(N.MODULE_DESC,R.PROCESSOR,"每[c.turn]回合 处理:[c.ability]"),O(N.MODULE_DESC,R.INDEPENDENT_PROCESSOR,"每[c.turn]回合 处理:[c.ability]\n如果四周没有其他模块,则 + [c.increaseAbility]"),O(N.MODULE_DESC,R.COLLABORATIVE_PROCESSOR,"每[c.turn]回合 处理:[c.ability]\n四周每有一个模块, + [c.increaseAbility]"),O(N.MODULE_DESC,R.FLIP,"每[c.turn]回合翻转数据\n持久数据 复杂度变为1/[c.multiples]\n易失数据 复杂度变为[c.multiples]"),O(N.MODULE_DESC,R.ANALYZER,"每[c.turn]回合给数据施加[c.ability]层被分析\n被分析:被处理时,复杂度额外降低n点,n为层数,每次生效减少一层"),O(N.MODULE_DESC,R.HARMLESS_PROCESSOR,"每[c.turn]回合 处理:[c.ability]\n如果销毁资源,然后恢复[c.healAbility]"),O(N.MODULE_DESC,R.RECYCLE,"每[c.turn]回合 销毁复杂度<=[c.ability]的资源,然后恢复[c.healAbility]生命值"),O(N.MODULE_DESC,R.POLE_TRANSMISSION,"每新波次回合 获得[c.value]价值")})),O._RF.push({},"c27e7ABUqxNeLkH+lXc3Jx2","lan",void 0),O._RF.pop()}}}));

System.register("chunks:///_virtual/Level.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"41b55t88tRH7ahl264EIlKF","Level",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/LevelItemVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./EnumDefine.ts"],(function(e){var t,n,i,o,r,l,a,c,s,u,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,a=e.Label,c=e.NodeEventType,s=e.Component},function(e){u=e.GlobalContext},function(e){p=e.TranslateScope}],execute:function(){var v,f,h,d,m;r._RF.push({},"00e13zBT/RFwbMKzVydO/2B","LevelItemVMgr",void 0);var y=l.ccclass,g=l.property;e("LevelItemVMgr",(v=y("LevelItemVMgr"),f=g({type:a}),v((m=t((d=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,i(t,"nameText",m,o(t)),t.level=void 0,t.onSelected=void 0,t}n(t,e);var r=t.prototype;return r.start=function(){},r.update=function(e){},r.init=function(e,t){this.level=e,this.onSelected=t,this.node.on(c.MOUSE_DOWN,this.onClick,this),this.nameText.string=u.translateManager.$(p.G_LEVEL_NAME,e.name)},r.onClick=function(){this.onSelected(this.level)},t}(s)).prototype,"nameText",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=d))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/LogicSystem.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"d36e32FqAZA5J5L97PP0ESu","LogicSystem",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./GameLogic.ts","./DemoBuilder.ts","./GameContextBuilder.ts","./BuildingManager.ts","./EventBus.ts","./FunctionManager.ts","./GameEntityManager.ts","./GameLogicUtils.ts","./ResearchManager.ts","./SettingDataManager.ts","./TranslateManager.ts","./GlobalContextImpl.ts","./common.ts","./EnumDefine.ts","./BuffDefine.ts","./EventDefine.ts","./GameData.ts","./GameEntity.ts","./Global.ts","./Level.ts","./LogicSystem.ts","./Mod2.ts","./SettingData.ts","./funcs.ts","./buff.ts","./main3.ts","./define.ts","./Analyzer.ts","./CollaborativeProcessor.ts","./End.ts","./Flip.ts","./HarmlessProcessor.ts","./IndependentProcessor.ts","./PolePowerStation.ts","./Processor.ts","./Recycle.ts","./Start.ts","./main4.ts","./main2.ts","./lan.ts","./main.ts","./mod.ts","./research.ts","./BottomMenuVMgr.ts","./CameraManager.ts","./GlobalInputEventManager.ts","./RenderManager.ts","./ResourceVMgr.ts","./UIUtilities.ts","./ViewGlobal.ts","./ModuleVMgr.ts","./MapUnitManager.ts","./AssetVMgr.ts","./BottomRightMenuVMgr.ts","./InfoVMgr.ts","./WaveInfoVMgr.ts","./BuildingItemVMgr.ts","./BuildingVMgr.ts","./LevelItemVMgr.ts","./SelectLevelVMgr.ts","./debug-view-runtime-control.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/main.ts",["cc","./define.ts"],(function(e){var c,t,n;return{setters:[function(e){c=e.cclegacy},function(e){t=e.ModuleName,n=e.ResourceName}],execute:function(){c._RF.push({},"1777cN0rQ1G05yHHSu+Bl7E","main",void 0);var a=[{name:n.META_DATA,complexity:2},{name:n.META_DATA,complexity:3},{__nop__:3}],i=[{name:n.META_DATA,complexity:3},{name:n.META_DATA,complexity:2},{__nop__:3}],u={name:"教程-处理",desc:"学习基础操作",width:6,height:4,waves:[{ticket:5,info:[[].concat(a,i,a,i,a,i,a,i,a,i,a,i)]}],wayPoints:[[{x:0,y:0},{x:2,y:0},{x:2,y:3},{x:5,y:3}]],asset:{hp:{cur:10,max:10},value:{cur:70,max:70},energy:{cur:0,max:0},baseResearch:{cur:0,max:0}},difficulty:0,limitModule:[t.PROCESSOR,t.COLLABORATIVE_PROCESSOR,t.INDEPENDENT_PROCESSOR],grounds:[]};e("levels",[u]);c._RF.pop()}}}));

System.register("chunks:///_virtual/main2.ts",["cc","./main3.ts","./define.ts"],(function(e){var n,a,c,o;return{setters:[function(e){n=e.cclegacy},function(e){a=e.CommonEnterHomeFunction},function(e){c=e.ResourceName,o=e.TResourceType}],execute:function(){e("init",(function(e,n,a){e.addResource(r),e.addResource(s),e.addResource(u)})),n._RF.push({},"2b616+aPHVIxbH6YSzB7pfW","main",void 0);var r={name:c.META_DATA,resourceType:o.COMMON,funcs:{onArriveEnd:a.name},consts:{damage:2,addValue:5}},s={name:c.PERSISTENT_DATA,resourceType:o.COMMON,funcs:{onArriveEnd:a.name},consts:{damage:2,addValue:8}},u={name:c.VOLATILE_DATA,resourceType:o.COMMON,funcs:{onArriveEnd:a.name},consts:{damage:2,addValue:2}};n._RF.pop()}}}));

System.register("chunks:///_virtual/main3.ts",["cc","./EnumDefine.ts"],(function(e){var n,t,c;return{setters:[function(e){n=e.cclegacy,t=e.assert},function(e){c=e.AssetName}],execute:function(){e("init",(function(e,n){[r].forEach((function(n){e.addFunction((function(e){return e.resource.onArriveEnd}),n.name,n.func)})),[o,u].forEach((function(n){e.addFunction((function(e){return e.resource.selector}),n.name,n.func)})),[a].forEach((function(n){e.addFunction((function(e){return e.module.onNewWave}),n.name,n.func)}))})),n._RF.push({},"59f76bX7fpKzZ6uNJTA9OcJ","main",void 0);var o=e("ResourceTypeSelector",{name:"ResourceTypeSelector",func:function(e,n,t){return t.module.setting.consts.wantResourceType===n.setting.resourceType}}),u=e("ResourceNameSelector",{name:"ResourceNameSelector",func:function(e,n,c){var o,u=c.module.setting.consts;return t(!(null==(o=u.resourceNameFilter)||!o.length)),u.resourceNameFilter.includes(n.name)}}),r=e("CommonEnterHomeFunction",{name:"CommonEnterHome",func:function(e,n,t){var c,o=n.setting.consts;e.managers.gameLogicUtils.damageToHome(null!=(c=o.damage)?c:1)}}),a=e("AddValuePerWave",{name:"AddValuePerWave",func:function(e,n){var t=n.module.setting.consts;e.managers.gameLogicUtils.addAsset(c.VALUE,t.value)}});n._RF.pop()}}}));

System.register("chunks:///_virtual/main4.ts",["cc","./Analyzer.ts","./CollaborativeProcessor.ts","./End.ts","./Flip.ts","./HarmlessProcessor.ts","./IndependentProcessor.ts","./PolePowerStation.ts","./Processor.ts","./Recycle.ts","./Start.ts"],(function(n){var t,o,u,r,c,e,i,s,a,f,l;return{setters:[function(n){t=n.cclegacy},function(n){o=n.run},function(n){u=n.run},function(n){r=n.run},function(n){c=n.run},function(n){e=n.run},function(n){i=n.run},function(n){s=n.run},function(n){a=n.run},function(n){f=n.run},function(n){l=n.run}],execute:function(){n("init",(function(n,t,d){var P=function(o){n.addModule(o),o.consts.buildAble&&t.addBuildAble(o.name)};function m(n,t,o){d.managers.functionManager.addFunction(n,t,o)}[a,i,u,c,o,r,e,s,f,l].forEach((function(n){return n(P,m)}))})),t._RF.push({},"87cfe1qPBlHHqz+jUokB7kw","main",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/MapUnitManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./common.ts","./ResourceVMgr.ts","./ViewGlobal.ts","./EnumDefine.ts"],(function(t){var o,n,i,e,s,u,r,c,p,a,l,h,d,M;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,e=t.Sprite,s=t.Node,u=t.Color,r=t.assert,c=t.Component},function(t){p=t.GlobalContext},function(t){a=t.MyPoint},function(t){l=t.ResourceVMgr},function(t){h=t.UIGlobalContext,d=t.InputMode},function(t){M=t.GroundTypeEnum}],execute:function(){var g;n._RF.push({},"c45fc6OVdNERImkTY6az4/W","MapUnitManager",void 0);var f=i.ccclass;t("MapUnitManager",f("MapUnitManager")(g=function(t){function n(){for(var o,n=arguments.length,i=new Array(n),e=0;e<n;e++)i[e]=arguments[e];return(o=t.call.apply(t,[this].concat(i))||this).bg=void 0,o.resourceViewMgr=void 0,o.mapUnit=void 0,o.position=void 0,o}o(n,t);var i=n.prototype;return i.loadRef=function(){!this.bg&&(this.bg=this.getComponent(e)),!this.resourceViewMgr&&(this.resourceViewMgr=this.getComponentInChildren(l))},i.start=function(){this.loadRef()},i.update=function(t){this.mapUnit&&this.mapUnit.groundType==M.WIRE&&this.resourceViewMgr.myUpdate(this.mapUnit.resource)},i.init=function(t){this.loadRef(),this.node.on(s.EventType.MOUSE_ENTER,this.onMouseEnter,this),this.node.on(s.EventType.MOUSE_LEAVE,this.onMouseOut,this),this.node.on(s.EventType.MOUSE_UP,this.onMouseClick,this),this.position=t.position,this.bg.color=t.groundType==M.INSULATION?new u(102,153,153):t.groundType==M.POLE?u.YELLOW:new u(187,140,68),this.mapUnit=t,this.resourceViewMgr.node.active=t.groundType==M.WIRE},i.onMouseEnter=function(t){h.myInputSystem.position=this.position},i.onMouseOut=function(t){this.position&&a.equals(this.position,h.myInputSystem.position)&&(h.myInputSystem.position=void 0)},i.onMouseClick=function(t){var o=h.myInputSystem;if(p.context&&p.context.alive)if(o.inputMode==d.BUILD_MODULE&&0==t.getButton()){r(!!o.clickedBuildAble,"建筑模式应该有选择的建筑");var n=p.context.managers.buildingManager.buildModule(p.context.map.getAt(this.position),o.clickedBuildAble);console.log("建造完成",JSON.stringify(n))}else o.inputMode==d.NONE&&0==t.getButton()&&(o.clickedPosition==this.position?o.clickedPosition=void 0:o.clickedPosition=this.position)},i.onDestroy=function(){this.node.off(s.EventType.MOUSE_UP,this.onMouseEnter,this),this.node.off(s.EventType.MOUSE_LEAVE,this.onMouseOut,this)},n}(c))||g);n._RF.pop()}}}));

System.register("chunks:///_virtual/mod.ts",["cc","./common.ts","./EnumDefine.ts","./Mod2.ts","./buff.ts","./main3.ts","./define.ts","./main4.ts","./main2.ts","./lan.ts","./main.ts","./research.ts"],(function(e){var n,t,i,a,o,c,r,u,s,l,d,m;return{setters:[function(e){n=e.cclegacy},function(e){t=e.MyPoint},function(e){i=e.GroundTypeEnum},function(e){a=e.ModInfoClass},function(e){o=e.init},function(e){c=e.init},function(e){r=e.ModuleName,u=e.ResourceName},function(e){s=e.init},function(e){l=e.init},function(e){d=e.init},function(e){m=e.levels},null],execute:function(){var f;n._RF.push({},"f3ceb7gYblEyo11MaQKOPIw","mod",void 0);e("ModInfo",a(f=function(){function e(){this.name="core",this.desc="",this.dependence=[],this.conflict=[],this.version="0.0.1"}var n=e.prototype;return n.onLoad=function(){console.log("core loaded")},n.onApplicationLoaded=function(e,n,a){var o=[{x:0,y:0},{x:7,y:0},{x:7,y:7}],c={name:"demo",desc:"测试地图哦",width:8,height:8,difficulty:1,waves:[{ticket:5,info:[[{name:u.META_DATA,complexity:20},{__nop__:5},{name:u.META_DATA,complexity:11},{name:u.PERSISTENT_DATA,complexity:12},{name:u.VOLATILE_DATA,complexity:13}]]}],wayPoints:[o],grounds:[{pos:new t(2,2),ground:i.POLE}],asset:{hp:{cur:100,max:100},energy:{cur:100,max:100},value:{cur:1e3,max:1e3},baseResearch:{cur:100,max:100}}};a.levelManager.addLevel(c),m.forEach((function(e){a.levelManager.addLevel(e)}))},n.onGameContextCreated=function(e,n,t){var i=e.managers,a=i.gameEntityManager,u=i.translateManager,m=i.functionManager,f=i.settingDataManager,g=i.buildingManager,p=e.map;l(f),s(f,g,e),d(u),o(m,f),c(m),a.registerModule(a.createModule(r.START),p.mapUnits[0][0]),a.registerModule(a.createModule(r.END),p.mapUnits[p.sizeY-1][p.sizeX-1]),e.place.ends=p.filter((function(e){var n;return(null==(n=e.module)?void 0:n.name)==r.END})),e.place.starts=p.filter((function(e){var n;return(null==(n=e.module)?void 0:n.name)==r.START}))},e}())||f);n._RF.pop()}}}));

System.register("chunks:///_virtual/Mod2.ts",["cc"],(function(n){var o;return{setters:[function(n){o=n.cclegacy}],execute:function(){o._RF.push({},"f3452ROgKZGo5l7ggIy4NCF","Mod",void 0);var t=n("Mods",[]);n("ModInfoClass",(function(n){var o=new n;t.push(o)}));o._RF.pop()}}}));

System.register("chunks:///_virtual/ModuleVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnumDefine.ts"],(function(e){var t,n,i,r,o,a,s,c,l,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,s=e.RichText,c=e.Sprite,l=e.Component},function(e){f=e.TranslateScope}],execute:function(){var u,p,d,h,y,g,m;o._RF.push({},"0c4809RZZBIxo/PQieuBmnE","ModuleVMgr",void 0);var v=a.ccclass,M=a.property;e("ModuleVMgr",(u=v("ModuleVMgr"),p=M({type:s}),d=M({type:c,displayName:"效果进度条"}),u((g=t((y=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,i(t,"nameText",g,r(t)),i(t,"effectBar",m,r(t)),t.entity=void 0,t.mapUnit=void 0,t.storeNodes=[],t}n(t,e);var o=t.prototype;return o.start=function(){},o.initNew=function(e,t){var n=e.managers.translateManager.$,i=t.module;this.nameText.string=n(f.MODULE_NAME,i.name),this.entity=i,this.mapUnit=t},o.update=function(e){if(this.entity){this.entity.store;this.renderEffectColdDown()}},o.renderEffectColdDown=function(){var e;if(!this.entity.setting.effect||!this.entity.setting.consts.effectColdDown||this.entity.setting.consts.effectColdDown<=0)this.effectBar.node.active=!1;else{this.effectBar.node.active=!0;var t=this.entity.setting.consts.effectColdDown,n=(t-(null!=(e=this.entity.vars.effectColdDownTimer)?e:t)+1)/t;this.effectBar.fillRange=n}},t}(l)).prototype,"nameText",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=t(y.prototype,"effectBar",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=y))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/PolePowerStation.ts",["cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,t,u,o;return{setters:[function(e){n=e.cclegacy},function(e){t=e.GroundTypeEnum},function(e){u=e.AddValuePerWave},function(e){o=e.ModuleName}],execute:function(){e("run",(function(e,n){e(c)})),n._RF.push({},"f73ca9/mJlIkJ51PlGyzYpR","PolePowerStation",void 0);var c={name:o.POLE_TRANSMISSION,groundType:t.POLE,funcs:{onNewWave:u.name},consts:{value:20,buildAble:{cost:50}},desc:{name:o.POLE_TRANSMISSION}};n._RF.pop()}}}));

System.register("chunks:///_virtual/Processor.ts",["cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,c,o,t,u,s;return{setters:[function(e){n=e.cclegacy},function(e){c=e.ResourceDamageSourceEnum,o=e.GroundTypeEnum},function(e){t=e.ResourceTypeSelector},function(e){u=e.ModuleName,s=e.TResourceType}],execute:function(){e("run",(function(e,n){e(r),n((function(e){return e.module.effect}),r.name,(function(e,n){var o=n.resource,t=n.module.setting.consts;e.managers.gameLogicUtils.damageToResource(o,t.ability,c.MODULE_PROCESSOR)}))})),n._RF.push({},"a2c7eILobdHhrbeiRyUsdP8","Processor",void 0);var r={name:u.PROCESSOR,groundType:o.WIRE,funcs:{},effect:{funcName:u.PROCESSOR,selector:{func:t.name}},consts:{effectColdDown:3,buildAble:{cost:30},ability:2,wantResourceType:s.COMMON},desc:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/Recycle.ts",["cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,c,t,o,u,s;return{setters:[function(e){n=e.cclegacy},function(e){c=e.ResourceDamageSourceEnum,t=e.GroundTypeEnum},function(e){o=e.ResourceTypeSelector},function(e){u=e.ModuleName,s=e.TResourceType}],execute:function(){e("run",(function(e,n){e(i),n((function(e){return e.module.effect}),i.name,(function(e,n){var t=n.resource,o=n.module;if(t.complexity>o.setting.consts.ability)return{noColdDown:!0};e.managers.gameLogicUtils.forceDestroyResource(t,c.MODULE_CONSUME),e.managers.gameLogicUtils.healToHome(o.setting.consts.healAbility)}))})),n._RF.push({},"329f5gXboFLSI7iQDnGGXsd","Recycle",void 0);var i={name:u.RECYCLE,groundType:t.WIRE,effect:{funcName:u.RECYCLE,selector:{func:o.name}},funcs:{},consts:{effectColdDown:5,wantResourceType:s.COMMON,ability:6,healAbility:2,buildAble:{cost:50}},desc:{name:u.RECYCLE}};n._RF.pop()}}}));

System.register("chunks:///_virtual/RenderManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./ModuleVMgr.ts","./MapUnitManager.ts"],(function(e){var i,t,r,n,o,a,l,s,u,p,c,m,d,f;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,l=e.Prefab,s=e.Vec2,u=e.Vec3,p=e.instantiate,c=e.Component},function(e){m=e.GlobalContext},function(e){d=e.ModuleVMgr},function(e){f=e.MapUnitManager}],execute:function(){var g,h,w,b,y,M,V,v,P,z,x;o._RF.push({},"8b898QPN3hLirOHCUF9G9O9","RenderManager",void 0);var C=a.ccclass,D=a.property;e("RenderManager",(g=C("RenderManager"),h=D({type:l,displayName:"模块预制体"}),w=D({type:l,displayName:"空地图块"}),b=D({type:s,displayName:"容器偏移"}),y=D({type:s,displayName:"模块UI的大小"}),g((v=i((V=function(e){function i(){for(var i,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return i=e.call.apply(e,[this].concat(o))||this,r(i,"modulePrefab",v,n(i)),r(i,"emptyMapPrefab",P,n(i)),r(i,"globalDiffer",z,n(i)),r(i,"moduleSize",x,n(i)),i.time=void 0,i.mapViews=void 0,i}t(i,e);var o=i.prototype;return o.start=function(){this.time=0,this.render()},o.update=function(e){m.logic&&(console.log("更新"),this.time+=e,this.time>=1&&(this.time-=1,m.logic.nextTick(),this.render()))},o.getViewPositionVec3=function(e){return new u(this.globalDiffer.x+this.moduleSize.x*e.x,this.globalDiffer.y-this.moduleSize.y*e.y)},o.createMapView=function(e){var i=p(this.emptyMapPrefab);i.parent=this.node;var t=this.getViewPositionVec3(e.position);i.position=t;var r=i.getComponent(f);return r.init(e),r},o.createModuleView=function(e,i){i.module;var t=p(this.modulePrefab),r=t.getComponent(d);return r.initNew(e,i),t.parent=this.node,t.position=this.getViewPositionVec3(i.position),r},o.render=function(){var e=m.logic.gameContext,i=e.map,t=i.sizeX,r=i.sizeY,n=i.mapUnits;if(!this.mapViews){this.mapViews=[];for(var o=0;o<r;o++){var a=[];this.mapViews.push(a);for(var l=0;l<t;l++){var s=n[o][l];a.push({mapGroundViewMgr:this.createMapView(s),mapUnit:s})}}}for(var u=0;u<r;u++)for(var p=this.mapViews[u],c=0;c<t;c++){var d=p[c],f=n[u][c];d.moduleViewMgr&&!f.module?(d.moduleViewMgr&&d.moduleViewMgr.node.destroy(),p[c].moduleViewMgr=void 0):!d.moduleViewMgr&&f.module&&(p[c].moduleViewMgr=this.createModuleView(e,f))}},i}(c)).prototype,"modulePrefab",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=i(V.prototype,"emptyMapPrefab",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=i(V.prototype,"globalDiffer",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s}}),x=i(V.prototype,"moduleSize",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s}}),M=V))||M));o._RF.pop()}}}));

System.register("chunks:///_virtual/research.ts",["cc"],(function(c){var e;return{setters:[function(c){e=c.cclegacy}],execute:function(){c("init",(function(c){})),e._RF.push({},"6c9b98Q76VHtJ6oylkfxI40","research",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/ResearchManager.ts",["cc","./common.ts","./EnumDefine.ts"],(function(e){var s,t,n;return{setters:[function(e){s=e.cclegacy},function(e){t=e.bindAll},function(e){n=e.AssetName}],execute:function(){s._RF.push({},"1ec1fRqjixAAqq0rapSjbRj","ResearchManager",void 0);e("ResearchManager",function(){function e(){this.context=void 0,this.researches=[],this.researchesMap={}}var s=e.prototype;return s.getAll=function(){return this.researches},s.unlock=function(e){var s,t=this.researchesMap[e.name];return t||(this.addResearchAble(e),(t=this.researchesMap[e.name]).locked=!0),!t.locked||!!this.context.managers.gameLogicUtils.useAsset(n.RESEARCH_BASE,t.item.cost)&&(this.researchesMap[e.name].locked=!1,this.context.managers.buildingManager.unLockModules(null!=(s=t.item.unLockModules)?s:[]),!0)},s.addResearchAble=function(e){if(!this.researchesMap[e.name]){var s={locked:!0,item:e};this.researchesMap[e.name]=s,this.researches.push(s)}},s.setContext=function(e){this.context=e,t(this)},e}());s._RF.pop()}}}));

System.register("chunks:///_virtual/ResourceVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,i,n,o,c,u,a,l,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,c=e._decorator,u=e.RichText,a=e.Sprite,l=e.Color,p=e.Component}],execute:function(){var s,b,g,f,h,y,m;o._RF.push({},"2f81aCXZudNhop8Y3PgzLcA","ResourceVMgr",void 0);var d=c.ccclass,x=c.property;e("ResourceVMgr",(s=d("ResourceVMgr"),b=x({type:u}),g=x({type:a}),s((y=t((h=function(e){function t(){for(var t,r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return t=e.call.apply(e,[this].concat(o))||this,i(t,"numberText",y,n(t)),i(t,"bgSprite",m,n(t)),t}r(t,e);var o=t.prototype;return o.start=function(){},o.update=function(e){},o.myUpdate=function(e){e?(this.numberText.enabled=!0,this.numberText.string=""+e.complexity,this.bgSprite.color=l.RED):(this.numberText.enabled=!1,this.bgSprite.color=l.WHITE)},t}(p)).prototype,"numberText",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=t(h.prototype,"bgSprite",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=h))||f));o._RF.pop()}}}));

System.register("chunks:///_virtual/SelectLevelVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameContextBuilder.ts","./GameLogic.ts","./GlobalContextImpl.ts","./EnumDefine.ts","./Mod2.ts","./ViewGlobal.ts","./LevelItemVMgr.ts"],(function(e){var t,n,r,i,l,o,a,c,s,u,p,f,v,d,g,b,h,L,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){l=e.cclegacy,o=e._decorator,a=e.Node,c=e.RichText,s=e.Prefab,u=e.instantiate,p=e.director,f=e.Component},function(e){v=e.GameContextBuilder},function(e){d=e.GameLogic},function(e){g=e.GlobalContext},function(e){b=e.TranslateScope},function(e){h=e.Mods},function(e){L=e.UIGlobalContext},function(e){m=e.LevelItemVMgr}],execute:function(){var y,x,C,G,M,S,w,E,I;l._RF.push({},"9682b2hp8pOu5ELftvUKQZ4","SelectLevelVMgr",void 0);var T=o.ccclass,V=o.property;e("SelectLevelVMgr",(y=T("SelectLevelVMgr"),x=V({type:a}),C=V({type:c}),G=V({type:s}),y((w=t((S=function(e){function t(){for(var t,n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return t=e.call.apply(e,[this].concat(l))||this,r(t,"levelContainer",w,i(t)),r(t,"descText",E,i(t)),r(t,"levelItemPrefab",I,i(t)),t.currentLevel=void 0,t}n(t,e);var l=t.prototype;return l.start=function(){var e=this;h.forEach((function(e){null==e.onApplicationLoaded||e.onApplicationLoaded([],[],g)})),this.levelContainer.children.forEach((function(e){return e.destroy()})),g.levelManager.getLevels().forEach((function(t){var n=u(e.levelItemPrefab);n.parent=e.levelContainer,n.getComponent(m).init(t,e.onSelected.bind(e))}))},l.onSelected=function(e){e.desc?(this.descText.string=g.translateManager.$(b.G_LEVEL_DESC,e.desc),this.currentLevel=e):this.descText.string=""},l.update=function(e){},l.onStartNewGame=function(){if(this.currentLevel){var e=new v;g.setGameContext(new d(e.buildByLevel(this.currentLevel))),L.clear(),p.loadScene("main")}else this.descText.string="please select level"},t}(f)).prototype,"levelContainer",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=t(S.prototype,"descText",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=t(S.prototype,"levelItemPrefab",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=S))||M));l._RF.pop()}}}));

System.register("chunks:///_virtual/SettingData.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"2443btoz0pAtpj6Ku66DwXZ","SettingData",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/SettingDataManager.ts",["cc","./common.ts"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy},function(t){n=t.bindAll}],execute:function(){e._RF.push({},"ac138Ldgi5AjoO4YC9BJ9z/","SettingDataManager",void 0);t("SettingDataManager",function(){function t(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.settings=void 0,this.settings={module:{},resource:{},buff:{resource:{}}},this.init()}var e=t.prototype;return e.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.functionManager=t.managers.functionManager,this.eventBus=t.managers.eventBus,n(this)},e.getResourceBuff=function(t){return this.settings.buff.resource[t]||console.warn("没有该buff name"+t),this.settings.buff.resource[t]},e.addResourceBuff=function(t){this.settings.buff.resource[t.name]=t},e.addModule=function(t){this.settings.module[t.name]=t},e.addResource=function(t){this.settings.resource[t.name]=t},e.getModule=function(t){return this.settings.module[t]},e.getResource=function(t){return this.settings.resource[t]},e.getModuleNames=function(){return Object.keys(this.settings.module)},e.init=function(){},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/Start.ts",["cc","./EnumDefine.ts","./define.ts"],(function(e){var n,t,r;return{setters:[function(e){n=e.cclegacy},function(e){t=e.GroundTypeEnum},function(e){r=e.ModuleName}],execute:function(){e("run",(function(e,n){e(u),n((function(e){return e.module.init}),u.name,(function(e,n){n.vars={wave:[],index:0}})),n((function(e){return e.module.onTick}),u.name,(function(e,n){var t=n.module.vars;if(!n.resource&&t.index<t.wave.length){var r=t.wave[t.index];t.index++,r&&(e.managers.gameEntityManager.registerResource(r,n),n.resource=r)}}))})),n._RF.push({},"6eeb7VgYpxLxrSXilIoFLOq","Start",void 0);var u={name:r.START,groundType:t.NONE,funcs:{init:r.START,onTicket:r.START},consts:{}};n._RF.pop()}}}));

System.register("chunks:///_virtual/TranslateManager.ts",["cc","./common.ts","./EnumDefine.ts"],(function(n){var t,a,e;return{setters:[function(n){t=n.cclegacy},function(n){a=n.bindAll},function(n){e=n.LangEnum}],execute:function(){t._RF.push({},"378e2I6djtBorvOXQ4EL4P0","TranslateManager",void 0);n("TranslateManager",function(){function n(){var n=this;this.lang=e.CN,this.lanMap2={},this.$=void 0;this.$=function(t,a,e){if(!e)return n.getTranslate2(t,a);n.setTranslate2(t,a,e)}}var t=n.prototype;return t.setContext=function(n){a(this)},t.setTranslate2=function(n,t,a){var e=this.lanMap2[n];e||(e=this.lanMap2[n]={}),e[t]=a},t.getTranslate2=function(n,t){var a,e=this.lanMap2[n];return e||(e=this.lanMap2[n]={}),null!=(a=e[t])?a:n+"::"+t},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/UIUtilities.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e;return{setters:[function(t){n=t.createForOfIteratorHelperLoose},function(t){e=t.cclegacy}],execute:function(){function r(t,e,r){if("c.turn"===e)return r.c.effectColdDown;var i=e.split("."),a=r;if("p"==i[0])return"<img src='"+i[1]+"'/>";for(var c,l=n(i);!(c=l()).done;){if(void 0===(a=a[c.value]))return"???? not matched"+e+" ????"}return a}t({translateSettingString:function(t,n,e,i){var a,c=t.managers.translateManager.$(n,null!=(a=null==e?void 0:e.name)?a:i.name),l={c:i.consts,v:{}},o=c.match(/\[(.*?)\]/g);return null==o||o.forEach((function(n){c=c.replace(n,r(t,n.slice(1,-1),l))})),c},translateString:function(t,n,e,i){var a,c=t.managers.translateManager.$(n,null!=(a=null==e?void 0:e.name)?a:i.name),l={c:i.setting.consts,v:i.vars},o=c.match(/\[(.*?)\]/g);return null==o||o.forEach((function(n){c=c.replace(n,r(t,n.slice(1,-1),l))})),c}}),e._RF.push({},"859d4Ljzi9Gq40VKU2yPC5a","UIUtilities",void 0);t("UseMemo",function(){function t(t,n,e){this.pre=void 0,this.callback=void 0,this.pre=t,this.callback=e?n.bind(e):n}return t.prototype.watch=function(t){t!==this.pre&&this.callback(t,this.pre),this.pre=t},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/ViewGlobal.ts",["cc","./common.ts"],(function(t){var e,i;return{setters:[function(t){e=t.cclegacy},function(t){i=t.bindAll}],execute:function(){e._RF.push({},"daee0q2Vj5DEqIMV4q8qyWX","ViewGlobal",void 0);var n=t("InputMode",{NONE:"none",BUILD_MODULE:"build_module"}),s=function(){function t(){this.listeners={},this.pub=this.pub.bind(this),this.sub=this.sub.bind(this)}var e=t.prototype;return e.pub=function(t,e){var i=this.listeners[t];i&&i.length&&i.forEach((function(t){t.listener(e)}))},e.sub=function(t,e,i){this.listeners[t]||(this.listeners[t]=[]),i&&(e=e.bind(i));var n=this.listeners[t].find((function(t){return t.listener==e&&(!i||t.$this==i)}));if(n){if(n.$this!=i)throw new Error("已经注册了该监听,但绑定的this不一致")}else this.listeners[t].push({listener:e,$this:i})},e.remove=function(t,e,i){if(this.listeners[t]){var n=this.listeners[t].findIndex((function(t){return t.listener==e&&(!i||t.$this==i)})),s=this.listeners[t][n];if(s)throw s.$this==i&&(this.listeners[t]=this.listeners[t].filter((function(t){return t!=s}))),new Error("已经注册了该监听,但解除绑定的this没有传")}},e.$=function(t){return t?this.sub:this.remove},e.clear=function(t){delete this.listeners[t]},t}(),r={inputMode:n.NONE},u=new s;i(u);var o=t("UIGlobalContext",{myInputSystem:r,globalUIEvent:u,clear:function(){o.myInputSystem={inputMode:n.NONE},o.globalUIEvent=new s}});e._RF.pop()}}}));

System.register("chunks:///_virtual/WaveInfoVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./EnumDefine.ts"],(function(t){var e,n,i,o,a,s,v,l,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.RichText,a=t.Button,s=t.NodeEventType,v=t.Component},function(t){l=t.GlobalContext},function(t){r=t.TranslateScope}],execute:function(){var c;n._RF.push({},"f4107h7KcJD44nnzmlP5fDZ","WaveInfoVMgr",void 0);var h=i.ccclass;i.property,t("WaveInfoVMgr",h("WaveInfoVMgr")(c=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).waveInfoText=void 0,e.btnNext=void 0,e.waveDetailText=void 0,e}e(n,t);var i=n.prototype;return i.loadRef=function(){var t,e,n;(!this.waveInfoText&&(this.waveInfoText=null==(t=this.node.getChildByName("TextWave"))?void 0:t.getComponent(o)),this.btnNext)||(this.btnNext=null==(e=this.node.getChildByName("BtnNextWave"))?void 0:e.getComponent(a),this.btnNext.node.on(s.MOUSE_DOWN,this.on_nextWave,this),this.btnNext.node.on(s.MOUSE_ENTER,this.on_showDetail,this),this.btnNext.node.on(s.MOUSE_LEAVE,this.on_hideDetail,this));this.waveDetailText||(this.waveDetailText=null==(n=this.node.getChildByName("TextWaveInfo"))?void 0:n.getComponent(o),this.waveDetailText.node.active=!1)},i.start=function(){this.loadRef()},i.update=function(t){var e=l.logic;if(e&&e.gameContext){if(e.gameContext.alive){var n=e.gameContext.wavesInfo;this.waveInfoText.string="波次:"+n.nextPtr+"/"+n.waves.length+"\n回合:"+e.gameContext.tick}else this.waveInfoText.string="已结束\n回合:"+e.gameContext.tick;if(this.waveDetailText.node.active){var i=e.gameContext.managers.translateManager.$,o=e.gameContext.wavesInfo,a=o.waves[o.nextPtr];if(!a)return this.waveDetailText.node.active=!1,void(this.waveDetailText.string="");var s="回合:"+a.ticket+"\n";a.info.forEach((function(t){t.forEach((function(t){t.name&&(s+=i(r.RESOURCE_NAME,t.name)+":(复杂度)"+t.complexity+"\n")}))})),this.waveDetailText.string=s}}},i.on_nextWave=function(t){var e=l.logic;0===t.getButton()&&e&&e.gameContext&&e.nextWaveLogic(e.gameContext,!0)},i.on_showDetail=function(t){this.waveDetailText.string="",this.waveDetailText.node.active=!0},i.on_hideDetail=function(t){this.waveDetailText.node.active=!1},n}(v))||c);n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});