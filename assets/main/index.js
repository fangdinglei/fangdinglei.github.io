System.register("chunks:///_virtual/Analyzer.ts",["cc","./EnumDefine.ts","./BuffDefine.ts","./define.ts"],(function(e){var n,u,t,r,c,f;return{setters:[function(e){n=e.cclegacy},function(e){u=e.GroundTypeEnum,t=e.RangeTypeEnum},function(e){r=e.ResourceBuff},function(e){c=e.ModuleName,f=e.TResourceType}],execute:function(){e("run",(function(e,n){e(o),n((function(e){return e.module.effect}),o.name,(function(e,n,u){var t={level:n.consts.ability};e.managers.gameLogicUtil.addBuffToResource(u[0],r.ResourceBuffName.ANALYZED,t)}))})),n._RF.push({},"136f9vx4ChG2KkkkOl2zqoW","Analyzer",void 0);var o={name:c.ANALYZER,groundType:u.PIN__8,funcs:{},consts:[{effect:{range:{type:t.CIRCULAR,range:2},resourceSelector:{resourceTypeFilter:[f.COMMON]},triggerInterval:60,funcName:c.ANALYZER},ability:2,maxBuffLevelCount:5,buildAble:{cost:50}}]};n._RF.pop()}}}));

System.register("chunks:///_virtual/AssetVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts"],(function(e){var t,r,n,o,i,a,s,c,l,p,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,s=e.Prefab,c=e.instantiate,l=e.RichText,p=e.Component},function(e){u=e.GlobalContext}],execute:function(){var f,h,g,v,b;i._RF.push({},"6586bZ+91RB/bhtproKPyGq","AssetVMgr",void 0);var d=a.ccclass,y=a.property;e("AssetVMgr",(f=d("AssetVMgr"),h=y({type:s}),f((b=t((v=function(e){function t(){for(var t,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,n(t,"infoPrefab",b,o(t)),t.nodes={},t}r(t,e);var i=t.prototype;return i.start=function(){},i.update=function(e){var t=u.logic,r={hp:"生命",value:"价值",baseResearch:"科研",energy:"能量"};if(t&&t.gameContext){var n=t.gameContext.asset;for(var o in n){var i,a=n[o];if(!this.nodes[o]){var s=c(this.infoPrefab);s.parent=this.node;var p=s.getComponent(l);this.nodes[o]=p}this.nodes[o].string=((null!=(i=r[o])?i:o)+":"+a.cur).padEnd(10," ")}}},t}(p)).prototype,"infoPrefab",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=v))||g));i._RF.pop()}}}));

System.register("chunks:///_virtual/BarVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIUtilities.ts"],(function(e){var t,i,n,r,a,o,l,s,u,c,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized,a=e.extends},function(e){o=e.cclegacy,l=e._decorator,s=e.UITransform,u=e.CCFloat,c=e.Component},function(e){h=e.UseMemo}],execute:function(){var p,d,f,g,v,m,y,b,w;o._RF.push({},"c8ce5q6iWBIiqisA5t+aNnc","BarVMgr",void 0);var x=l.ccclass,M=l.property;e("BarVMgr",(p=x("BarVMgr"),d=M({type:s}),f=M({type:[s]}),g=M({type:u}),p((y=t((m=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,n(t,"bg",y,r(t)),n(t,"valueNodes",b,r(t)),n(t,"maxWidth",w,r(t)),t.valueMemo=new h([],t.onValueChange,r(t)),t}i(t,e);var o=t.prototype;return o.start=function(){},o.init=function(e){this.node.active=!0,this.bg.width=this.maxWidth+2,this.myUpdate(e)},o.onValueChange=function(e,t){if(t&&t.length){if(t.length!=this.valueNodes.length)throw new Error("bar update fail:length not eq");for(var i=t.reduce((function(e,t){return e+t}),0),n=-this.maxWidth/2,r=0;r<this.valueNodes.length;r++){var o=this.valueNodes[r],l=t[r]*this.maxWidth/i;0!==l?(o.node.active=!0,o.width=l,o.node.position=a({},o.node.position,{x:n}),n+=l):o.node.active=!1}this.maxWidth}else this.node.active=!1},o.myUpdate=function(e){this.valueMemo.put(e)},t}(c)).prototype,"bg",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=t(m.prototype,"valueNodes",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Array}}),w=t(m.prototype,"maxWidth",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),v=m))||v));o._RF.pop()}}}));

System.register("chunks:///_virtual/Blocker.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BuffDefine.ts","./EnumDefine.ts","./BulletDefine.ts","./main3.ts","./define.ts"],(function(e){var t,n,r,u,o,i,a,c,l,f;return{setters:[function(e){t=e.extends},function(e){n=e.cclegacy},function(e){r=e.ResourceBuff},function(e){u=e.ModuleEffectTypeEnum,o=e.GroundTypeEnum,i=e.RangeTypeEnum},function(e){a=e.Bullet},function(e){c=e.FRAME_RATE},function(e){l=e.ModuleName,f=e.TResourceType}],execute:function(){e("run",(function(e,n){e(s),n((function(e){return e.bullet.lifeCycle.onTriggered}),s.name,(function(e,t,n,u){var o=t.attackerModule.consts;if(n!==a.BulletTargetEnum.Resource)throw new Error(" target type wrong");e.managers.damageManager.apply(u,t),u.alive&&e.managers.gameLogicUtil.addBuffToResource(u,r.ResourceBuffName.STOP,{leftTime:c*o.leftTime})})),n((function(e){return e.module.effect}),s.name,(function(e,n,r){var o=n.consts;e.managers.gameEntityManager.createAndRegisterBullet({effectType:u.PROCESS,ability:{processAbility:o.ability},targetType:a.BulletTargetEnum.Resource,moveSpeed:1/c,position:t({},n.position),target:r[0],onTriggered:s.name,attackerModule:n})}))})),n._RF.push({},"02352Y/Dh9LAbrViRq8lLVT","Blocker",void 0);var s={name:l.BLOCKER,groundType:o.PIN__8,funcs:{},consts:[{effect:{range:{type:i.CIRCULAR,range:1.5},resourceSelector:{resourceTypeFilter:[f.COMMON]},triggerInterval:30,funcName:l.BLOCKER},buildAble:{cost:150},leftTime:3,ability:1}]};n._RF.pop()}}}));

System.register("chunks:///_virtual/BottomMenuVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,n,e,r;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,r=t.Component}],execute:function(){var u;n._RF.push({},"0fc12Ej/apPj6Ls39iVKSeL","BottomMenuVMgr",void 0);var c=e.ccclass;e.property,t("BottomMenuVMgr",c("BottomMenuVMgr")(u=function(t){function n(){return t.apply(this,arguments)||this}o(n,t);var e=n.prototype;return e.start=function(){},e.update=function(t){},n}(r))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/BottomRightMenuVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewGlobal.ts"],(function(t){var n,o,e,s,i,u;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,s=t.NodeEventType,i=t.Component},function(t){u=t.UIGlobalContext}],execute:function(){var r;o._RF.push({},"366acyqI4pHro5/HPqgT82W","BottomRightMenuVMgr",void 0);var a=e.ccclass;e.property,t("BottomRightMenuVMgr",a("BottomRightMenuVMgr")(r=function(t){function o(){return t.apply(this,arguments)||this}n(o,t);var e=o.prototype;return e.manageEvent=function(t){t?(this.node.on(s.MOUSE_ENTER,this.onMouseEnter,this,!0),this.node.on(s.MOUSE_LEAVE,this.onMouseLeave,this,!0)):(this.node.off(s.MOUSE_ENTER,this.onMouseEnter,this,!0),this.node.off(s.MOUSE_LEAVE,this.onMouseLeave,this,!0))},e.start=function(){this.manageEvent(!0)},e.onDestroy=function(){this.onMouseLeave(),this.manageEvent(!1)},e.update=function(t){},e.onMouseEnter=function(){u.myInputSystem.mousePointMenu.data=this.node},e.onMouseLeave=function(){u.myInputSystem.mousePointMenu.data===this.node&&(u.myInputSystem.mousePointMenu.data=void 0)},o}(i))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/buff.ts",["cc","./EnumDefine.ts","./BuffDefine.ts","./common.ts"],(function(e){var n,u,f,o;return{setters:[function(e){n=e.cclegacy},function(e){u=e.ModuleEffectTypeEnum},function(e){f=e.ResourceBuff},function(e){o=e.assert}],execute:function(){e("init",(function(e,n){[t].forEach((function(e){return n.addFunction((function(e){return e.resource.buff.onDestroy}),e.name,e.func)})),[c].forEach((function(e){return n.addFunction((function(e){return e.resource.buff.beforeDamaged}),e.name,e.func)})),[s,r,i,m].forEach((function(n){return e.addResourceBuff(n)})),[l,R,E,v,d].forEach((function(e){return n.addFunction((function(e){return e.resource.buff.onRepeat}),e.name,e.func)}))})),n._RF.push({},"872e1e5uuNJy6/2PXlCWYFp","buff",void 0);var a=f.BuffDestroyReasonEnum,t={name:f.ResourceBuffName.UNSTABLE,func:function(e,n,f,t){o(!!f.vars.complexity),t===a.TIME&&e.managers.damageManager.applyUnstable(n,{effectType:u.UNSTABLE,ability:{processAbility:f.vars.complexity}})}},c={name:f.ResourceBuffName.ANALYZED,func:function(e,n,u){o(!!n.vars.level),u.relDamage+=n.vars.level,n.vars.level--,n.vars.level<=0&&(n.vars.leftTimes=0)}},s={name:f.ResourceBuffName.UNSTABLE,func:{onDestroy:t.name},consts:{maxTime:5},icon:{show:!1}},r={name:f.ResourceBuffName.ANALYZED,func:{beforeDamaged:c.name,onRepeated:f.ResourceBuffName.ANALYZED},consts:{},icon:{show:!1}},i={name:f.ResourceBuffName.SLOW_DOWN,func:{onRepeated:f.RepeatedBuffResolutionEnum.MAX_TIME},consts:{},icon:{show:!1}},m={name:f.ResourceBuffName.STOP,func:{onRepeated:f.RepeatedBuffResolutionEnum.MAX_TIME},consts:{},icon:{show:!1}},l={name:f.RepeatedBuffResolutionEnum.APPEND,func:function(e,n,u,f,o){f.buffs.push(u)}},R={name:f.RepeatedBuffResolutionEnum.REPLACE,func:function(e,n,u,f,o){f.buffs[o]=u}},E={name:f.RepeatedBuffResolutionEnum.ABANDON,func:function(e,n,u,f,o){}},v={name:f.RepeatedBuffResolutionEnum.MAX_TIME,func:function(e,n,u,f,o){var a,t;(null!=(a=f.buffs[o].vars.leftTime)?a:0)<=(null!=(t=u.vars.leftTime)?t:0)&&(f.buffs[o]=u)}},d={name:f.ResourceBuffName.ANALYZED,func:function(e,n,u,f,o){var a,t;n.vars.level=(null!=(a=n.vars.level)?a:0)+(null!=(t=u.vars.level)?t:0)}};n._RF.pop()}}}));

System.register("chunks:///_virtual/BuffDefine.ts",["cc"],(function(e){var E;return{setters:[function(e){E=e.cclegacy}],execute:function(){var u,R;e("ResourceBuff",void 0),E._RF.push({},"59d24W4wv9CHIaVX1UJ55KE","BuffDefine",void 0),(R=u||(u=e("ResourceBuff",{}))).BuffDestroyReasonEnum={TIMES:"TIMES",TIME:"TIME",RESOURCE_DESTROY:"RESOURCE_DESTROY"},R.RepeatedBuffResolutionEnum={APPEND:"APPEND",REPLACE:"REPLACE",ABANDON:"ABANDON",MAX_TIME:"MAX_TIME",OTHER:"自定义名称"},R.ResourceBuffName={UNSTABLE:"RBN_Unstable",ANALYZED:"RBN_Analyzed",SLOW_DOWN:"RBN_SLOW_DOWN",STOP:"STOP"},R.SLOW_DOWN_RATE=.7,E._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingItemVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewGlobal.ts"],(function(t){var e,i,n,o,s,u,a,l,d;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.RichText,s=t.NodeEventType,u=t.Color,a=t.Component},function(t){l=t.UIGlobalContext,d=t.InputMode}],execute:function(){var h;i._RF.push({},"68daeHYI0BAYpFkbsSUA/xZ","BuildingItemVMgr",void 0);var c=n.ccclass;t("BuildingItemVMgr",c("BuildingItemVMgr")(h=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).buildingName=void 0,e.text=void 0,e}e(i,t);var n=i.prototype;return n.start=function(){this.initRef(),this.manageEvent(!0)},n.initRef=function(){!this.text&&(this.text=this.getComponent(o))},n.manageEvent=function(t){t?(this.node.on(s.MOUSE_ENTER,this.onMouseEnter,this),this.node.on(s.MOUSE_DOWN,this.onMouseClick,this),this.node.on(s.MOUSE_LEAVE,this.onMouseLeave,this)):(this.node.off(s.MOUSE_ENTER,this.onMouseEnter,this),this.node.off(s.MOUSE_DOWN,this.onMouseClick,this),this.node.off(s.MOUSE_LEAVE,this.onMouseLeave,this))},n.init=function(t){this.buildingName=t,this.initRef()},n.update=function(t){this.text&&(this.text.fontColor=l.myInputSystem.clickedBuildAble.data===this.buildingName&&l.myInputSystem.inputMode.data===d.BUILD_MODULE?u.BLUE:u.WHITE)},n.onDestroy=function(){this.manageEvent(!1)},n.onMouseEnter=function(t){this.buildingName&&(l.myInputSystem.mouseOverBuildAble.data=this.buildingName)},n.onMouseLeave=function(t){this.buildingName&&l.myInputSystem.mouseOverBuildAble.data===this.buildingName&&(l.myInputSystem.mouseOverBuildAble.data=void 0)},n.onMouseClick=function(t){0==t.getButton()&&(l.myInputSystem.inputMode.data=d.BUILD_MODULE,l.myInputSystem.clickedBuildAble.data=this.buildingName)},i}(a))||h);i._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingManager.ts",["cc","./EnumDefine.ts","./EventDefine.ts"],(function(e){var t,n,i;return{setters:[function(e){t=e.cclegacy},function(e){n=e.AssetName},function(e){i=e.GameLogicEvent}],execute:function(){t._RF.push({},"19f71006hNN54H7IYxuTjfI","BuildingManager",void 0);e("BuildingManager",function(){function e(){this.context=void 0,this.settingDataManager=void 0,this.eventBus=void 0,this.gameLogicUtils=void 0,this.gameEntityManager=void 0,this.hasPriceModules={},this.lockedModules={}}var t=e.prototype;return t.setContext=function(e){this.context=e,this.settingDataManager=e.managers.settingDataManager,this.eventBus=e.managers.eventBus,this.gameLogicUtils=e.managers.gameLogicUtil,this.gameEntityManager=e.managers.gameEntityManager},t.afterGameContextFullInit=function(){var e=this;this.context.managers.settingDataManager.listModules().forEach((function(t){t.consts[0]&&t.consts[0].buildAble&&(e.hasPriceModules[t.name]=!0,e.lockedModules[t.name]=!1,e.context.setting.limitModule&&!e.context.setting.limitModule.includes(t.name)&&(e.lockedModules[t.name]=!0))})),this.context.managers.settingDataManager.listResearchAbles().forEach((function(t){t.unLockModules.forEach((function(t){e.hasPriceModules[t]&&(e.lockedModules[t]=!0)}))})),this.onBuildAbleModuleChange()},t.lockAllExcept=function(e){var t=this;Object.keys(this.hasPriceModules).forEach((function(n){t.lockedModules[n]=!e.includes(n)})),this.onBuildAbleModuleChange()},t.canBuildAt=function(e,t){var n=this.settingDataManager;if(e.module)return!1;var i="string"==typeof t?n.getModule(t):t;return e.groundType===i.groundType},t.getModuleCost=function(e,t){var n;void 0===t&&(t=0);var i=this.settingDataManager,s="string"==typeof e?i.getModule(e):e,o=null==(n=s.consts[t])?void 0:n.buildAble;if(!o)return 1/0;if(t>0||!o.punishment)return o.cost;var a=this.gameLogicUtils.countModuleByName(s.name);return o.cost+a*o.punishment},t.canBuildModule=function(e,t){var i=this.settingDataManager.getModule(t);if(!this.canBuildAt(e,i))return!1;var s=this.getModuleCost(i);return!(this.context.asset.value.cur<s)&&this.gameLogicUtils.useAsset(n.VALUE,s)},t.buildModule=function(e,t){if(this.canBuildModule(e,t)){var n=this.gameEntityManager.createModule(t);return this.gameEntityManager.registerModule(n,e),n}},t.onBuildAbleModuleChange=function(){var e={buildAbleModules:this.getBuildAbleModules()};this.eventBus.pub(i.BUILD_ABLE_MODULE_CHANGE,e)},t.getBuildAbleModules=function(){var e=[];for(var t in this.hasPriceModules)this.hasPriceModules[t]&&!this.lockedModules[t]&&e.push(t);return e},t.isLocked=function(e){return this.lockedModules[e]},t.unLockModules=function(e){var t=this;e.forEach((function(e){t.lockedModules[e]=!1})),this.onBuildAbleModuleChange()},t.lockModules=function(e){var t=this;e.forEach((function(e){t.lockedModules[e]=!0})),this.onBuildAbleModuleChange()},t.upgradeModule=function(e,t){if(!(e.level>=t)&&e.alive){if(e.level+1!=t)throw new Error("for module name: "+e.setting.name+",toLevel "+t+" must be 1 level bigger than "+e.level);if(e.setting.consts.length<=t||t<0)throw new Error("for module name: "+e.setting.name+",toLevel "+t+" must in [0,"+e.setting.consts.length+") because of setting.consts.length");var s=e.setting.consts[t];if(!s.buildAble)throw new Error("for module name: "+e.setting.name+",toLevel "+t+",not allowed,because the lack of buildAble");if(!this.context.managers.gameLogicUtil.useAsset(n.VALUE,s.buildAble.cost))throw new Error("for module name: "+e.setting.name+",not allowed,because the lack of [asset::value]");var o=e.consts;e.consts=s;var a={module:e,newLevel:t,oldConsts:o,newConsts:s};this.context.managers.eventBus.pub(i.MODULE_UPGRADED,a)}},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./common.ts","./EnumDefine.ts","./EventDefine.ts","./ViewGlobal.ts","./BuildingItemVMgr.ts"],(function(e){var t,n,i,l,o,u,a,s,r,d,c,b,g,h,f,p,M,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,l=e.assertThisInitialized},function(e){o=e.cclegacy,u=e._decorator,a=e.Prefab,s=e.Input,r=e.instantiate,d=e.RichText,c=e.Component},function(e){b=e.GlobalContext},function(e){g=e.differ},function(e){h=e.TranslateScope},function(e){f=e.GameLogicEvent},function(e){p=e.UIGlobalContext,M=e.InputMode},function(e){v=e.BuildingItemVMgr}],execute:function(){var A,m,E,B,y;o._RF.push({},"1e77b7jtQxMAZIWaSFE+erv","BuildingVMgr",void 0);var C=u.ccclass,I=u.property;e("BuildingVMgr",(A=C("BuildingVMgr"),m=I({type:a,displayName:"建筑项预制体"}),A((y=t((B=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return t=e.call.apply(e,[this].concat(o))||this,i(t,"selectAblePrefab",y,l(t)),t.buildAbleChanged=!0,t.buildAbleModules=void 0,t.lastRenderAbleModules={},t}n(t,e);var o=t.prototype;return o.onBuildAbleChangeEvent=function(e,t,n){this.buildAbleChanged=!0,this.buildAbleModules=n.buildAbleModules},o.onBuildModule=function(e,t,n){this.buildAbleChanged=!0},o.onRightClick=function(e){2==e.getButton()&&(p.myInputSystem.inputMode.data=M.NONE,p.myInputSystem.clickedBuildAble.data=void 0)},o.manageEvent=function(e){var t=e?b.context.managers.eventBus.sub:b.context.managers.eventBus.remove,n=e?p.globalUIEvent.sub:p.globalUIEvent.remove;t(f.BUILD_ABLE_MODULE_CHANGE,this.onBuildAbleChangeEvent,this),t(f.NEW_MODULE,this.onBuildModule,this),n(s.EventType.MOUSE_DOWN,this.onRightClick,this)},o.start=function(){this.manageEvent(!0)},o.onDestroy=function(){this.manageEvent(!1)},o.resetBuildAbleUI=function(){var e=this,t=b.context;this.buildAbleModules||(this.buildAbleModules=t.managers.buildingManager.getBuildAbleModules()),this.buildAbleChanged=!1;var n=this.buildAbleModules.reduce((function(e,t){return e[t]=t,e}),{}),i=g(this.lastRenderAbleModules,n),l=t.managers.translateManager,o=t.managers.buildingManager;i.add.forEach((function(t){var n=l.$(h.MODULE_NAME,t),i=r(e.selectAblePrefab);i.parent=e.node,i.getComponent(d).string=n+" cost:"+o.getModuleCost(t);var u=i.getComponent(v);u.init(t),e.lastRenderAbleModules[t]=u})),i.delete.forEach((function(t){delete e.lastRenderAbleModules[t.buildingName],t.node.destroy()}))},o.update=function(e){b.context&&this.buildAbleChanged&&this.resetBuildAbleUI()},o.onClickBuildingButton=function(){},t}(c)).prototype,"selectAblePrefab",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=B))||E));o._RF.pop()}}}));

System.register("chunks:///_virtual/BulletDefine.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){var u;e("Bullet",void 0),t._RF.push({},"3b132dkQNFEMo3x1iFOoDQ6","BulletDefine",void 0),(u||(u=e("Bullet",{}))).BulletTargetEnum={Resource:"R",Direction:"D",Destination:"DN"},t._RF.pop()}}}));

System.register("chunks:///_virtual/BulletVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./UIUtilities.ts","./ViewGlobal.ts","./EnumDefine.ts","./BulletDefine.ts"],(function(t){var e,i,n,r,l,o,a,s,u,c,p,h,b,f,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){l=t.cclegacy,o=t._decorator,a=t.Sprite,s=t.Vec3,u=t.tween,c=t.Component},function(t){p=t.GlobalContext},function(t){h=t.getViewPositionVec3},function(t){b=t.UIGlobalContext},function(t){f=t.DR_MAP},function(t){g=t.Bullet}],execute:function(){var w,y,v,d,M;l._RF.push({},"ebe7fd35RFGsr3QisCofP+t","BulletVMgr",void 0);var T=o.ccclass,x=o.property;t("BulletVMgr",(w=T("BulletVMgr"),y=x({type:a}),w((M=e((d=function(t){function e(){for(var e,i=arguments.length,l=new Array(i),o=0;o<i;o++)l[o]=arguments[o];return e=t.call.apply(t,[this].concat(l))||this,n(e,"bgSprite",M,r(e)),e.bullet=void 0,e.lastTween=void 0,e}i(e,t);var l=e.prototype;return l.start=function(){},l.init=function(t){this.bullet=t;var e=p.renderDataManager.getBulletSprite(t.effectType);this.bgSprite.spriteFrame=b.engineResourceManager.getSprite(e)},l.update=function(t){var e=this;if(this.bullet&&!this.lastTween){var i=this.bullet.position;i={x:Math.floor(1e3*i.x)/1e3,y:Math.floor(1e3*i.y)/1e3};var n,r=h(i);switch(this.bullet.targetType){case g.BulletTargetEnum.Destination:var l=this.bullet.target;n=new s,s.subtract(n,new s(l.x,l.y,0),new s(this.bullet.position.x,this.bullet.position.y,0));break;case g.BulletTargetEnum.Direction:var o=this.bullet.target;n=new s(f[o][0],f[o][1],0);break;case g.BulletTargetEnum.Resource:var a=this.bullet.target;n=new s,s.subtract(n,new s(a.position.x,a.position.y,0),new s(this.bullet.position.x,this.bullet.position.y,0));break;default:var c=this.bullet.targetType;throw new Error(c)}var p=180*Math.atan2(n.y,n.x)/Math.PI;this.lastTween=u(this.node),this.lastTween.to(0,{position:r,eulerAngles:new s(0,0,p-90)}).call((function(){return e.lastTween=void 0})).start()}},e}(c)).prototype,"bgSprite",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=d))||v));l._RF.pop()}}}));

System.register("chunks:///_virtual/CameraManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameLogic.ts","./GameContextBuilder.ts","./GlobalContextImpl.ts","./Mod2.ts","./ViewGlobal.ts"],(function(t){var e,n,o,a,i,s,r,u,d,p,c,l,M,m,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){i=t.cclegacy,s=t._decorator,r=t.Node,u=t.Vec2,d=t.Component},function(t){p=t.GameLogic},function(t){c=t.GameContextBuilder},function(t){l=t.GlobalContext},function(t){M=t.Mods},function(t){m=t.UIGlobalContext,y=t.InputMode}],execute:function(){var g,h,f,E,v,I;i._RF.push({},"8623flulA5K+4h5udynbbwd","CameraManager",void 0);var S=s.ccclass,L=s.property;t("CameraManager",(g=S("CameraManager"),h=L({type:r}),g(((I=function(t){function e(){var e;if(e=t.call(this)||this,o(e,"gameContainer",v,a(e)),e.startPos=void 0,e.dragStartMode=void 0,l.logic)return a(e);M.forEach((function(t){null==t.onApplicationLoaded||t.onApplicationLoaded([],[],l)})),m.engineResourceManager.loadAll();var n=new c;return l.setGameContext(new p(n.buildByLevel(l.levelManager.getLevels()[0]))),e}n(e,t);var i=e.prototype;return i.start=function(){e.INSTANCE=this,m.myInputSystem.inputMode.on((function(t,e){e===y.VIEW_DRAG&&t===y.ON_UI&&(m.myInputSystem.inputMode.data=y.NONE)}))},i.update=function(t){},i.manageEvent=function(t){var e=m.globalUIEvent.$(!0);e(r.EventType.MOUSE_DOWN,this.onMouseDown,this),e(r.EventType.MOUSE_MOVE,this.onMouseMove,this),e(r.EventType.MOUSE_UP,this.onMouseUp,this),e(r.EventType.MOUSE_LEAVE,this.onMouseUp,this)},i.onLoad=function(){this.manageEvent(!0)},i.dragAbleMode=function(){return m.myInputSystem.inputMode.data===y.NONE||m.myInputSystem.inputMode.data===y.BUILD_MODULE},i.onMouseDown=function(t){0==t.getButton()&&this.dragAbleMode()&&(this.startPos=t.getLocation(),this.dragStartMode=m.myInputSystem.inputMode.data)},i.onMouseMove=function(t){if(this.startPos&&this.dragAbleMode()&&u.distance(this.startPos,t.getLocation())>=m.DRAG_DISTANCE&&(m.myInputSystem.inputMode.data=y.VIEW_DRAG),m.myInputSystem.inputMode.data===y.VIEW_DRAG&&this.gameContainer){var e=t.getLocation().subtract(this.startPos);this.gameContainer.position=this.node.position.add3f(e.x,e.y,0),this.startPos=t.getLocation()}},i.onMouseUp=function(t){0==t.getButton()&&(this.startPos=void 0,m.myInputSystem.inputMode.data===y.VIEW_DRAG&&(this.dragStartMode&&this.dragStartMode===y.BUILD_MODULE&&m.myInputSystem.clickedBuildAble.data?m.myInputSystem.inputMode.data=y.BUILD_MODULE:m.myInputSystem.inputMode.data=y.NONE))},i.onDestroy=function(){this.manageEvent(!1)},e}(d)).INSTANCE=void 0,v=e((E=I).prototype,"gameContainer",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=E))||f));i._RF.pop()}}}));

System.register("chunks:///_virtual/CircularRangeIndicator.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,c,o;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e._decorator,c=e.Vec3,o=e.Component}],execute:function(){var i;n._RF.push({},"e078cB/ce9Ehqk3yfuoJLCz","CircularRangeIndicator",void 0);var a=r.ccclass;r.property,e("CircularRangeIndicator",a("CircularRangeIndicator")(i=function(e){function n(){return e.apply(this,arguments)||this}return t(n,e),n.prototype.setData=function(e,t){e?(this.node.active=!0,this.node.scale=new c(2*t,2*t,1)):this.node.active=!1},n}(o))||i);n._RF.pop()}}}));

System.register("chunks:///_virtual/CollaborativeProcessor.ts",["cc","./common.ts","./EnumDefine.ts","./BulletDefine.ts","./main3.ts","./define.ts"],(function(n){var e;return{setters:[function(n){e=n.cclegacy},null,null,null,null,null],execute:function(){n("run",(function(n,e){return})),e._RF.push({},"4fb19qflWJCzLnM3xxm4Q/f","CollaborativeProcessor",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/common.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.js","./EnumDefine.ts"],(function(t){var e,n,r,i,o,s,a,u;return{setters:[function(t){e=t.createForOfIteratorHelperLoose,n=t.inheritsLoose,r=t.createClass,i=t.wrapNativeSuper},function(t){o=t.cclegacy},function(t){s=t.stringify,a=t.parse},function(t){u=t.DirectionTypeEnum}],execute:function(){t({assert:function(t,e){if(!t)throw console.error("assert error"+(null!=e?e:"")),new Error("assert error"+(null!=e?e:""))},bindAll:function(t){for(var n,r=e(Object.getOwnPropertyNames(Object.getPrototypeOf(t)));!(n=r()).done;){var i=n.value;"function"==typeof t[i]&&(t[i]=t[i].bind(t))}},differ:function(t,e){var n={add:[],modify:[],delete:[]};for(var r in t){var i=t[r],o=e[r];i&&o?n.modify.push({oldObj:i,newObj:o}):i&&n.delete.push(i)}for(var s in e){var a=t[s],u=e[s];a||n.add.push(u)}return n},differObject2:function(t,e){var n={add:[],modify:[],delete:[]};for(var r in t){var i=t[r],o=e[r];i&&o?n.modify.push({key:r,oldObj:i,newObj:o}):i&&n.delete.push({obj:i,key:r})}for(var s in e){var a=t[s],u=e[s];a||n.add.push({obj:u,key:s})}return n}}),o._RF.push({},"2e0ddWnOrtAyYuiNM5hMk0F","common",void 0),t("MyPointClass",function(){function t(t,e){this.x=void 0,this.y=void 0,this.x=t,this.y=e}var e=t.prototype;return e.pointOfDirection=function(e){if(e==u.DOWN)return new t(this.x,this.y-1);if(e==u.UP)return new t(this.x,this.y+1);if(e==u.LEFT)return new t(this.x-1,this.y);if(e==u.RIGHT)return new t(this.x+1,this.y);throw new Error("未知方向")},e.equals=function(t){return t&&t.x==this.x&&t.y==this.y},t.equals=function(t,e){return t==e||null==t&&null==e||t&&e&&t.x==e.x&&e.y==t.y},t}()).ZERO_RAW={x:0,y:0};t("Timer",function(){function t(){this.time=Date.now()}var e=t.prototype;return e.add=function(t){this.time-=t},e.reset=function(){this.time=Date.now()},e.wait=function(t){return Date.now()-this.time>=t},t}());t("GameOverError",function(t){function e(e){var n;return(n=t.call(this,"游戏结束"+e)||this).success=void 0,n.success=e,n}return n(e,t),e}(i(Error))),t("JSON",{stringify:s,parse:a});t("WatchAble",function(){function t(t){this._data=void 0,this.listeners=[],this._data=t}var e=t.prototype;return e.setData=function(t){return this._data!==t&&(this.data=t,!0)},e.off=function(t,e){for(var n=0;n<this.listeners.length;n++){var r=this.listeners[n];if(r.c===t&&r.o===e){this.listeners.slice(n,1);break}}},e.on=function(t,e){this.listeners.push({o:e,c:t})},r(t,[{key:"data",get:function(){return this._data},set:function(t){if(this._data!==t){var e=this._data;this._data=t,this.listeners.forEach((function(n){n.o?n.c.apply(n.o,[e,t]):n.c(e,t)}))}}}]),t}()),t("DEFAULT","default");o._RF.pop()}}}));

System.register("chunks:///_virtual/DamageManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EnumDefine.ts","./BuffDefine.ts"],(function(e){var a,t,i,s,n,r,l;return{setters:[function(e){a=e.createForOfIteratorHelperLoose},function(e){t=e.cclegacy},function(e){i=e.bindAll,s=e.assert},function(e){n=e.ModuleEffectTypeEnum,r=e.AssetName},function(e){l=e.ResourceBuff}],execute:function(){t._RF.push({},"487f2m//X1H4rb9ODmEiOu/","DamageManager",void 0);e("DamageManager",function(){function e(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.gameEntityManager=void 0,this.buffManager=void 0,this.gameLogicUtils=void 0}var t=e.prototype;return t.setContext=function(e){this.context=e,this.settingDataManager=e.managers.settingDataManager,this.functionManager=e.managers.functionManager,this.eventBus=e.managers.eventBus,this.gameEntityManager=e.managers.gameEntityManager,this.buffManager=e.managers.buildingManager,this.gameLogicUtils=e.managers.gameLogicUtil,i(this)},t.checkCanApplyOfLocked=function(e,a){return e&&e.vars.lockedByBullet&&e.vars.lockedByBullet!==a?void 0:e},t.removeLocker=function(e,a){if(!e)return e;e.vars.lockedByBullet===a||e.vars.lockedByBullet},t.apply=function(e,a){var t=this.checkCanApplyOfLocked(e,a);if(t){switch(a.effectType){case n.PROCESS:this.applyProcess(t,a);break;case n.BATCH_PROCESS:this.applyBatchProcess(t,a);break;case n.ANALYSIS:this.applyAnalysis(t,a);break;case n.DEBUG:this.applyFix(t,a);break;case n.FLIP:throw new Error("TODO");case n.UNSTABLE:this.applyUnstable(t,a);break;case n.INTERFERE:this.applyInterfere(t,a);break;case n.MERGE:this.applyMerge(t,a);break;case n.DECOMPOSE:this.applyDecompose(t,a);break;case n.INSPIRE:this.applyInspire(t,a);break;case n.CONSUME:this.applyConsume(t,a)}this.removeLocker(e,a)}},t.applyProcess=function(e,a){var t,i=null==(t=a.ability)?void 0:t.processAbility;if(s(i&&i>=0),0!=e.alive){var n=this.applyProcess_CalculateBuff(i,e,a);e.vars.complexity-=n,(e.vars.complexity<=0||!e.alive)&&(this.gameEntityManager.deRegisterResource(e,a),this.applyInspire(e,a))}},t.applyBatchProcess=function(e,t){var i,n=null==(i=t.ability)?void 0:i.processAbility;s(n&&n>=0);for(var r,l=a(e);!(r=l()).done;){var o=r.value;if(0!=o.alive){var c=this.applyProcess_CalculateBuff(n,o,t);o.vars.complexity-=c,(o.vars.complexity<=0||!o.alive)&&(this.gameEntityManager.deRegisterResource(o,t),this.applyInspire(o,t))}}},t.applyFix=function(e,a){var t,i=null==(t=a.ability)?void 0:t.debugAbility;if(s(i&&i>=0),0!=e.alive){var n=this.applyProcess_CalculateBuff(i,e,a);e.vars.complexity-=n,(e.vars.complexity<=0||!e.alive)&&(this.gameEntityManager.deRegisterResource(e,a),this.applyInspire(e,a))}},t.applyAnalysis=function(e,a){if(a.ability.analysisAbility&&!(a.ability.analysisAbility<=0)){var t={level:a.ability.analysisAbility};this.gameLogicUtils.addBuffToResource(e,l.ResourceBuffName.ANALYZED,t)}},t.applyUnstable=function(e,a){var t,i=null==(t=a.ability)?void 0:t.processAbility;if(s(i&&i>=0),0!=e.alive){var n=i;e.vars.complexity-=n,e.vars.complexity<=0&&(e.vars.complexity=1)}},t.applyMerge=function(e,a){},t.applyDecompose=function(e,a){},t.applyInterfere=function(e,a){},t.applyInspire=function(e,a){var t=e.consts;t.addValue&&this.gameLogicUtils.addAsset(r.VALUE,t.addValue),t.addEnergy&&this.gameLogicUtils.addAsset(r.ENERGY,t.addEnergy)},t.applyConsume=function(e,a){0!=e.alive&&(e.alive=!1,e.vars.complexity=0,this.gameEntityManager.deRegisterResource(e,a))},t.applyDestroy=function(e){if(0!=e.alive){var a={effectType:n.DESTROY,ability:{}};this.gameEntityManager.deRegisterResource(e,a)}},t.applyProcess_CalculateBuff=function(e,a,t){var i=this,s={orgDamage:e,relDamage:e,target:a,bullet:t};return a.buffs.forEach((function(e){var a=e.setting.func.beforeDamaged;if(a){var t=i.functionManager.getFunction((function(e){return e.resource.buff.beforeDamaged}),a);t&&t(i.context,e,s)}})),this.gameLogicUtils.checkResourceBuffDestroy(a),s.relDamage},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/define.ts",["cc"],(function(R){var E;return{setters:[function(R){E=R.cclegacy}],execute:function(){E._RF.push({},"5a81ew3SrdPMKPM3AgTE6wf","define",void 0);R("ModuleName",{START:"MN_START",END:"MN_END",PROCESSOR:"MN_PROCESS",INDEPENDENT_PROCESSOR:"MN_INDEPENDENT_PROCESSOR",COLLABORATIVE_PROCESSOR:"MN_COLLABORATIVE_PROCESSOR",HARMLESS_PROCESSOR:"MN_HARMLESS_PROCESSOR",RECYCLE:"MN_RECYCLE",FLIP:"MN_FLIP",ANALYZER:"MN_ANALYZER",LABORATORY:"MN_LABORATORY",JAMMER:"MN_JAMMER",BLOCKER:"MN_BLOCKER",PROCESSOR_N:"MN_PROCESSOR_N",POWERFUL_PROCESSOR:"MN_POWERFUL_PROCESSOR",REINFORCER:"MN_REINFORCER",OPERATIONS:"MN_OPERATIONS",MAINTENANCE:"MN_MAINTENANCE",POLE_TRANSMISSION:"MN_POLE_TRANSMISSION",FORGET:"MN_FORGET",CALCULATOR:"MN_CALCULATOR",INTERCEPTOR:"MN_INTERCEPTOR",POLE_POWER_STATION:"MN_POLE_POWER_STATION",CAPACITANCE:"MN_CAPACITANCE",POWERED_LABORATORY:"MN_POWERED_LABORATORY",POWERED_PROCESSOR:"MN_POWERED_PROCESSOR",POWERED_FLIP:"MN_POWERED_FLIP",REFACTOR:"MN_REFACTOR",SUICIDAL_PROCESS:"MN_SUICIDAL_PROCESS",PROCESS_ACCELERATOR:"MN_PROCESS_ACCELERATOR"}),R("ResourceName",{META_DATA:"RT_META_DATA",PERSISTENT_DATA:"RT_PERSISTENT_DATA",VOLATILE_DATA:"RT_VOLATILE_DATA",BACKUP_DATA:"RT_BACKUP_DATA",DISTRIBUTED_DATA:"RT_DISTRIBUTED_DATA",BUG:"RT_BUG",VULNERABILITY:"RT_VULNERABILITY",ENERGY:"RT_ENERGY",VALUE:"RT_VALUE"}),R("TResourceType",{COMMON:"TL_COMMON",DANGER:"TL_DANGER",SPECIAL:"TL_SPECIAL"});E._RF.pop()}}}));

System.register("chunks:///_virtual/DelayShow.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,o,e,i,c;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy,e=n._decorator,i=n.NodeEventType,c=n.Component}],execute:function(){var r;o._RF.push({},"d2d70Nsc3pN4b4PBZ17hgSY","DelayShow",void 0);var u=e.ccclass;e.property,n("DelayShow",u("DelayShow")(r=function(n){function o(){return n.apply(this,arguments)||this}t(o,n);var e=o.prototype;return e.bind=function(n){n.on(i.MOUSE_ENTER,(function(t){t.preventSwallow=!1,console.log(n.name)}),n)},e.f=function(n){var t=this;this.bind(n),n.children.forEach((function(n){t.f(n)}))},e.start=function(){var n=this;this.node.active=!1,setTimeout((function(){n.node.active=!0}),100)},e.update=function(n){},o}(c))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/End.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnumDefine.ts","./define.ts"],(function(e){var n,a,r,t,o,u;return{setters:[function(e){n=e.createForOfIteratorHelperLoose},function(e){a=e.cclegacy},function(e){r=e.GroundTypeEnum,t=e.RangeTypeEnum,o=e.ModuleEffectTypeEnum},function(e){u=e.ModuleName}],execute:function(){e("run",(function(e,a){e(c),a((function(e){return e.module.effect}),c.name,(function(e,a,r){for(var t,u=n(r);!(t=u()).done;){var c,s=t.value,f={effectType:o.INSPIRE,ability:{}};e.managers.damageManager.applyInspire(s,f),e.managers.damageManager.applyDestroy(s),e.managers.gameLogicUtil.damageToHome(null!=(c=s.consts.damage)?c:1),e.managers.gameEntityManager.deRegisterResource(s,f)}}))})),a._RF.push({},"0dc2eawk+9ITJ0R8JFtOotB","End",void 0);var c={name:u.END,groundType:r.WIRE,funcs:{},consts:[{effect:{range:{type:t.SELF},resourceSelector:{},triggerInterval:0,funcName:u.END}}]};a._RF.pop()}}}));

System.register("chunks:///_virtual/EnumDefine.ts",["cc"],(function(E){var N;return{setters:[function(E){N=E.cclegacy}],execute:function(){N._RF.push({},"a43058pmOVBs6YdMBqWoFqm","EnumDefine",void 0);E("DirectionTypeEnum",{UP:"U",DOWN:"D",LEFT:"L",RIGHT:"R"}),E("Direction8TypeEnum",{UP:"U",DOWN:"D",LEFT:"L",RIGHT:"R",UP_LEFT:"UL",UP_RIGHT:"UR",DOWN_LEFT:"DL",DOWN_RIGHT:"DR"}),E("DR_MAP",{U:[0,1,1],D:[0,-1,1],L:[-1,0,1],R:[1,0,1],UL:[-1,1,.707],UR:[1,1,.707],DL:[-1,-1,.707],DR:[1,-1,.707]}),E("GroundTypeEnum",{NONE:"GT_NONE",WIRE:"GT_WIRE",INSULATION:"GT_INSULATION",POLE:"POLE",HOLE:"HOLE",PIN__2:"PIN__2",PIN__4:"PIN__4",PIN__8:"PIN__8",PIN__16:"PIN__16"}),E("ModuleEffectTypeEnum",{UNKNOWN:"UNKNOWN",CUSTOMER:"CUSTOMER",PROCESS:"PROCESS",BATCH_PROCESS:"BATCH_PROCESS",ANALYSIS:"ANALYSIS",DEBUG:"DEBUG",FLIP:"FLIP",UNSTABLE:"UNSTABLE",INTERFERE:"INTERFERE",MERGE:"MERGE",DECOMPOSE:"DECOMPOSE",INSPIRE:"INSPIRE",CONSUME:"CONSUME",DESTROY:"DESTROY"}),E("AssetName",{VALUE:"value",ENERGY:"energy",RESEARCH_BASE:"baseResearch"}),E("TranslateScope",{MODULE_NAME:"0",MODULE_DESC:"1",RESOURCE_NAME:"10",RESOURCE_DESC:"11",BUFF_NAME:"20",BUFF_DESC:"21",GROUND_NAME:"100",G_LEVEL_NAME:"1000",G_LEVEL_DESC:"1001"}),E("LangEnum",{CN:"cn",EN:"en"}),E("RangeTypeEnum",{NONE:"-1",SELF:"0",GRID:"1",CIRCULAR:"2"});N._RF.pop()}}}));

System.register("chunks:///_virtual/EventBus.ts",["cc","./common.ts"],(function(t){var n,e;return{setters:[function(t){n=t.cclegacy},function(t){e=t.bindAll}],execute:function(){n._RF.push({},"03166inDCZOJqLj5vAM11px","EventBus",void 0);t("EventBus",function(){function t(){this.listeners={},this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0}var n=t.prototype;return n.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.functionManager=t.managers.functionManager,this.eventBus=t.managers.eventBus,e(this)},n.pub=function(t,n){var e=this,i=this.listeners[t];i&&i.length&&i.forEach((function(i){i.listener(e.context,t,n)}))},n.sub=function(t,n,e){this.listeners[t]||(this.listeners[t]=[]),e&&(n=n.bind(e));var i=this.listeners[t].find((function(t){return t.listener==n&&(!e||t.$this==e)}));if(i){if(i.$this!=e)throw new Error("已经注册了该监听,但绑定的this不一致")}else this.listeners[t].push({listener:n,$this:e})},n.targetOff=function(t){if(t)for(var n=0,e=Object.keys(this.listeners);n<e.length;n++){var i=e[n],s=this.listeners[i];s.findIndex((function(n){return n.$this==t}))>=0&&(this.listeners[i]=s.filter((function(n){return n.$this==t})))}},n.remove=function(t,n,e){if(this.listeners[t]){var i=this.listeners[t].findIndex((function(t){return t.listener==n&&(!e||t.$this==e)})),s=this.listeners[t][i];if(s)throw s.$this==e&&(this.listeners[t]=this.listeners[t].filter((function(t){return t!=s}))),new Error("已经注册了该监听,但解除绑定的this没有传")}},n.clear=function(t){delete this.listeners[t]},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/EventDefine.ts",["cc"],(function(E){var D;return{setters:[function(E){D=E.cclegacy}],execute:function(){D._RF.push({},"574ebvJ6nhCN4KDZQwOAIJo","EventDefine",void 0);E("GameLogicEvent",{RESOURCE_DESTROYED:"RESOURCE_DESTROYED",GAME_FAIL:"GAME_FAIL",GAME_SUCCESS:"GAME_SUCCESS",ASSET_ADD:"ASSET_ADD",ASSET_USE:"ASSET_USE",BUILD_ABLE_MODULE_CHANGE:"BUILD_ABLE_MODULE_CHANGE",NEW_MODULE:"NEW_MODULE",MODULE_UPGRADED:"MODULE_UPGRADED"});D._RF.pop()}}}));

System.register("chunks:///_virtual/Flip.ts",["cc","./BuffDefine.ts","./common.ts","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n,u,t,c,o,r,i,s;return{setters:[function(e){n=e.cclegacy},function(e){u=e.ResourceBuff},function(e){t=e.assert},function(e){c=e.GroundTypeEnum,o=e.RangeTypeEnum},function(e){r=e.FRAME_RATE},function(e){i=e.ResourceName,s=e.ModuleName}],execute:function(){e("run",(function(e,n){e(f),n((function(e){return e.module.effect}),f.name,(function(e,n,c){var o=c[0],r=n.consts,s=e.managers.gameLogicUtil;if(s.addTag(o,f.name))if(o.name===i.PERSISTENT_DATA)s.doMultipleToResource(o,1/r.multiples),s.changeResourceType(o,i.VOLATILE_DATA);else if(o.name===i.VOLATILE_DATA){var a=s.doMultipleToResource(o,r.multiples);s.changeResourceType(o,i.PERSISTENT_DATA),a>0&&s.addBuffToResource(o,u.ResourceBuffName.UNSTABLE,{leftTime:r.recoverTime,complexity:a})}else t(!1,"翻转不能接受该资源类型"+o.name)}))})),n._RF.push({},"00f66LZDrdHQpCL6ATWietQ","Flip",void 0);var f={name:s.FLIP,groundType:c.PIN__8,funcs:{},consts:[{effect:{range:{type:o.GRID,range:2},resourceSelector:{resourceNameFilter:[i.PERSISTENT_DATA,i.VOLATILE_DATA],resourceTagNoFilter:s.FLIP},triggerInterval:6*r,funcName:s.FLIP},multiples:2,recoverTime:5*r,buildAble:{cost:50}}]};n._RF.pop()}}}));

System.register("chunks:///_virtual/funcs.ts",["cc"],(function(){var c;return{setters:[function(t){c=t.cclegacy}],execute:function(){c._RF.push({},"d37a4bGlO5JN4Q+QNFidpxW","funcs",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/FunctionManager.ts",["cc","./common.ts"],(function(t){var n,e,i;return{setters:[function(t){n=t.cclegacy},function(t){e=t.bindAll,i=t.DEFAULT}],execute:function(){n._RF.push({},"b054eT87TdBJ75tEpDUFERk","FunctionManager",void 0);t("FunctionManager",function(){function t(){this.context=void 0,this.settingDataManager=void 0,this.eventBus=void 0,this.lifeCycle=void 0,this.module=void 0,this.resource=void 0,this.global=void 0,this.bullet=void 0,this.lifeCycle={afterTick:{},beforeTick:{}},this.module={effect:{},onTick:{},onBuild:{},init:{},onNewWave:{}},this.resource={onTick:{},onMove:{},onDestroy:{},init:{},selector:{},buff:{init:{},onTick:{},onDestroy:{},beforeDamaged:{},onRepeat:{}}},this.bullet={lifeCycle:{onTick:{},onAbort:{},onTriggered:{}}},this.global={judge:{win:{}}}}var n=t.prototype;return n.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.eventBus=t.managers.eventBus,e(this)},n.addFunction=function(t,n,e){if(n){var i=t(this);if(!i)throw new Error("未知方法 funcName:"+n);if(i[n])throw new Error("方法已经存在funcName:"+n);i[n]=e}},n.getFunction=function(t,n){if(n){var e=t(this);if(e){var i=e[n];if(i)return i}}},n.getFunctionDefaulted=function(t,n){var e;n=null!=(e=n)?e:i;var o=t(this);if(!o)throw new Error("未知方法 funcName:"+n);var r=o[n];return r||(r=function(t,e,i,o,r,a){console.log("未知方法 funcName:"+n)}),r},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/GameContextBuilder.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnumDefine.ts","./GameData.ts","./Mod2.ts","./common.ts","./BuildingManager.ts","./DamageManager.ts","./EventBus.ts","./GameEntityManager.ts","./GameLogicUtils.ts","./MapUtil.ts","./ResearchManager.ts","./GlobalContextImpl.ts"],(function(n){var t,i,o,e,a,r,s,u,p,g,l,c,f,y,d,m;return{setters:[function(n){t=n.extends},function(n){i=n.cclegacy},function(n){o=n.DirectionTypeEnum,e=n.GroundTypeEnum},function(n){a=n.GameMap},function(n){r=n.Mods},function(n){s=n.assert,u=n.MyPointClass},function(n){p=n.BuildingManager},function(n){g=n.DamageManager},function(n){l=n.EventBus},function(n){c=n.GameEntityManager},function(n){f=n.GameLogicUtils},function(n){y=n.MapUtil},function(n){d=n.ResearchManager},function(n){m=n.GlobalContext}],execute:function(){i._RF.push({},"0e675i0inRPQ7yBCirXImk6","GameContextBuilder",void 0);n("GameContextBuilder",function(){function n(){}var i=n.prototype;return i.buildManagers=function(n){return n.managers={eventBus:new l,gameEntityManager:new c,gameLogicUtil:new f,buildingManager:new p,researchManager:new d,mapUtil:new y,damageManager:new g,translateManager:m.translateManager,settingDataManager:m.settingDataManager,functionManager:m.functionManager},n.managers},i.getDirection=function(n,t){if(n.x==t.x){if(t.y-n.y==1)return o.DOWN;if(t.y-n.y==-1)return o.UP}else if(n.y==t.y){if(t.x-n.x==1)return o.RIGHT;if(t.x-n.x==-1)return o.LEFT}throw new Error("未知坐标方向")},i.buildByLevel=function(n){var i=this,o=this.buildEmptyMap(n),a=[];n.wayPoints.forEach((function(n){var t=[];a.push(t);var i=o.getAt(n[0]);s(!!i,"配置的路径超出地图范围"+JSON.stringify(n[0]));for(var r=1;r<n.length;r++){var u=o.getAt(n[r]);if(s(!!u,"配置的路径超出地图范围"+JSON.stringify(n[0])),i.position.x!==u.position.x&&i.position.y===u.position.y)for(var p=i.position.x>u.position.x?-1:1,g=i.position.x;g<u.position.x;g+=p){var l=o.getAt({x:g,y:u.position.y});l.groundType=e.WIRE,t.push(l)}else if(i.position.x===u.position.x&&i.position.y!==u.position.y)for(var c=i.position.y>u.position.y?-1:1,f=i.position.y;f<u.position.y;f+=c){var y=o.getAt({x:u.position.x,y:f});y.groundType=e.WIRE,t.push(y)}else if(i.position.x-u.position.x!=0&&Math.abs(i.position.x-u.position.x)==Math.abs(i.position.y-u.position.y))for(var d=i.position.x>u.position.x?-1:1,m=i.position.y>u.position.y?-1:1,h=i.position.x,v=i.position.y;h<u.position.x;h+=d,v+=m){var x=o.getAt({x:h,y:v});x.groundType=e.WIRE,t.push(x)}else s(!1,"不支持该路径方式");i=u}i.groundType=e.WIRE,t.push(i)})),n.grounds.forEach((function(n){var t=o.getAt(n.pos);if(s(!!t,"配置的地面类型超出地图范围"+JSON.stringify(n.pos)),t.groundType!==e.INSULATION)throw new Error("拒绝地形覆盖 from "+t.groundType+"  to: "+n.ground);t.groundType=n.ground}));var p=a.map((function(n){return n[0]})),g=a.map((function(n){return n[n.length-1]})),l=a.map((function(n,t){var o=[],e=i.getDirection(n[0].position,n[1].position);o.push({pos:n[0].position,direction:e});for(var a=1;a<n.length;a++){var r=n[a],s=n[a-1],p=i.getDirection(s.position,r.position);p!==e&&o.push({pos:s.position,direction:p}),e=p}return u.equals(o[o.length-1].pos,n[n.length-1].position)||o.push({pos:n[n.length-1].position,direction:e}),{rid:t+1,start:n[0],end:n[n.length-1],wayPoints:n,keyPoints:o}}));l.forEach((function(n){var t=0;n.wayPoints.forEach((function(i){var o;u.equals(n.keyPoints[t].pos,i.position)&&t++,i.nextWayPoint=null==(o=n.keyPoints[t])?void 0:o.pos}))}));var c=t({},this.buildCommonData(),{setting:n,name:n.name,asset:n.asset,map:o,wavesInfo:{nextPtr:0,waves:n.waves},place:{ends:g,starts:p},roads:l,win:!1,winCondition:n.winCondition}),f=this.buildManagers(c);f.gameEntityManager,f.buildingManager;return Object.values(c.managers).forEach((function(n){return null==n?void 0:n.setContext(c)})),r.forEach((function(n){null==n.onGameContextCreated||n.onGameContextCreated(c,m,[],[])})),Object.values(c.managers).forEach((function(n){return null==n||null==n.afterGameContextFullInit?void 0:n.afterGameContextFullInit()})),c},i.buildEmptyMap=function(n){var t=new a;t.sizeX=n.width,t.sizeY=n.height,t.mapUnits=[];for(var i=0;i<t.sizeY;i++){var o=[];t.mapUnits.push(o);for(var r=0;r<t.sizeX;r++){var s={module:void 0,position:{x:r,y:i},groundType:e.INSULATION,resources:[]};o.push(s)}}return t},i.buildCommonData=function(){return{eidPtr:0,tick:0,entities:{modules:{},moduleList:[],resources:{},resourceList:[],bullets:{},bulletList:[]},moduleMapUnits:[],alive:!0,research:{unlocked:{}},cache:{},temp:{},managers:{}}},n}());i._RF.pop()}}}));

System.register("chunks:///_virtual/GameData.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"97a64W8Nq5L87uPIWLZb9H6","GameData",void 0);t("GameMap",function(){function t(){this.sizeX=void 0,this.sizeY=void 0,this.mapUnits=void 0,this.sizeX=50,this.sizeY=50,this.mapUnits=[]}var i=t.prototype;return i.filter=function(t){for(var i=[],s=0;s<this.sizeY;s++)for(var e=this.mapUnits[s],n=0;n<this.sizeX;n++)t(e[n])&&i.push(e[n]);return i},i.getAt=function(t){if(t)return this.mapUnits[t.y][t.x]?this.mapUnits[t.y][t.x]:void 0},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/GameEntity.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"9bb22mgtOFDYLoazN+A6QIc","GameEntity",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/GameEntityManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EnumDefine.ts","./BulletDefine.ts","./EventDefine.ts","./Physical.ts"],(function(t){var e,i,n,s,o,r,u,c;return{setters:[function(t){e=t.extends},function(t){i=t.cclegacy},function(t){n=t.bindAll,s=t.MyPointClass,o=t.assert},null,function(t){r=t.Bullet},function(t){u=t.GameLogicEvent},function(t){c=t.ColliderTypeEnum}],execute:function(){i._RF.push({},"d5efcOnCFFNYrqF0YdISqq5","GameEntityManager",void 0);t("GameEntityManager",function(){function t(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.gameLogicUtils=void 0}var i=t.prototype;return i.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.functionManager=t.managers.functionManager,this.eventBus=t.managers.eventBus,this.gameLogicUtils=t.managers.gameLogicUtil,n(this)},i._buildModule=function(t,e){return{eid:t,alive:!0,position:s.ZERO_RAW,name:e.name,setting:e,level:0,cache:{},vars:{effect:{coldDown:0}},consts:e.consts[0]}},i._buildResource=function(t,i,n,o){var r={eid:t,name:i.name,logicPosition:s.ZERO_RAW,position:s.ZERO_RAW,setting:i,vars:e({nextWayPoint:s.ZERO_RAW,complexity:n,orgComplexity:n,tags:{}},o),consts:i.consts[0],buffs:[],cache:{},alive:!0};return r.setting.collideInfo?r.collideInfo=r.setting.collideInfo:r.collideInfo={type:c.Circular,r:.1875},r},i.createModule=function(t){var e=this.settingDataManager.getModule(t);if(!e)throw new Error("配置不存在"+t);var i=this._buildModule(++this.context.eidPtr,e),n=null==e?void 0:e.funcs.init,s=this.functionManager.getFunction((function(t){return t.module.init}),n);return null==s||s(this.context,i),i},i.registerModule=function(t,e){var i=this.context;e.module=t,t.position=e.position,i.entities.modules[t.eid]=t,i.entities.moduleList.push(t);var n={module:t};return i.managers.eventBus.pub(u.NEW_MODULE,n),t},i.createResource=function(t,e,i){var n=this.context,s=this.settingDataManager.getResource(t);if(!s)throw new Error("配置不存在"+t);var o=this._buildResource(++n.eidPtr,s,e,i),r=null==s?void 0:s.funcs.init,u=this.functionManager.getFunction((function(t){return t.resource.init}),r);return null==u||u(n,o),o},i.registerResource=function(t,i){return i.resources.push(t),t.logicPosition=e({},i.position),t.vars.nextWayPoint=i.nextWayPoint,this.context.entities.resources[t.eid]=t,this.context.entities.resourceList.push(t),t},i.deRegisterResource=function(t,e){if(this.context.entities.resources[t.eid]){t.alive=!1,delete this.context.entities.resources[t.eid];var i=this.context.map.getAt(t.logicPosition);if(i){i.resources=i.resources.filter((function(e){return e!=t}));var n={attacker:e,resource:t};this.gameLogicUtils.checkResourceBuffDestroy(t);var s=this.functionManager.getFunction((function(t){return t.resource.onDestroy}),t.setting.funcs.onDestroy);return s&&s(this.context,n),this.eventBus.pub(u.RESOURCE_DESTROYED,n),t}}},i.deRegisterModule=function(t){if(this.context.entities.modules[t.eid]){var e=this.context.map.getAt(t.position);e&&delete e.module,t.alive=!1,delete this.context.entities.modules[t.eid]}},i.createAndRegisterBullet=function(t){return t.eid=++this.context.eidPtr,t.alive=!0,this.context.entities.bullets[t.eid]=t,this.context.entities.bulletList.push(t),t.lockTarget&&(o(t.targetType===r.BulletTargetEnum.Resource),t.target.vars.lockedByBullet=t),t},i.deRegisterBullet=function(t){t.alive=!1,delete this.context.entities.bullets[t.eid]},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/GameLogic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./BulletDefine.ts","./EventDefine.ts","./BuffDefine.ts"],(function(e){var t,n,i,o,r,a,u,c;return{setters:[function(e){t=e.createForOfIteratorHelperLoose,n=e.extends},function(e){i=e.cclegacy},function(e){o=e.GameOverError,r=e.DEFAULT},function(e){a=e.Bullet},function(e){u=e.GameLogicEvent},function(e){c=e.ResourceBuff}],execute:function(){i._RF.push({},"282660ewJNO3oyeER5uZRTk","GameLogic",void 0);e("GameLogic",function(){function e(e){this.pause=!1,this.gameSpeed=1,this.gameContext=void 0,this.gameContext=e}var i=e.prototype;return i.init=function(){},i.getFunction=function(e,t){if(t)return this.gameContext.managers.functionManager.getFunction(e,t)},i.nextTick=function(){if(!this.pause)try{if(this.gameContext.alive&&(this.mainLogic(),!this.gameContext.alive))throw new o(this.gameContext.win)}catch(e){if(e instanceof o)this.gameContext.alive=!1,e.success?this.gameContext.managers.eventBus.pub(u.GAME_SUCCESS,void 0):this.gameContext.managers.eventBus.pub(u.GAME_FAIL,void 0);else console.log(e)}},i.mainLogic=function(){var e=this.gameContext;e.alive&&(e.temp={},this.beforeTickLogic(e),this.nextWaveLogic(e),this.moveNextLogic(e),this.onTickLogic(),this.moduleEffectLogic(e),this.entityAliveJudgeLogic(e),this.winOrLoseJudge(e)||(this.afterTickLogic(e),e.tick++,this.debuggerChecker(e)))},i.moduleEffectLogic=function(e){e.entities.moduleList.forEach((function(t){if(t.alive&&t.consts.effect&&t.vars.effect){var n=t.vars.effect,i=t.consts.effect;if(n.coldDown<=0){var o=e.entities.resourceList.filter((function(e){return e.alive&&!e.vars.lockedByBullet})).filter((function(n){return e.managers.gameLogicUtil.isInRange(n,t)})).filter((function(n){return e.managers.gameLogicUtil.isMatchEffect(n,t)}));if(o.length){var r=e.managers.functionManager.getFunction((function(e){return e.module.effect}),i.funcName),a=r&&r(e,t,o);null!=a&&a.noColdDown||(n.coldDown=i.triggerInterval)}}n.coldDown=Math.max(0,n.coldDown-1)}}))},i.onTickLogic=function(){var e=this,t=this.gameContext;t.entities.moduleList.forEach((function(t){var n,i;t.alive&&(null==(n=e.getFunction((function(e){return e.module.onTick}),null==(i=t.setting)||null==(i=i.funcs)?void 0:i.onTick))||n(e.gameContext,t))})),t.entities.resourceList.forEach((function(n){var i,o;n.alive&&(null==(i=e.getFunction((function(e){return e.resource.onTick}),null==(o=n.setting)||null==(o=o.funcs)?void 0:o.onTick))||i(t,n),n.buffs.forEach((function(i){var o;null==(o=e.getFunction((function(e){return e.resource.buff.onTick}),i.setting.func.onTick))||o(t,n,i),void 0!==i.vars.leftTime&&i.vars.leftTime--})),t.managers.gameLogicUtil.checkResourceBuffDestroy(n))})),t.entities.bulletList.forEach((function(n){if(n.alive){var i=e.getFunction((function(e){return e.bullet.lifeCycle.onTick}),n.onTick);i&&i(t,n)}}))},i.beforeTickLogic=function(e){Object.values(e.managers.functionManager.lifeCycle.beforeTick).forEach((function(t){return null==t?void 0:t(e)}))},i.afterTickLogic=function(e){Object.values(e.managers.functionManager.lifeCycle.afterTick).forEach((function(t){return null==t?void 0:t(e)}))},i.moveNextLogic=function(e){var i=e.managers.mapUtil,o=(e.managers.damageManager,e.managers.gameEntityManager),r=e.managers.functionManager,u=e.managers.gameLogicUtil;e.roads.forEach((function(e){for(var t=function(){var t=e.wayPoints[o];t.resources.forEach((function(e){if(e.alive&&!e.vars.lockedByBullet&&!e.buffs.find((function(e){return e.name===c.ResourceBuffName.STOP}))){var o=e.vars.nextWayPoint,r=e.position;if(o){var a=e.consts.moveSpeed;e.buffs.find((function(e){return e.name===c.ResourceBuffName.SLOW_DOWN}))&&(a*=c.SLOW_DOWN_RATE);var u=i.approach(r,o,a);u.arrive?(delete u.arrive,e.position=u,e.vars.nextWayPoint=t.nextWayPoint,e.logicPosition=n({},t.position)):(e.position=u,e.logicPosition={x:Math.floor(u.x+.5),y:Math.floor(u.y+.5)})}}})),t.resources=[]},o=0;o<e.wayPoints.length;o++)t()}));for(var s,l=t(e.entities.resourceList);!(s=l()).done;){var f,g=s.value;if(g.alive){var v=g.logicPosition;null==(f=e.map.getAt(v))||f.resources.push(g)}}for(var m,h=t(e.entities.bulletList);!(m=h()).done;){var d=m.value;if(d.alive){switch(d.targetType){case a.BulletTargetEnum.Destination:var p=d.target,L=i.approach(d.position,p,d.moveSpeed);if(L.arrive){var T=r.getFunction((function(e){return e.bullet.lifeCycle.onTriggered}),d.onTriggered);T&&T(e,d,d.targetType,p),o.deRegisterBullet(d);continue}d.position=L;break;case a.BulletTargetEnum.Direction:if(!i.inMapRealPoint(d.position.x,d.position.y)){var y=r.getFunction((function(e){return e.bullet.lifeCycle.onAbort}),d.onAbort);y&&y(e,d),o.deRegisterBullet(d);continue}var x=d.target;i.approachDirection(d.position,x,d.moveSpeed);break;case a.BulletTargetEnum.Resource:var E=d.target;if(!E||!E.alive||E.vars.lockedByBullet===d){var b=r.getFunction((function(e){return e.bullet.lifeCycle.onAbort}),d.onAbort);b&&b(e,d),o.deRegisterBullet(d);continue}var k=i.approach(d.position,E.position,d.moveSpeed);if(k.arrive){var w=r.getFunction((function(e){return e.bullet.lifeCycle.onTriggered}),d.onTriggered);w&&w(e,d,d.targetType,E),o.deRegisterBullet(d);continue}d.position=k;break;default:var B=d.targetType;throw new Error(B)}if(d.targetType===a.BulletTargetEnum.Destination||d.targetType===a.BulletTargetEnum.Direction||(d.targetType,a.BulletTargetEnum.Resource),d.collider){var C=u.overlapResource(d.collider,1)[0];if(C){var R=r.getFunction((function(e){return e.bullet.lifeCycle.onTriggered}),d.onTriggered);R&&R(e,d,a.BulletTargetEnum.Resource,C)}}}}},i.nextWaveLogic=function(e,n){void 0===n&&(n=!1);var i=e.wavesInfo,o=i.nextPtr<i.waves.length?i.waves[i.nextPtr]:null;if(o&&(n||o.tick<=e.tick)){if(o.info.length!=e.place.starts.length)throw new Error("波次数据和出生点数量不一致");i.nextPtr++;var r=Math.min(e.tick,o.tick);e.place.starts.forEach((function(n,i){for(var a,u=n.module.vars,c=o.info[i],s=t(c);!(a=s()).done;)for(var l=a.value,f=0;f<l.count;f++){var g=r+l.interval*f+l.delay,v=e.managers.gameEntityManager.createResource(l.name,l.complexity,l.ext);u.wave[g]?u.wave[g].push(v):u.wave[g]=[v]}})),e.entities.moduleList.filter((function(e){return e.alive&&e.setting.funcs.onNewWave})).forEach((function(t){e.managers.functionManager.getFunction((function(e){return e.module.onNewWave}),t.setting.funcs.onNewWave)(e,t)}))}else n||o||!this.hasNoResources(e)||(e.temp.hasNoResource=!0)},i.hasNoResources=function(e){return!e.entities.resourceList.length&&e.place.starts.every((function(e){var t=e.module.vars;return t.queueIdx>=t.queue.length&&Object.values(t.wave).findIndex((function(e){return e.length}))<0}))},i.entityAliveJudgeLogic=function(e){e.entities.moduleList=e.entities.moduleList.filter((function(e){return e.alive})),e.entities.resourceList=e.entities.resourceList.filter((function(e){return e.alive})),e.entities.bulletList=e.entities.bulletList.filter((function(e){return e.alive}))},i.winOrLoseJudge=function(e){var t;return e.managers.functionManager.getFunction((function(e){return e.global.judge.win}),null!=(t=e.winCondition.func)?t:r)(e)},i.debuggerChecker=function(e){e.asset.hp.cur<=0&&e.alive&&console.warn("context 存活状态异常 ",e.asset.hp.cur,e.alive)},e}());i._RF.pop()}}}));

System.register("chunks:///_virtual/GameLogicUtils.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EnumDefine.ts","./BuffDefine.ts","./EventDefine.ts","./Physical.ts"],(function(t){var e,n,i,o,r,a,s,u;return{setters:[function(t){e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy},function(t){i=t.bindAll,o=t.assert},function(t){r=t.RangeTypeEnum},function(t){a=t.ResourceBuff},function(t){s=t.GameLogicEvent},function(t){u=t.overlap}],execute:function(){n._RF.push({},"7b66afG9BVCMbGK8oqUpg63","GameLogicUtils",void 0);t("GameLogicUtils",function(){function t(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.gameEntityManager=void 0,this.doDamageToResourceOptions={modifyAble:!0,dieAble:!1},this.direction4=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}]}var n=t.prototype;return n.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.functionManager=t.managers.functionManager,this.eventBus=t.managers.eventBus,this.gameEntityManager=t.managers.gameEntityManager,i(this)},n.addBuffToResource=function(t,e,n){var i=this.settingDataManager.getResourceBuff(e);if(i){var o={name:i.name,setting:i,vars:null!=n?n:{},resource:t},r=t.buffs.findIndex((function(t){return t.name===i.name}));if(r>=0){var s,u=null!=(s=i.func.onRepeated)?s:a.RepeatedBuffResolutionEnum.APPEND,c=this.functionManager.getFunction((function(t){return t.resource.buff.onRepeat}),u);c&&c(this.context,t.buffs[r],o,t,r)}else t.buffs.push(o)}},n.damageToHome=function(t){if(o(t>=0),0!=t){var e=this.context.asset.hp;e.cur-=t,e.cur<=0&&(this.context.alive=!1)}},n.checkResourceBuffDestroy=function(t){var e=this;t.buffs=t.buffs.filter((function(n){var i,o=void 0;return t.alive||(o=a.BuffDestroyReasonEnum.RESOURCE_DESTROY),void 0!==n.vars.leftTime&&n.vars.leftTime<=0&&(o=a.BuffDestroyReasonEnum.TIME),void 0!==n.vars.leftTimes&&n.vars.leftTimes<=0&&(o=a.BuffDestroyReasonEnum.TIMES),!o||(null==(i=e.functionManager.getFunction((function(t){return t.resource.buff.onDestroy}),n.setting.func.onDestroy))||i(e.context,n.resource,n,o),!1)}))},n.doMultipleToResource=function(t,e){if(o(e>0),0==t.alive)return 0;var n=t.vars.complexity,i=t.vars.complexity*e;return i=Math.max(Math.floor(i),1),t.vars.complexity=i,i-n},n.changeResourceType=function(t,e){var n=this.settingDataManager.getResource(e);if(!n)throw new Error("changeResourceType no setting name:"+e);t.name=n.name,t.setting=n},n.addAsset=function(t,e){if(o(e>0),0!=e){var n=this.context.asset[t],i=n.cur;n.cur=Math.min(i+e,n.max);var r={original:i,current:n.cur,wantAmount:e};this.eventBus.pub(s.ASSET_USE,r)}},n.canUseAsset=function(t,e){return o(e>0),0==e||!(this.context.asset[t].cur<e)},n.useAsset=function(t,e){if(o(e>0),0==e)return!0;var n=this.context.asset[t],i=n.cur;if(i<e)return!1;n.cur-=e;var r={original:i,current:n.cur,wantAmount:e,forceUse:!1};return this.eventBus.pub(s.ASSET_USE,r),!0},n.countModuleByName=function(t){return this.context.entities.moduleList.filter((function(e){return e.alive&&e.name===t})).length},n.getAround4=function(t){var e=this.context.map,n=[];return this.direction4.forEach((function(i){var o=e.mapUnits[t.y+i.y];o?n.push(o[t.x+i.x]):n.push(void 0)})),n},n.healToHome=function(t){if(o(t>=0),t){var e=this.context.asset.hp;e.cur+=Math.max(Math.min(t,e.max-e.cur),0)}},n.isMatchEffect=function(t,e){var n,i,o=this.context.managers.functionManager.getFunction((function(t){return t.resource.selector}),null!=(n=null==(i=e.consts.effect)||null==(i=i.resourceSelector)?void 0:i.funcName)?n:"default");return!!o&&o(this.context,t,e)},n.isInRange=function(t,e){var n,i,o=null==(n=e.consts.effect)?void 0:n.range;return!!o&&(o.type===r.SELF?t.logicPosition.x===e.position.x&&t.logicPosition.y===e.position.y:o.type===r.GRID?Math.abs(t.logicPosition.x-e.position.x)+Math.abs(t.logicPosition.y-e.position.y)<=o.range:o.type===r.CIRCULAR&&Math.pow(t.position.x-e.position.x,2)+Math.pow(t.position.y-e.position.y,2)<=Math.pow(null!=(i=o.range)?i:1,2))},n.addTag=function(t,e,n){if(this.hasTag(t,e))return!1;var i=void 0===n?Number.MAX_SAFE_INTEGER:this.context.tick+n,o=t.vars.tags[e];return(!o||o.tick<=i)&&(t.vars.tags[e]={tick:i}),!0},n.hasTag=function(t,e){var n=t.vars.tags[e];return!!n&&(n.tick>=this.context.tick||(delete t.vars.tags[e],!1))},n.overlap=function(t,e){return u(t,e)},n.overlapResource=function(t,n,i){var o;if(0===n)return[];var r=[];n=null!=(o=n)?o:9999;for(var a,s=e(this.context.entities.resourceList);!(a=s()).done;){var c=a.value;if(c.alive&&c.collideInfo&&((!i||!i.includes(c))&&u(t,c)&&(r.push(c),r.length>=n)))break}return r},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/Global.ts",["cc"],(function(){var t;return{setters:[function(c){t=c.cclegacy}],execute:function(){t._RF.push({},"94178Nhx+hEb6UYHwHAQo+1","Global",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/GlobalContextImpl.ts",["cc","./common.ts","./FunctionManager.ts","./SettingDataManager.ts","./TranslateManager.ts"],(function(t){var e,n,r,i,a,u;return{setters:[function(t){e=t.cclegacy,n=t.Color},function(t){r=t.DEFAULT},function(t){i=t.FunctionManager},function(t){a=t.SettingDataManager},function(t){u=t.TranslateManager}],execute:function(){e._RF.push({},"e2256zqChxOG7/BBwE9t4A4","GlobalContextImpl",void 0);var s=function(){function t(){this.levels={}}var e=t.prototype;return e.addLevel=function(t){this.levels[t.name]=t},e.getLevels=function(){return Object.values(this.levels)},e.getLevel=function(t){return this.levels[t]},t}(),o=function(){function t(){this.DEFAULT_SPRITE_RESOURCE="",this.DEFAULT_SPRITE_MODULE="",this.DEFAULT_SPRITE_RESEARCH="",this.data={resource:{},module:{},research:{},ground:{},bullet:{},resourceBuff:{}}}var e=t.prototype;return e.setResourceSpriteAndColor=function(t,e,n,r){this.data.resource[t]=[e,n,r]},e.getResourceSpriteAndColor=function(t){var e;return null!=(e=this.data.resource[t])?e:this.DEFAULT_SPRITE_RESOURCE},e.listResourceSpritePaths=function(){return Object.values(this.data.resource).map((function(t){return t[0]}))},e.setModuleSprite=function(t,e,n){var r=this.data.module[t];r||(r=this.data.module[t]={}),r[e]=n},e.getModuleSprite=function(t,e){var n=this.data.module[null!=t?t:r];return n?n[e]:this.DEFAULT_SPRITE_MODULE},e.setResearchSprite=function(t,e){this.data.research[t]=e},e.getResearchSprite=function(t){var e;return null!=(e=this.data.research[t])?e:this.DEFAULT_SPRITE_RESEARCH},e.setGroundSprite=function(t,e){this.data.ground[t]=e},e.getGroundSprite=function(t){return this.data.ground[null!=t?t:r]},e.listGroundSpritePaths=function(){return Object.values(this.data.ground)},e.setBulletSprite=function(t,e){this.data.bullet[t]=e},e.getBulletSprite=function(t){var e;return null!=(e=this.data.bullet[null!=t?t:r])?e:this.data.bullet[r]},e.listBulletSpritePaths=function(){return Object.values(this.data.bullet)},e.setResourceBuffSprite=function(t,e){this.data.resourceBuff[t]=e},e.getResourceBuffSprite=function(t){var e;return null!=(e=this.data.resourceBuff[null!=t?t:r])?e:this.data.resourceBuff[r]},e.listResourceBuffSpritePaths=function(){return Object.values(this.data.resourceBuff)},t}();t("GlobalContext",new(function(){function t(){this.FRAME_RATE=20,this.logic=void 0,this.context=void 0,this.levelManager=new s,this.translateManager=new u,this.functionManager=new i,this.settingDataManager=new a,this.renderDataManager=new o,this.globalFunctionManager=new i,this.colorUtils=n,this.gameUpdateTimer=void 0}var e=t.prototype;return e.setGameContext=function(t){t?(this.logic=t,this.context=t.gameContext,this.gameUpdateTimer&&clearTimeout(this.gameUpdateTimer)):(this.logic=void 0,this.context=void 0)},e.run=function(){var t=this;this.logic&&(this.logic.nextTick(),this.gameUpdateTimer=setTimeout((function(){t.run()}),1e3))},t}()));e._RF.pop()}}}));

System.register("chunks:///_virtual/GlobalInputEventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ViewGlobal.ts"],(function(n){var t,e,o,i,s,u,a,p;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator,i=n.Input,s=n.input,u=n.NodeEventType,a=n.Component},function(n){p=n.UIGlobalContext}],execute:function(){var r;e._RF.push({},"bcceeeXtw9MwKkTM7PMBxKX","GlobalInputEventManager",void 0);var E=o.ccclass;o.property,n("GlobalInputEventManager",E("GlobalInputEventManager")(r=function(n){function e(){return n.apply(this,arguments)||this}t(e,n);var o=e.prototype;return o.mouseDown=function(n){p.globalUIEvent.pub(i.EventType.MOUSE_DOWN,n)},o.mouseUp=function(n){p.globalUIEvent.pub(i.EventType.MOUSE_UP,n)},o.mouseMove=function(n){p.globalUIEvent.pub(i.EventType.MOUSE_MOVE,n)},o.manageEvent=function(n){var t=n?s.on.bind(s):s.off.bind(s),e=n?this.node.on.bind(this.node):this.node.off.bind(this.node);t(i.EventType.MOUSE_DOWN,this.mouseDown,this),t(i.EventType.MOUSE_UP,this.mouseUp,this),t(i.EventType.MOUSE_MOVE,this.mouseMove,this),e(u.MOUSE_DOWN,this.mouseDown,this),e(u.MOUSE_UP,this.mouseUp,this),e(u.MOUSE_MOVE,this.mouseMove,this)},o.start=function(){this.manageEvent(!0)},o.onDestroy=function(){this.manageEvent(!1)},e}(a))||r);e._RF.pop()}}}));

System.register("chunks:///_virtual/GridRangeIndicator.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n,r,a,o,s,c,l,p,h,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){a=t.cclegacy,o=t._decorator,s=t.Node,c=t.Prefab,l=t.CCFloat,p=t.instantiate,h=t.Vec3,d=t.Component}],execute:function(){var u,f,b,v,g,y,w,z,R;a._RF.push({},"40197UOhtBPCag5U/bnTNoA","GridRangeIndicator",void 0);var m=o.ccclass,I=o.property;o.float,t("GridRangeIndicator",(u=m("GridRangeIndicator"),f=I({type:s}),b=I({type:c}),v=I({type:l}),u((w=e((y=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a))||this,n(e,"container",w,r(e)),n(e,"prefab",z,r(e)),n(e,"width",R,r(e)),e.nodes=[],e}return i(e,t),e.prototype.setData=function(t,e){if(t){for(var i=0,n=-e;n<=e;n++)for(var r=-e;r<=e;r++)if(!(Math.abs(r)+Math.abs(n)>e)){if(i>=this.nodes.length){var a=p(this.prefab);a.parent=this.container,this.nodes.push(a)}var o=this.nodes[i];o.position=new h(r*this.width,n*this.width,this.node.position.z),o.active=!0,i++}for(var s=i;s<this.nodes.length;s++)this.nodes[s].active=!1;this.node.active=!0}else this.node.active=!1},e}(d)).prototype,"container",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=e(y.prototype,"prefab",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=e(y.prototype,"width",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 160}}),g=y))||g));a._RF.pop()}}}));

System.register("chunks:///_virtual/HarmlessProcessor.ts",["cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(e){var n;return{setters:[function(e){n=e.cclegacy},null,null,null],execute:function(){e("run",(function(e,n){return})),n._RF.push({},"bcd5e3cdwtPEpG9lBRPiqvs","HarmlessProcessor",void 0),n._RF.pop()}}}));

System.register("chunks:///_virtual/IndependentProcessor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EnumDefine.ts","./BulletDefine.ts","./main3.ts","./define.ts"],(function(e){var n,t,i,o,r,u,c,s,l,a;return{setters:[function(e){n=e.extends},function(e){t=e.cclegacy},function(e){i=e.DEFAULT},function(e){o=e.ModuleEffectTypeEnum,r=e.GroundTypeEnum,u=e.RangeTypeEnum},function(e){c=e.Bullet},function(e){s=e.FRAME_RATE},function(e){l=e.ModuleName,a=e.TResourceType}],execute:function(){e("run",(function(e,t){e(f),t((function(e){return e.module.effect}),f.name,(function(e,t,r){var u=t.consts,l=e.managers.gameLogicUtil.getAround4(t.position).filter((function(e){return null==e?void 0:e.module})).length,a=u.ability+(l?0:u.increaseAbility);e.managers.gameEntityManager.createAndRegisterBullet({effectType:o.PROCESS,ability:{processAbility:a},targetType:c.BulletTargetEnum.Resource,onTriggered:i,moveSpeed:2/s,position:n({},t.position),target:r[0]})}))})),t._RF.push({},"ef1c8qdZW1LSqWz0IGH8y+M","IndependentProcessor",void 0);var f={name:l.INDEPENDENT_PROCESSOR,groundType:r.PIN__8,funcs:{},consts:[{effect:{range:{type:u.CIRCULAR,range:2},resourceSelector:{resourceTypeFilter:[a.COMMON]},triggerInterval:30,funcName:l.INDEPENDENT_PROCESSOR},ability:1,increaseAbility:2,buildAble:{cost:40}}]};t._RF.pop()}}}));

System.register("chunks:///_virtual/InfoVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./EnumDefine.ts","./common.ts","./UIUtilities.ts","./ViewGlobal.ts"],(function(e){var t,i,n,a,r,o,l,u,s,c,d,p,m,f,g,b;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){r=e.cclegacy,o=e._decorator,l=e.Node,u=e.RichText,s=e.Label,c=e.Component},function(e){d=e.GlobalContext},function(e){p=e.TranslateScope},function(e){m=e.Timer},function(e){f=e.translateSettingString},function(e){g=e.InputMode,b=e.UIGlobalContext}],execute:function(){var y,D,h,v,I,x,T,N,M,F,w,E,U,O,z,B,_,C,L,A,S;r._RF.push({},"e5585OMnTFNwJ4Fq1DKaZyw","InfoVMgr",void 0);var R=o.ccclass,G=o.property;e("InfoVMgr",(y=R("InfoVMgr"),D=G({type:l,displayName:"地面信息面板"}),h=G({type:u,displayName:"地面信息文本"}),v=G({type:l,displayName:"模块信息面板"}),I=G({type:u,displayName:"模块名称文本"}),x=G({type:u,displayName:"模块描述文本"}),T=G({type:l,displayName:"资源信息面板"}),N=G({type:u,displayName:"资源名称文本"}),M=G({type:u,displayName:"资源描述文本"}),F=G({type:l,displayName:"建筑信息面板"}),y((U=t((E=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,n(t,"groundInfoForm",U,a(t)),n(t,"groundInfoText",O,a(t)),n(t,"moduleInfoForm",z,a(t)),n(t,"moduleNameText",B,a(t)),n(t,"moduleDescText",_,a(t)),n(t,"resourceInfoForm",C,a(t)),n(t,"resourceNameText",L,a(t)),n(t,"resourceDescText",A,a(t)),n(t,"buildingInfoForm",S,a(t)),t.buildingDescText=void 0,t.fixUpdateTimer=new m,t}i(t,e);var r=t.prototype;return r.loadRef=function(){var e;!this.buildingDescText&&(this.buildingDescText=null==(e=this.buildingInfoForm.getChildByName("TextDesc"))?void 0:e.getComponent(s))},r.start=function(){this.loadRef()},r.update=function(e){var t;if(this.fixUpdateTimer.wait(.1)){this.fixUpdateTimer.reset();var i=b.myInputSystem,n=d.context;if(n){var a=null!=(t=i.clickedPosition.data)?t:i.position.data,r=n.map.getAt(a),o=n.managers.translateManager.$;if(this.groundInfoForm.active=!!r&&i.inputMode.data==g.NONE){var l="地面类型: "+o(p.GROUND_NAME,r.groundType);this.groundInfoText.string=l}if((this.moduleInfoForm.active=!(null==r||!r.module)&&i.inputMode.data==g.NONE)&&(this.moduleNameText.string="模块: "+o(p.MODULE_NAME,r.module.name),this.moduleDescText.string="描述: ?"),i.inputMode.data===g.NONE){if(this.buildingInfoForm.active=!!i.mouseOverBuildAble.data){var u=n.managers.settingDataManager.getModule(i.mouseOverBuildAble.data);this.buildingDescText.string=this.getBuildingDesc(u)}}else if(i.inputMode.data===g.BUILD_MODULE){if(this.buildingInfoForm.active=!!i.clickedBuildAble.data){var s=n.managers.settingDataManager.getModule(i.clickedBuildAble.data);this.buildingDescText.string=this.getBuildingDesc(s)}}else this.buildingInfoForm.active=!1}}},r.getBuildingDesc=function(e){var t,i,n=[];if(null!=e&&null!=(t=e.consts[0].effect)&&t.triggerInterval){var a=f(p.MODULE_DESC,"攻击间隔:[c.eitv]",e);n.push(a)}if(null!=e&&null!=(i=e.consts[0].effect)&&i.range){var r=f(p.MODULE_DESC,"范围:[c.effect.range.range]",e);n.push(r)}var o=f(p.MODULE_DESC,null==e?void 0:e.desc,e);return n.push(o),n.join("\n")},t}(c)).prototype,"groundInfoForm",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=t(E.prototype,"groundInfoText",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=t(E.prototype,"moduleInfoForm",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=t(E.prototype,"moduleNameText",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=t(E.prototype,"moduleDescText",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=t(E.prototype,"resourceInfoForm",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=t(E.prototype,"resourceNameText",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=t(E.prototype,"resourceDescText",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=t(E.prototype,"buildingInfoForm",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=E))||w));r._RF.pop()}}}));

System.register("chunks:///_virtual/Jammer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BuffDefine.ts","./EnumDefine.ts","./BulletDefine.ts","./main3.ts","./define.ts"],(function(e){var n,t,r,u,o,i,a,c,f,l;return{setters:[function(e){n=e.extends},function(e){t=e.cclegacy},function(e){r=e.ResourceBuff},function(e){u=e.ModuleEffectTypeEnum,o=e.GroundTypeEnum,i=e.RangeTypeEnum},function(e){a=e.Bullet},function(e){c=e.FRAME_RATE},function(e){f=e.ModuleName,l=e.TResourceType}],execute:function(){e("run",(function(e,t){e(s),t((function(e){return e.bullet.lifeCycle.onTriggered}),s.name,(function(e,n,t,u){if(t!==a.BulletTargetEnum.Resource)throw new Error(" target type wrong");e.managers.damageManager.apply(u,n),u.alive&&e.managers.gameLogicUtil.addBuffToResource(u,r.ResourceBuffName.SLOW_DOWN,{leftTime:3*c})})),t((function(e){return e.module.effect}),s.name,(function(e,t,r){var o=t.consts;e.managers.gameEntityManager.createAndRegisterBullet({effectType:u.PROCESS,ability:{processAbility:o.ability},targetType:a.BulletTargetEnum.Resource,moveSpeed:1/c,position:n({},t.position),target:r[0],onTriggered:s.name})}))})),t._RF.push({},"2b1b7V/ZLVMjI+BloNj2Bsp","Jammer",void 0);var s={name:f.JAMMER,groundType:o.PIN__8,funcs:{},consts:[{effect:{range:{type:i.CIRCULAR,range:2},resourceSelector:{resourceTypeFilter:[l.COMMON]},triggerInterval:30,funcName:f.JAMMER},buildAble:{cost:100},ability:2}]};t._RF.pop()}}}));

System.register("chunks:///_virtual/Laboratory.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EnumDefine.ts","./BulletDefine.ts","./main3.ts","./define.ts"],(function(e){var t,n,r,a,o,u,c,i,s,l,m;return{setters:[function(e){t=e.extends},function(e){n=e.cclegacy},function(e){r=e.assert},function(e){a=e.AssetName,o=e.ModuleEffectTypeEnum,u=e.GroundTypeEnum,c=e.RangeTypeEnum},function(e){i=e.Bullet},function(e){s=e.FRAME_RATE},function(e){l=e.ModuleName,m=e.ResourceName}],execute:function(){e("run",(function(e,n){e(f),n((function(e){return e.bullet.lifeCycle.onTriggered}),f.name,(function(e,t,n,o){r(n===i.BulletTargetEnum.Resource&&!!t.attackerModule);var u=o,c=t.attackerModule.consts,s=Math.floor(Math.log2(u.vars.complexity/c.baseLine)),l=Math.max(Math.min(s,c.max),0);e.managers.gameLogicUtil.addAsset(a.RESEARCH_BASE,l)})),n((function(e){return e.module.effect}),f.name,(function(e,n,r){e.managers.gameEntityManager.createAndRegisterBullet({effectType:o.CONSUME,targetType:i.BulletTargetEnum.Resource,attackerModule:n,ability:{},onTriggered:f.name,lockTarget:!0,moveSpeed:4/s,position:t({},n.position),target:r[0]})}))})),n._RF.push({},"4f82162DxtOIprbpK7PQVir","Laboratory",void 0);var f={name:l.LABORATORY,groundType:u.PIN__8,funcs:{},consts:[{effect:{range:{type:c.CIRCULAR,range:2},resourceSelector:{resourceNameFilter:[m.PERSISTENT_DATA],minComplexity:10},triggerInterval:5*s,funcName:l.LABORATORY},buildAble:{cost:48},baseLine:10,max:5}]};n._RF.pop()}}}));

System.register("chunks:///_virtual/lan.ts",["cc","./BuffDefine.ts","./EnumDefine.ts","./define.ts"],(function(E){var O,N,M,A,_,R,D;return{setters:[function(E){O=E.cclegacy},function(E){N=E.ResourceBuff},function(E){M=E.LangEnum,A=E.TranslateScope,_=E.GroundTypeEnum},function(E){R=E.ModuleName,D=E.ResourceName}],execute:function(){E("init",(function(E){var O=E.$;if(E.lang!==M.CN)return;O(A.MODULE_NAME,R.END,"基地"),O(A.MODULE_NAME,R.START,"入口"),O(A.MODULE_NAME,R.PROCESSOR,"初级处理"),O(A.MODULE_NAME,R.FLIP,"初级翻转"),O(A.MODULE_NAME,R.ANALYZER,"初级分析"),O(A.MODULE_NAME,R.INDEPENDENT_PROCESSOR,"初级独立处理"),O(A.MODULE_NAME,R.COLLABORATIVE_PROCESSOR,"初级协同处理"),O(A.MODULE_NAME,R.HARMLESS_PROCESSOR,"初级无害化处理"),O(A.MODULE_NAME,R.RECYCLE,"初级回收"),O(A.MODULE_NAME,R.POLE_TRANSMISSION,"电极传输"),O(A.MODULE_NAME,R.LABORATORY,"实验室"),O(A.MODULE_NAME,R.JAMMER,"干扰器"),O(A.MODULE_NAME,R.BLOCKER,"阻塞器"),O(A.MODULE_NAME,R.PROCESSOR_N,"多重处理"),O(A.RESOURCE_NAME,D.META_DATA,"元数据"),O(A.RESOURCE_NAME,D.PERSISTENT_DATA,"持久数据"),O(A.RESOURCE_NAME,D.VOLATILE_DATA,"易失数据"),O(A.GROUND_NAME,_.INSULATION,"板面"),O(A.GROUND_NAME,_.WIRE,"导线"),O(A.GROUND_NAME,_.NONE,"无"),O(A.GROUND_NAME,_.POLE,"电极"),O(A.GROUND_NAME,_.HOLE,"过孔"),O(A.GROUND_NAME,_.PIN__2,"小型基座"),O(A.GROUND_NAME,_.PIN__8,"中型基座"),O(A.GROUND_NAME,_.PIN__16,"标准基座"),O(A.BUFF_NAME,N.ResourceBuffName.UNSTABLE,"失稳"),O(A.BUFF_NAME,N.ResourceBuffName.ANALYZED,"被分析"),O(A.BUFF_NAME,N.ResourceBuffName.SLOW_DOWN,"减速"),O(A.BUFF_NAME,N.ResourceBuffName.STOP,"眩晕"),O(A.MODULE_DESC,R.END,"家"),O(A.MODULE_DESC,R.PROCESSOR,"处理:[c.ability]"),O(A.MODULE_DESC,R.INDEPENDENT_PROCESSOR,"处理:[c.ability]\n如果四周没有其他模块,则 + [c.increaseAbility]"),O(A.MODULE_DESC,R.COLLABORATIVE_PROCESSOR,"处理:[c.ability]\n四周每有一个模块, + [c.increaseAbility]"),O(A.MODULE_DESC,R.FLIP,"翻转数据\n持久数据 复杂度变为1/[c.multiples]\n易失数据 复杂度变为[c.multiples]"),O(A.MODULE_DESC,R.ANALYZER,"给数据施加[c.ability]层被分析\n被分析:被处理时,复杂度额外降低n点,n为层数,每次生效减少一层"),O(A.MODULE_DESC,R.HARMLESS_PROCESSOR,"处理:[c.ability]\n如果销毁资源,然后恢复[c.healAbility]"),O(A.MODULE_DESC,R.RECYCLE,"销毁复杂度<=[c.ability]的资源,然后恢复[c.healAbility]生命值"),O(A.MODULE_DESC,R.POLE_TRANSMISSION,"每新波次回合 获得[c.value]价值"),O(A.MODULE_DESC,R.LABORATORY,"消耗复杂度>=[c.baseLine]的持久数据\n获得研究点log2(资源复杂度/[c.baseLine])"),O(A.MODULE_DESC,R.JAMMER,"处理:[c.ability]\n给目标施加减速"),O(A.MODULE_DESC,R.BLOCKER,"让资源停止移动[c.leftTime]秒"),O(A.MODULE_DESC,R.PROCESSOR_N,"处理:[c.ability]\n同时处理[c.count]个目标")})),O._RF.push({},"c27e7ABUqxNeLkH+lXc3Jx2","lan",void 0),O._RF.pop()}}}));

System.register("chunks:///_virtual/Level.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"41b55t88tRH7ahl264EIlKF","Level",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/LevelItemVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./EnumDefine.ts"],(function(e){var t,n,i,o,r,l,a,c,s,u,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,a=e.Label,c=e.NodeEventType,s=e.Component},function(e){u=e.GlobalContext},function(e){p=e.TranslateScope}],execute:function(){var v,f,h,d,m;r._RF.push({},"00e13zBT/RFwbMKzVydO/2B","LevelItemVMgr",void 0);var y=l.ccclass,g=l.property;e("LevelItemVMgr",(v=y("LevelItemVMgr"),f=g({type:a}),v((m=t((d=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,i(t,"nameText",m,o(t)),t.level=void 0,t.onSelected=void 0,t}n(t,e);var r=t.prototype;return r.start=function(){},r.update=function(e){},r.init=function(e,t){this.level=e,this.onSelected=t,this.node.on(c.MOUSE_DOWN,this.onClick,this),this.nameText.string=u.translateManager.$(p.G_LEVEL_NAME,e.name)},r.onClick=function(){this.onSelected(this.level)},t}(s)).prototype,"nameText",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=d))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/LogicSystem.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"d36e32FqAZA5J5L97PP0ESu","LogicSystem",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./GameLogic.ts","./GameContextBuilder.ts","./BuildingManager.ts","./DamageManager.ts","./EventBus.ts","./FunctionManager.ts","./GameEntityManager.ts","./GameLogicUtils.ts","./MapUtil.ts","./ResearchManager.ts","./SettingDataManager.ts","./TranslateManager.ts","./GlobalContextImpl.ts","./common.ts","./EnumDefine.ts","./BuffDefine.ts","./BulletDefine.ts","./EventDefine.ts","./GameData.ts","./GameEntity.ts","./Global.ts","./Level.ts","./LogicSystem.ts","./Mod2.ts","./Physical.ts","./RenderApi.ts","./SettingData.ts","./funcs.ts","./buff.ts","./main3.ts","./define.ts","./Analyzer.ts","./Blocker.ts","./CollaborativeProcessor.ts","./End.ts","./Flip.ts","./HarmlessProcessor.ts","./IndependentProcessor.ts","./Jammer.ts","./Laboratory.ts","./PolePowerStation.ts","./Processor.ts","./ProcessorN.ts","./Recycle.ts","./Start.ts","./main4.ts","./main2.ts","./lan.ts","./main.ts","./mod.ts","./research.ts","./CameraManager.ts","./DelayShow.ts","./GlobalInputEventManager.ts","./UIUtilities.ts","./ViewGlobal.ts","./RenderManager.ts","./BulletVMgr.ts","./MapUnitManager.ts","./ModuleVMgr.ts","./ResourceBuffVMgr.ts","./ResourceVMgr.ts","./AssetVMgr.ts","./BarVMgr.ts","./CircularRangeIndicator.ts","./GridRangeIndicator.ts","./MapUnitSelectorVMgr.ts","./BottomMenuVMgr.ts","./BottomRightMenuVMgr.ts","./InfoVMgr.ts","./WaveInfoVMgr.ts","./BuildingItemVMgr.ts","./BuildingVMgr.ts","./LevelItemVMgr.ts","./SelectLevelVMgr.ts","./debug-view-runtime-control.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/main.ts",["cc","./EnumDefine.ts","./main3.ts","./define.ts"],(function(n){var e,o,u,t,i;return{setters:[function(n){e=n.cclegacy},function(n){o=n.GroundTypeEnum},function(n){u=n.FRAME_RATE},function(n){t=n.ModuleName,i=n.ResourceName}],execute:function(){e._RF.push({},"1777cN0rQ1G05yHHSu+Bl7E","main",void 0);var c={name:"LV1",desc:"LV1",width:4,height:4,difficulty:1,waves:[{tick:u,info:[[{name:i.META_DATA,complexity:4,count:6,interval:3*u,delay:u}]]},{tick:18*u,info:[[{name:i.META_DATA,complexity:5,count:6,interval:3*u,delay:0},{name:i.PERSISTENT_DATA,complexity:40,count:1,interval:3*u,delay:10*u}]]}],wayPoints:[[{x:0,y:0},{x:1,y:0},{x:1,y:3},{x:3,y:3}]],grounds:[{pos:{x:0,y:1},ground:o.PIN__8},{pos:{x:0,y:2},ground:o.PIN__8},{pos:{x:0,y:3},ground:o.PIN__8},{pos:{x:2,y:0},ground:o.PIN__8},{pos:{x:2,y:1},ground:o.PIN__8},{pos:{x:2,y:2},ground:o.PIN__8},{pos:{x:3,y:0},ground:o.PIN__8},{pos:{x:3,y:1},ground:o.PIN__8},{pos:{x:3,y:2},ground:o.PIN__8}],asset:{hp:{cur:30,max:30},energy:{cur:0,max:100},value:{cur:160,max:9999},baseResearch:{cur:0,max:100}},limitModule:[t.PROCESSOR,t.INDEPENDENT_PROCESSOR,t.FLIP],winCondition:{}};n("levels",[c]);e._RF.pop()}}}));

System.register("chunks:///_virtual/main2.ts",["cc","./main3.ts","./define.ts"],(function(e){var n,a,c,o;return{setters:[function(e){n=e.cclegacy},function(e){a=e.FRAME_RATE},function(e){c=e.ResourceName,o=e.TResourceType}],execute:function(){e("init",(function(e,n){e.addResource(s),e.addResource(u),e.addResource(r),n.addFunction((function(e){return e.resource.onTick}),c.PERSISTENT_DATA,(function(e,n){n.alive&&n.vars.complexity>n.vars.orgComplexity&&e.managers.damageManager}))})),n._RF.push({},"2b616+aPHVIxbH6YSzB7pfW","main",void 0);var s={name:c.META_DATA,resourceType:o.COMMON,funcs:{},consts:[{damage:2,addValue:5,moveSpeed:.5/a}]},u={name:c.PERSISTENT_DATA,resourceType:o.COMMON,funcs:{onTick:c.PERSISTENT_DATA},consts:[{damage:2,addValue:8,moveSpeed:.5/a}]},r={name:c.VOLATILE_DATA,resourceType:o.COMMON,funcs:{},consts:[{damage:2,addValue:2,moveSpeed:.5/a}]};n._RF.pop()}}}));

System.register("chunks:///_virtual/main3.ts",["cc","./common.ts","./EnumDefine.ts","./BulletDefine.ts"],(function(e){var n,t,r,u,i;return{setters:[function(e){n=e.cclegacy,t=e.assert},function(e){r=e.DEFAULT},function(e){u=e.AssetName},function(e){i=e.Bullet}],execute:function(){e("init",(function(e,n){var t=[o];n.addFunction((function(e){return e.resource.selector}),"default",o.func),t.forEach((function(e){n.addFunction((function(e){return e.resource.selector}),e.name,e.func)})),[c].forEach((function(e){n.addFunction((function(e){return e.module.onNewWave}),e.name,e.func)})),n.addFunction((function(e){return e.global.judge.win}),a.name,a.func),n.addFunction((function(e){return e.bullet.lifeCycle.onTriggered}),s.name,s.func)})),n._RF.push({},"59f76bX7fpKzZ6uNJTA9OcJ","main",void 0);var o=e("CommonResourceSelector",{name:"CommonResourceSelector",func:function(e,n,r){t(!!r.consts.effect);var u=r.consts.effect.resourceSelector,i=!0;return i&&u.resourceTagNoFilter&&(i=!e.managers.gameLogicUtil.hasTag(n,u.resourceTagNoFilter)),i&&u.resourceTypeFilter&&(i=u.resourceTypeFilter.includes(n.setting.resourceType)),i&&u.resourceNameFilter&&(i=u.resourceNameFilter.includes(n.setting.name)),i&&u.maxComplexity&&(i=n.vars.complexity<=u.maxComplexity),i&&u.minComplexity&&(i=n.vars.complexity>=u.minComplexity),i}}),c=e("AddValuePerWave",{name:"AddValuePerWave",func:function(e,n){var t=n.consts;e.managers.gameLogicUtil.addAsset(u.VALUE,t.value)}});var a=e("CommonWinJudge",{name:"default",func:function(e){var n=e.winCondition;if(n.tick&&e.tick>n.tick)return e.alive=!1,e.win=!0,!0;if(n.asset){if(function(e,n){for(var t in n)if(!e[t]||n[t]>e[t].cur)return!1;return!0}(e.asset,n.asset))return e.alive=!1,e.win=!0,!0;if(!e.temp.hasNoResource)return e.alive=!1,e.win=!1,!0}else if(!n.tick&&!n.asset&&e.temp.hasNoResource)return e.alive=!1,e.win=!0,!0;return!1}}),s=e("CommonBulletOnTrigger",{name:r,func:function(e,n,t,r){if(t!==i.BulletTargetEnum.Resource)throw new Error(" target type wrong");e.managers.damageManager.apply(r,n)}});e("FRAME_RATE",20);n._RF.pop()}}}));

System.register("chunks:///_virtual/main4.ts",["cc","./Analyzer.ts","./Blocker.ts","./CollaborativeProcessor.ts","./End.ts","./Flip.ts","./HarmlessProcessor.ts","./IndependentProcessor.ts","./Jammer.ts","./Laboratory.ts","./PolePowerStation.ts","./Processor.ts","./ProcessorN.ts","./Recycle.ts","./Start.ts"],(function(n){var t,o,r,u,c,s,i,e,f,a,l,d,P,m,p;return{setters:[function(n){t=n.cclegacy},function(n){o=n.run},function(n){r=n.run},function(n){u=n.run},function(n){c=n.run},function(n){s=n.run},function(n){i=n.run},function(n){e=n.run},function(n){f=n.run},function(n){a=n.run},function(n){l=n.run},function(n){d=n.run},function(n){P=n.run},function(n){m=n.run},function(n){p=n.run}],execute:function(){n("init",(function(n,t){function y(n,o,r){t.addFunction(n,o,r)}[d,e,u,s,o,c,i,l,m,p,a,f,r,P].forEach((function(t){return t(n.addModule,y)}))})),t._RF.push({},"87cfe1qPBlHHqz+jUokB7kw","main",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/MapUnitManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./ViewGlobal.ts","./common.ts"],(function(t){var o,n,i,e,s,a,u,r,c,p,d,l;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,e=t.Sprite,s=t.Node,a=t.Vec2,u=t.assert,r=t.Component},function(t){c=t.GlobalContext},function(t){p=t.UIGlobalContext,d=t.InputMode},function(t){l=t.MyPointClass}],execute:function(){var h;n._RF.push({},"c45fc6OVdNERImkTY6az4/W","MapUnitManager",void 0);var m=i.ccclass;t("MapUnitManager",m("MapUnitManager")(h=function(t){function n(){for(var o,n=arguments.length,i=new Array(n),e=0;e<n;e++)i[e]=arguments[e];return(o=t.call.apply(t,[this].concat(i))||this).bg=void 0,o.mapUnit=void 0,o.position=void 0,o.selector3=void 0,o.mouseDownPosition=void 0,o}o(n,t);var i=n.prototype;return i.loadRef=function(){!this.bg&&(this.bg=this.getComponent(e)),!this.selector3&&(this.selector3=this.node.getChildByName("selector3")),this.selector3.active=!1},i.start=function(){this.loadRef()},i.update=function(t){if(this.mapUnit)if(this.mapUnit.module||p.myInputSystem.inputMode.data!==d.BUILD_MODULE)this.selector3.active=!1;else{var o=c.settingDataManager.getModule(p.myInputSystem.clickedBuildAble.data);this.selector3.active=!!o&&o.groundType===this.mapUnit.groundType}},i.init=function(t){this.loadRef(),this.node.on(s.EventType.MOUSE_ENTER,this.onMouseEnter,this,!0),this.node.on(s.EventType.MOUSE_LEAVE,this.onMouseOut,this,!0),this.node.on(s.EventType.MOUSE_DOWN,this.onMouseDown,this,!0),this.node.on(s.EventType.MOUSE_UP,this.onMouseUp,this,!0),this.position=t.position;var o=c.renderDataManager.getGroundSprite(t.groundType);this.bg.spriteFrame=p.engineResourceManager.getSprite(o),this.mapUnit=t},i.onMouseEnter=function(t){p.myInputSystem.position.data=this.position},i.onMouseOut=function(t){this.position&&l.equals(this.position,p.myInputSystem.position.data)&&(p.myInputSystem.position.data=void 0)},i.onMouseDown=function(t){this.mouseDownPosition=t.getLocation()},i.onMouseUp=function(t){if(this.mouseDownPosition&&!(a.distance(t.getLocation(),this.mouseDownPosition)>=p.DRAG_DISTANCE)){var o=p.myInputSystem.inputMode,n=p.myInputSystem.clickedPosition,i=p.myInputSystem.clickedBuildAble;if(o.data==d.BUILD_MODULE&&0==t.getButton()){if(!c.context||!c.context.alive)return;u(!!i.data,"建筑模式应该有选择的建筑");var e=c.context.managers.buildingManager.buildModule(c.context.map.getAt(this.position),i.data);o.data=d.NONE,i.data=void 0,console.log("建造完成",JSON.stringify(e))}else o.data==d.NONE&&0==t.getButton()&&(n.data=n.data===this.position?void 0:this.position)}},i.onDestroy=function(){},n}(r))||h);n._RF.pop()}}}));

System.register("chunks:///_virtual/MapUnitSelectorVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./UIUtilities.ts","./ViewGlobal.ts","./EnumDefine.ts","./CircularRangeIndicator.ts","./GridRangeIndicator.ts"],(function(t){var e,i,n,r,a,o,c,s,l,u,d,p,g,f,h,I,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){a=t.cclegacy,o=t._decorator,c=t.SpriteFrame,s=t.Sprite,l=t.Component},function(t){u=t.GlobalContext},function(t){d=t.UseMemo,p=t.getViewPositionVec3},function(t){g=t.UIGlobalContext,f=t.InputMode},function(t){h=t.RangeTypeEnum},function(t){I=t.CircularRangeIndicator},function(t){y=t.GridRangeIndicator}],execute:function(){var m,R,D,v,M,S,b,U,C,E,L;a._RF.push({},"8ad5b7WINZBD7Ps5ZXoCWmk","MapUnitSelectorVMgr",void 0);var _=o.ccclass,w=o.property,G={type:h.NONE,range:0};t("MapUnitSelectorVMgr",(m=_("MapUnitSelectorVMgr"),R=w({type:c}),D=w({type:c}),v=w({type:y}),M=w({type:I}),m((U=e((b=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a))||this,n(e,"selector1",U,r(e)),n(e,"selector2",C,r(e)),n(e,"gridRangeIndicator",E,r(e)),n(e,"circularRangeIndicator",L,r(e)),e.selector=void 0,e.selectorSprite=void 0,e.indicatorMemo=new d(G,e.refreshRangeIndicator,r(e),(function(t,e){return t.type!==e.type||t.range!=e.range})),e}i(e,t);var a=e.prototype;return a.start=function(){var t=this;this.selector=this.node,this.selectorSprite=this.selector.getComponent(s),g.myInputSystem.clickedPosition.on((function(e,i){t.refreshSelector(),t.refreshRangeIndicatorData()})),g.myInputSystem.position.on((function(e,i){t.refreshSelector(),t.refreshRangeIndicatorData()})),g.myInputSystem.inputMode.on((function(e,i){t.refreshSelector(),t.refreshRangeIndicatorData()}))},a.update=function(t){},a.refreshSelector=function(){var t=g.myInputSystem;if(t.inputMode.data!==f.ON_UI&&t.inputMode.data!==f.VIEW_DRAG){var e,i=void 0,n=!1;if(t.inputMode.data===f.BUILD_MODULE)i=t.position.data;else i=null!=(e=t.clickedPosition.data)?e:t.position.data,n=!!t.clickedPosition.data;if(i){this.selector.active=!0;var r=p(i);this.selector.position=r,this.selectorSprite.spriteFrame=n?this.selector2:this.selector1}else this.selector.active=!1}else this.selector.active=!1},a.refreshRangeIndicator=function(t,e){if(!e)return this.gridRangeIndicator.setData(!1,0),void this.circularRangeIndicator.setData(!1,0);e.type===h.CIRCULAR?(this.gridRangeIndicator.setData(!1,0),this.circularRangeIndicator.setData(!0,e.range)):e.type===h.SELF?(this.gridRangeIndicator.setData(!0,0),this.circularRangeIndicator.setData(!1,0)):e.type===h.GRID?(this.gridRangeIndicator.setData(!0,e.range),this.circularRangeIndicator.setData(!1,0)):e.type===h.NONE&&(this.gridRangeIndicator.setData(!1,0),this.circularRangeIndicator.setData(!1,0))},a.refreshRangeIndicatorData=function(){if(u.context){var t,e=void 0,i=g.myInputSystem;if(i.inputMode.data===f.BUILD_MODULE)e=i.position.data;else e=null!=(t=i.clickedPosition.data)?t:i.position.data;if(i.inputMode.data!==f.BUILD_MODULE){if(e){var n,r,a,o=null==(n=u.context.map.getAt(e))?void 0:n.module,c=null==o||null==(r=o.consts)||null==(r=r.effect)?void 0:r.range;if(c)return void this.indicatorMemo.put({type:c.type,range:null!=(a=c.range)?a:0})}this.indicatorMemo.put(G)}else{var s,l,d=u.context.managers.settingDataManager.getModule(i.clickedBuildAble.data);if(!d)return;var p=null==(s=d.consts[0].effect)?void 0:s.range;if(!p||p.type===h.NONE)return;this.indicatorMemo.put({type:p.type,range:null!=(l=p.range)?l:0})}}},e}(l)).prototype,"selector1",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=e(b.prototype,"selector2",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=e(b.prototype,"gridRangeIndicator",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=e(b.prototype,"circularRangeIndicator",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=b))||S));a._RF.pop()}}}));

System.register("chunks:///_virtual/MapUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EnumDefine.ts"],(function(t){var n,a,i,e,s;return{setters:[function(t){n=t.extends},function(t){a=t.cclegacy},function(t){i=t.bindAll,e=t.assert},function(t){s=t.DR_MAP}],execute:function(){a._RF.push({},"ffa52GU2SxFV7QZQzfXKabu","MapUtil",void 0);t("MapUtil",function(){function t(){this.context=void 0,this.settingDataManager=void 0,this.functionManager=void 0,this.eventBus=void 0,this.gameEntityManager=void 0,this.buffManager=void 0,this.gameLogicUtils=void 0}var a=t.prototype;return a.setContext=function(t){this.context=t,this.settingDataManager=t.managers.settingDataManager,this.functionManager=t.managers.functionManager,this.eventBus=t.managers.eventBus,this.gameEntityManager=t.managers.gameEntityManager,this.buffManager=t.managers.buildingManager,this.gameLogicUtils=t.managers.gameLogicUtil,i(this)},a.inMap=function(t,n){return e(Math.floor(t)===t&&Math.floor(n)===n),t>=0&&t<this.context.map.sizeX&&n>=0&&n<this.context.map.sizeY},a.inMapRealPoint=function(t,n){return t>=-.5&&t<this.context.map.sizeX+.5&&n>=-.5&&n<this.context.map.sizeY+.5},a.distance2=function(t,n){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},a.approach=function(t,a,i){var e=this.distance2(t,a);if(e<=i)return n({},a,{arrive:!0});var s=i/e;return{x:t.x+(a.x-t.x)*s,y:t.y+(a.y-t.y)*s}},a.approachDirection=function(t,n,a){var i=s[n];return{x:t.x+i[0]*i[2]*a,y:t.y+i[1]*i[2]*a}},t}());a._RF.pop()}}}));

System.register("chunks:///_virtual/mod.ts",["cc","./common.ts","./EnumDefine.ts","./Mod2.ts","./buff.ts","./main3.ts","./define.ts","./main4.ts","./main2.ts","./lan.ts","./main.ts","./research.ts"],(function(e){var n,t,r,a,o,i,s,c,u,l,d,g,f,M;return{setters:[function(e){n=e.cclegacy},function(e){t=e.DEFAULT},function(e){r=e.GroundTypeEnum,a=e.ModuleEffectTypeEnum},function(e){o=e.ModInfoClass},function(e){i=e.init},function(e){s=e.init},function(e){c=e.ResourceName,u=e.ModuleName},function(e){l=e.init},function(e){d=e.init},function(e){g=e.init},function(e){f=e.levels},function(e){M=e.init}],execute:function(){var p;n._RF.push({},"f3ceb7gYblEyo11MaQKOPIw","mod",void 0);e("ModInfo",o(p=function(){function e(){this.name="core",this.desc="",this.dependence=[],this.conflict=[],this.version="0.0.1"}var n=e.prototype;return n.onLoad=function(){console.log("core loaded")},n.onApplicationLoaded=function(e,n,o){f.forEach((function(e){o.levelManager.addLevel(e)})),g(o.translateManager),l(o.settingDataManager,o.functionManager),d(o.settingDataManager,o.functionManager),i(o.settingDataManager,o.functionManager),s(o.settingDataManager,o.functionManager),M(o.settingDataManager,o.functionManager),o.renderDataManager.setResourceSpriteAndColor(t,"rs/circular",o.colorUtils.YELLOW,o.colorUtils.RED),o.renderDataManager.setResourceSpriteAndColor(c.META_DATA,"rs/circular",o.colorUtils.YELLOW,o.colorUtils.RED),o.renderDataManager.setResourceSpriteAndColor(c.PERSISTENT_DATA,"rs/square",o.colorUtils.YELLOW,o.colorUtils.RED),o.renderDataManager.setResourceSpriteAndColor(c.VOLATILE_DATA,"rs/triangle",o.colorUtils.YELLOW,o.colorUtils.RED),o.renderDataManager.setResourceBuffSprite(t,"rs/square"),o.renderDataManager.setGroundSprite(r.INSULATION,"gd/bs"),o.renderDataManager.setGroundSprite(r.WIRE,"gd/w"),o.renderDataManager.setGroundSprite(r.PIN__16,"gd/p16"),o.renderDataManager.setGroundSprite(r.PIN__8,"gd/p8"),o.renderDataManager.setGroundSprite(r.PIN__4,"gd/p4"),o.renderDataManager.setGroundSprite(r.PIN__2,"gd/p2"),o.renderDataManager.setBulletSprite(a.PROCESS,"bl/process"),o.renderDataManager.setBulletSprite(void 0,"bl/process")},n.onGameContextCreated=function(e,n,t,r){var a=e.managers.gameEntityManager,o=e.map;a.registerModule(a.createModule(u.START),o.mapUnits[0][0]),a.registerModule(a.createModule(u.END),o.mapUnits[o.sizeY-1][o.sizeX-1]),e.place.ends=o.filter((function(e){var n;return(null==(n=e.module)?void 0:n.name)==u.END})),e.place.starts=o.filter((function(e){var n;return(null==(n=e.module)?void 0:n.name)==u.START}))},e}())||p);n._RF.pop()}}}));

System.register("chunks:///_virtual/Mod2.ts",["cc"],(function(n){var o;return{setters:[function(n){o=n.cclegacy}],execute:function(){o._RF.push({},"f3452ROgKZGo5l7ggIy4NCF","Mod",void 0);var t=n("Mods",[]);n("ModInfoClass",(function(n){var o=new n;t.push(o)}));o._RF.pop()}}}));

System.register("chunks:///_virtual/ModuleVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnumDefine.ts"],(function(e){var t,i,n,r,a,o,c,l,s,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,c=e.RichText,l=e.Sprite,s=e.Component},function(e){f=e.TranslateScope}],execute:function(){var u,p,d,h,v,y,g;a._RF.push({},"0c4809RZZBIxo/PQieuBmnE","ModuleVMgr",void 0);var m=o.ccclass,M=o.property;e("ModuleVMgr",(u=m("ModuleVMgr"),p=M({type:c}),d=M({type:l,displayName:"效果进度条"}),u((y=t((v=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,n(t,"nameText",y,r(t)),n(t,"effectBar",g,r(t)),t.entity=void 0,t.mapUnit=void 0,t}i(t,e);var a=t.prototype;return a.start=function(){},a.initNew=function(e,t){var i=e.managers.translateManager.$,n=t.module;this.nameText.string=i(f.MODULE_NAME,n.name),this.entity=n,this.mapUnit=t},a.update=function(e){this.entity&&this.renderEffectColdDown()},a.renderEffectColdDown=function(){var e,t;if(!this.entity.consts.effect||this.entity.consts.effect.triggerInterval<=0)this.effectBar.node.active=!1;else{this.effectBar.node.active=!0;var i=null==(e=this.entity.consts.effect)?void 0:e.triggerInterval,n=null==(t=this.entity.vars.effect)?void 0:t.coldDown;if(i&&n){var r=(i-n)/i;this.effectBar.fillRange=r}else this.effectBar.fillRange=1}},t}(s)).prototype,"nameText",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=t(v.prototype,"effectBar",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=v))||h));a._RF.pop()}}}));

System.register("chunks:///_virtual/Physical.ts",["cc"],(function(r){var n;return{setters:[function(r){n=r.cclegacy}],execute:function(){function t(r,n,t,o){return Math.sqrt(Math.pow(r-t,2)+Math.pow(n-o,2))}function o(r,n,o,e,i,l,u){return u=u||1,Math.abs(t(r,n,o,e)-(t(r,n,i,l)+t(o,e,i,l)))<=u}function e(r,n,t,o,e,i,l,u){return r<e+l&&r+t>e&&n<i+u&&n+o>i}function i(r,n,t,o,e,i,l){var u=t/2,c=o/2,f=Math.abs(e-(r+t/2)),a=Math.abs(i-(n+o/2));if(f>u+l||a>c+l)return!1;if(f<=u||a<=c)return!0;var y=f-u,h=a-c;return y*y+h*h<=l*l}function l(r,n,t,o,e,i){var l=r-o,u=e-n,c=t+i;return l*l+u*u<=c*c}r({boxBox:e,boxCircle:i,circleCircle:l,linePoint:o,overlap:function(r,n){if(!r.collideInfo||!n.collideInfo)return!1;var t=function(r,n){var t=c(r),o=c(n);return t<o?[r,n]:[n,r]}(r,n),o=t[0],f=t[1],a=o.collideInfo,y=f.collideInfo,h=o.position,p=f.position;if(a.type===u.BOX&&y.type===u.BOX)return e(h.x-a.w/2,h.y-a.h/2,a.w,a.h,p.x-y.w/2,p.y-y.h/2,y.w,y.h);if(a.type===u.Circular&&y.type===u.Circular)return l(h.x,h.y,a.r,p.x,p.y,y.r);if(a.type===u.BOX&&y.type===u.Circular)return i(h.x-a.w/2,h.y-a.h/2,a.w,a.h,p.x,p.y,y.r);throw new Error("not impl collider"+JSON.stringify(a)+JSON.stringify(y))},polygonPoint:function(r,n,t,e){var i,l,u=r.length,c=!1;for(i=0,l=u-2;i<u;i+=2)r[i+1]>t!=r[l+1]>t&&n<(r[l]-r[i])*(t-r[i+1])/(r[l+1]-r[i+1])+r[i]&&(c=!c),l=i;if(c)return!0;for(i=0;i<u;i+=2){var f,a,y=r[i],h=r[i+1];if(i===u-2?(f=r[0],a=r[1]):(f=r[i+2],a=r[i+3]),o(y,h,f,a,n,t,e))return!0}return!1},polygonPolygon:function(r,n){for(var t,o,e,i,l,u,c=r,f=n,a=[c,f],y=0;y<a.length;y++)for(var h=a[y],p=0;p<h.length;p+=2){var v=(p+2)%h.length,s={x:h[v+1]-h[p+1],y:h[p]-h[v]};for(t=o=null,u=0;u<c.length;u+=2)e=s.x*c[u]+s.y*c[u+1],(null===t||e<t)&&(t=e),(null===o||e>o)&&(o=e);for(i=l=null,u=0;u<f.length;u+=2)e=s.x*f[u]+s.y*f[u+1],(null===i||e<i)&&(i=e),(null===l||e>l)&&(l=e);if(o<i||l<t)return!1}return!0}}),n._RF.push({},"a93f4NQiohD1bK/adn2fU+h","Physical",void 0);var u=r("ColliderTypeEnum",{Circular:"C",BOX:"B",ConvexPolygon:"CP"});function c(r){var n=r.collideInfo.type;return n===u.Circular?1:n===u.BOX?2:n===u.ConvexPolygon?3:1e3}n._RF.pop()}}}));

System.register("chunks:///_virtual/PolePowerStation.ts",["cc","./main3.ts","./EnumDefine.ts","./define.ts"],(function(e){var n,t,u,o;return{setters:[function(e){n=e.cclegacy},function(e){t=e.AddValuePerWave},function(e){u=e.GroundTypeEnum},function(e){o=e.ModuleName}],execute:function(){e("run",(function(e,n){e(c)})),n._RF.push({},"f73ca9/mJlIkJ51PlGyzYpR","PolePowerStation",void 0);var c={name:o.POLE_TRANSMISSION,groundType:u.POLE,funcs:{onNewWave:t.name},consts:[{value:20,buildAble:{cost:50}}]};n._RF.pop()}}}));

System.register("chunks:///_virtual/Processor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EnumDefine.ts","./BulletDefine.ts","./main3.ts","./define.ts"],(function(e){var n,t,o,r,u,c,i,s,a,l;return{setters:[function(e){n=e.extends},function(e){t=e.cclegacy},function(e){o=e.DEFAULT},function(e){r=e.ModuleEffectTypeEnum,u=e.GroundTypeEnum,c=e.RangeTypeEnum},function(e){i=e.Bullet},function(e){s=e.FRAME_RATE},function(e){a=e.ModuleName,l=e.TResourceType}],execute:function(){e("run",(function(e,t){e(f),t((function(e){return e.module.effect}),f.name,(function(e,t,u){var c=t.consts;e.managers.gameEntityManager.createAndRegisterBullet({effectType:r.PROCESS,ability:{processAbility:c.ability},targetType:i.BulletTargetEnum.Resource,moveSpeed:1/s,position:n({},t.position),target:u[0],onTriggered:o})}))})),t._RF.push({},"a2c7eILobdHhrbeiRyUsdP8","Processor",void 0);var f={name:a.PROCESSOR,groundType:u.PIN__8,funcs:{},consts:[{effect:{range:{type:c.CIRCULAR,range:2},resourceSelector:{resourceTypeFilter:[l.COMMON]},triggerInterval:30,funcName:a.PROCESSOR},buildAble:{cost:48},ability:2}]};t._RF.pop()}}}));

System.register("chunks:///_virtual/ProcessorN.ts",["./rollupPluginModLoBabelHelpers.js","cc","./common.ts","./EnumDefine.ts","./BulletDefine.ts","./main3.ts","./define.ts"],(function(e){var n,t,o,r,u,c,i,s,a,l;return{setters:[function(e){n=e.extends},function(e){t=e.cclegacy},function(e){o=e.DEFAULT},function(e){r=e.ModuleEffectTypeEnum,u=e.GroundTypeEnum,c=e.RangeTypeEnum},function(e){i=e.Bullet},function(e){s=e.FRAME_RATE},function(e){a=e.ModuleName,l=e.TResourceType}],execute:function(){e("run",(function(e,t){e(f),t((function(e){return e.module.effect}),f.name,(function(e,t,u){for(var c=t.consts,a=0;a<Math.min(u.length,c.count);a++)e.managers.gameEntityManager.createAndRegisterBullet({effectType:r.PROCESS,ability:{processAbility:c.ability},targetType:i.BulletTargetEnum.Resource,moveSpeed:1/s,position:n({},t.position),target:u[a],onTriggered:o})}))})),t._RF.push({},"33454E2f9FBc5r3KQr45H1P","ProcessorN",void 0);var f={name:a.PROCESSOR_N,groundType:u.PIN__8,funcs:{},consts:[{effect:{range:{type:c.CIRCULAR,range:2},resourceSelector:{resourceTypeFilter:[l.COMMON]},triggerInterval:30,funcName:a.PROCESSOR_N},buildAble:{cost:50},ability:1,count:3}]};t._RF.pop()}}}));

System.register("chunks:///_virtual/Recycle.ts",["cc","./EnumDefine.ts","./define.ts"],(function(e){var n;return{setters:[function(e){n=e.cclegacy},null,null],execute:function(){e("run",(function(e,n){return})),n._RF.push({},"329f5gXboFLSI7iQDnGGXsd","Recycle",void 0),n._RF.pop()}}}));

System.register("chunks:///_virtual/RenderApi.ts",["cc"],(function(e){var c;return{setters:[function(e){c=e.cclegacy}],execute:function(){e("Render",void 0),c._RF.push({},"a2aecqsZllJfI4ekaTIj1FE","RenderApi",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/RenderManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./BulletVMgr.ts","./MapUnitManager.ts","./ModuleVMgr.ts","./ResourceVMgr.ts","./common.ts","./UIUtilities.ts"],(function(e){var t,i,r,n,o,a,l,u,s,p,c,d,f,m,b,g,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,l=e.Prefab,u=e.Node,s=e.instantiate,p=e.Component},function(e){c=e.GlobalContext},function(e){d=e.BulletVMgr},function(e){f=e.MapUnitManager},function(e){m=e.ModuleVMgr},function(e){b=e.ResourceVMgr},function(e){g=e.differ},function(e){h=e.getViewPositionVec3}],execute:function(){var w,M,V,y,v,C,P,z,R,U,N,x,B,E,G,_,D,F,I;o._RF.push({},"8b898QPN3hLirOHCUF9G9O9","RenderManager",void 0);var L=a.ccclass,S=a.property;e("RenderManager",(w=L("RenderManager"),M=S({type:l,displayName:"模块预制体"}),V=S({type:l,displayName:"空地图块"}),y=S({type:l,displayName:"资源预制体"}),v=S({type:l,displayName:"子弹预制体"}),C=S({type:u}),P=S({type:u}),z=S({type:u}),R=S({type:u}),w((x=t((N=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,r(t,"modulePrefab",x,n(t)),r(t,"emptyMapPrefab",B,n(t)),r(t,"resourcePrefab",E,n(t)),r(t,"bulletPrefab",G,n(t)),r(t,"mapUnitContainer",_,n(t)),r(t,"moduleContainer",D,n(t)),r(t,"resourceContainer",F,n(t)),r(t,"bulletContainer",I,n(t)),t.time=void 0,t.mapViews=void 0,t.resourceViews={},t.bulletViews={},t}i(t,e);var o=t.prototype;return o.start=function(){this.time=0},o.update=function(e){c.logic&&(this.time+=e,this.time>=.05/c.logic.gameSpeed&&(this.time-=.05/c.logic.gameSpeed,c.logic.nextTick(),this.render()))},o.createMapView=function(e){var t=s(this.emptyMapPrefab);t.parent=this.mapUnitContainer;var i=h(e.position);t.position=i;var r=t.getComponent(f);return r.init(e),r},o.createModuleView=function(e,t){var i=s(this.modulePrefab),r=i.getComponent(m);return r.initNew(e,t),i.parent=this.moduleContainer,i.position=h(t.position),r},o.updateResource=function(e){var t=this,i=g(this.resourceViews,e.entities.resources);i.add.forEach((function(e){var i=s(t.resourcePrefab);i.parent=t.resourceContainer,i.position=h(e.position);var r=i.getComponent(b);r.init(e),t.resourceViews[e.eid]=r})),i.delete.forEach((function(e){delete t.resourceViews[e.resource.eid],e.node.destroy()}))},o.updateBullet=function(e){var t=this,i=g(this.bulletViews,e.entities.bullets);i.add.forEach((function(e){var i=s(t.bulletPrefab);i.parent=t.bulletContainer,i.position=h(e.position);var r=i.getComponent(d);r.init(e),t.bulletViews[e.eid]=r})),i.delete.forEach((function(e){delete t.bulletViews[e.bullet.eid],e.node.destroy()}))},o.render=function(){var e=c.logic.gameContext,t=e.map,i=t.sizeX,r=t.sizeY,n=t.mapUnits;this.initMapViews(r,i,n),this.updateModule(r,i,n,e),this.updateResource(e),this.updateBullet(e)},o.initMapViews=function(e,t,i){if(!this.mapViews){this.mapViews=[];for(var r=0;r<e;r++){var n=[];this.mapViews.push(n);for(var o=0;o<t;o++){var a=i[r][o];n.push({mapGroundViewMgr:this.createMapView(a),mapUnit:a})}}}},o.updateModule=function(e,t,i,r){if(this.mapViews)for(var n=0;n<e;n++)for(var o=this.mapViews[n],a=0;a<t;a++){var l=o[a],u=i[n][a];l.moduleViewMgr&&!u.module?(l.moduleViewMgr&&l.moduleViewMgr.node.destroy(),o[a].moduleViewMgr=void 0):!l.moduleViewMgr&&u.module&&(o[a].moduleViewMgr=this.createModuleView(r,u))}},t}(p)).prototype,"modulePrefab",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=t(N.prototype,"emptyMapPrefab",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=t(N.prototype,"resourcePrefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=t(N.prototype,"bulletPrefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=t(N.prototype,"mapUnitContainer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=t(N.prototype,"moduleContainer",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=t(N.prototype,"resourceContainer",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=t(N.prototype,"bulletContainer",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=N))||U));o._RF.pop()}}}));

System.register("chunks:///_virtual/research.ts",["cc"],(function(c){var e;return{setters:[function(c){e=c.cclegacy}],execute:function(){c("init",(function(c,e){})),e._RF.push({},"6c9b98Q76VHtJ6oylkfxI40","research",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/ResearchManager.ts",["cc","./common.ts","./EnumDefine.ts"],(function(e){var t,n,s;return{setters:[function(e){t=e.cclegacy},function(e){n=e.bindAll},function(e){s=e.AssetName}],execute:function(){t._RF.push({},"1ec1fRqjixAAqq0rapSjbRj","ResearchManager",void 0);e("ResearchManager",function(){function e(){this.context=void 0,this.researches=[],this.researchesMap={}}var t=e.prototype;return t.getAll=function(){return this.researches},t.unlock=function(e){var t,n=this.researchesMap[e.name];return!!n&&(!n.locked||!!this.context.managers.gameLogicUtil.useAsset(s.RESEARCH_BASE,n.item.cost)&&(this.researchesMap[e.name].locked=!1,this.context.managers.buildingManager.unLockModules(null!=(t=n.item.unLockModules)?t:[]),!0))},t.setContext=function(e){this.context=e,n(this)},t.afterGameContextFullInit=function(){var e=new Set(this.researches.flatMap((function(e){return e.item.unLockModules})));this.context.managers.buildingManager.lockModules([].concat(e))},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/ResourceBuffVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./ViewGlobal.ts"],(function(e){var t,n,r,i,o,s,c;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e._decorator,i=e.Sprite,o=e.Component},function(e){s=e.GlobalContext},function(e){c=e.UIGlobalContext}],execute:function(){var u;n._RF.push({},"d070bETdj5JcZXUxDFRNMD3","ResourceBuffVMgr",void 0);var f=r.ccclass;r.property,e("ResourceBuffVMgr",f("ResourceBuffVMgr")(u=function(e){function n(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).resource=void 0,t.container=void 0,t.buffItems=void 0,t}t(n,e);var r=n.prototype;return r.start=function(){this.container||(this.container=this.node.getChildByName("Buffs")),this.buffItems||(this.buffItems=this.container.children.map((function(e){return{node:e,sprite:e.getComponent(i)}})))},r.init=function(e){this.resource=e},r.update=function(e){if(this.resource){var t=this.resource.buffs;if(t.length){this.container.active=!0;for(var n=0,r=0;r<t.length&&n<4;r++){var i=t[r];if(i.setting.icon.show){this.buffItems[n].node.active=!0;var o=c.engineResourceManager.getSprite(s.renderDataManager.getResourceBuffSprite(i.setting.icon.name));this.buffItems[n].sprite.spriteFrame=o}}for(;n<t.length&&n<4;n++);for(;n<4;n++)this.buffItems[n].node.active=!1}else this.container.active=!1}},n}(o))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/ResourceVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./BuffDefine.ts","./UIUtilities.ts","./ViewGlobal.ts","./BarVMgr.ts","./ResourceBuffVMgr.ts"],(function(e){var t,r,i,n,o,a,s,u,l,c,p,f,g,h,b,m,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,s=e.RichText,u=e.Sprite,l=e.tween,c=e.Component},function(e){p=e.GlobalContext},function(e){f=e.ResourceBuff},function(e){g=e.UseMemo,h=e.getViewPositionVec3},function(e){b=e.UIGlobalContext},function(e){m=e.BarVMgr},function(e){y=e.ResourceBuffVMgr}],execute:function(){var M,v,d,x,w,R,T,V,B,S,C;o._RF.push({},"2f81aCXZudNhop8Y3PgzLcA","ResourceVMgr",void 0);var z=a.ccclass,N=a.property;e("ResourceVMgr",(M=z("ResourceVMgr"),v=N({type:s}),d=N({type:u}),x=N({type:m}),w=N({type:y}),M((V=t((T=function(e){function t(){for(var t,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,i(t,"numberText",V,n(t)),i(t,"bgSprite",B,n(t)),i(t,"barManager",S,n(t)),i(t,"buffManager",C,n(t)),t.resource=void 0,t.lastTween=void 0,t.resourceNameMemo=new g(void 0,t.updateSprite,n(t)),t}r(t,e);var o=t.prototype;return o.start=function(){},o.init=function(e){this.resource=e,this.resourceNameMemo.put(e.name),this.numberText.string=""+e.vars.complexity,this.barManager.init([0,1,0]),this.buffManager.init(e)},o.updateSprite=function(){var e=p.renderDataManager.getResourceSpriteAndColor(this.resource.name),t=e[0],r=e[1],i=e[2];this.numberText.fontColor=i,this.bgSprite.spriteFrame=b.engineResourceManager.getSprite(t),this.bgSprite.color=r},o.getHpBarValue=function(){var e,t,r=this.resource.vars,i=this.resource.buffs.find((function(e){return e.name===f.ResourceBuffName.UNSTABLE})),n=null!=(e=null==i||null==(t=i.vars)?void 0:t.complexity)?e:0;return[n,r.complexity-n,Math.max(r.orgComplexity-r.complexity,0)]},o.update=function(e){var t=this;if(this.resource&&(this.barManager.myUpdate(this.getHpBarValue()),this.resourceNameMemo.put(this.resource.name),!this.lastTween)){var r=this.resource.position;this.numberText.string=""+this.resource.vars.complexity,r={x:Math.floor(1e3*r.x)/1e3,y:Math.floor(1e3*r.y)/1e3};var i=h(r);this.lastTween=l(this.node),this.lastTween.to(0,{position:i}).call((function(){return t.lastTween=void 0})).start()}},t}(c)).prototype,"numberText",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=t(T.prototype,"bgSprite",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=t(T.prototype,"barManager",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=t(T.prototype,"buffManager",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=T))||R));o._RF.pop()}}}));

System.register("chunks:///_virtual/SelectLevelVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameContextBuilder.ts","./GameLogic.ts","./GlobalContextImpl.ts","./ViewGlobal.ts","./EnumDefine.ts","./Mod2.ts","./LevelItemVMgr.ts"],(function(e){var t,n,l,r,i,o,a,c,s,u,p,f,v,d,g,b,h,L,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,l=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){i=e.cclegacy,o=e._decorator,a=e.Node,c=e.RichText,s=e.Prefab,u=e.instantiate,p=e.director,f=e.Component},function(e){v=e.GameContextBuilder},function(e){d=e.GameLogic},function(e){g=e.GlobalContext},function(e){b=e.UIGlobalContext},function(e){h=e.TranslateScope},function(e){L=e.Mods},function(e){m=e.LevelItemVMgr}],execute:function(){var y,x,C,M,G,S,w,E,I;i._RF.push({},"9682b2hp8pOu5ELftvUKQZ4","SelectLevelVMgr",void 0);var T=o.ccclass,V=o.property;e("SelectLevelVMgr",(y=T("SelectLevelVMgr"),x=V({type:a}),C=V({type:c}),M=V({type:s}),y((w=t((S=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,l(t,"levelContainer",w,r(t)),l(t,"descText",E,r(t)),l(t,"levelItemPrefab",I,r(t)),t.currentLevel=void 0,t}n(t,e);var i=t.prototype;return i.start=function(){var e=this;console.log("init"),L.forEach((function(e){null==e.onApplicationLoaded||e.onApplicationLoaded([],[],g)})),b.engineResourceManager.loadAll(),this.levelContainer.children.forEach((function(e){return e.destroy()})),g.levelManager.getLevels().forEach((function(t){var n=u(e.levelItemPrefab);n.parent=e.levelContainer,n.getComponent(m).init(t,e.onSelected.bind(e))}))},i.onSelected=function(e){e.desc?(this.descText.string=g.translateManager.$(h.G_LEVEL_DESC,e.desc),this.currentLevel=e):this.descText.string=""},i.update=function(e){},i.onStartNewGame=function(){if(this.currentLevel){var e=new v;g.setGameContext(new d(e.buildByLevel(this.currentLevel))),b.clear(),p.loadScene("main")}else this.descText.string="please select level"},t}(f)).prototype,"levelContainer",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=t(S.prototype,"descText",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=t(S.prototype,"levelItemPrefab",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=S))||G));i._RF.pop()}}}));

System.register("chunks:///_virtual/SettingData.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"2443btoz0pAtpj6Ku66DwXZ","SettingData",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/SettingDataManager.ts",["cc","./common.ts"],(function(t){var e,s;return{setters:[function(t){e=t.cclegacy},function(t){s=t.bindAll}],execute:function(){e._RF.push({},"ac138Ldgi5AjoO4YC9BJ9z/","SettingDataManager",void 0);t("SettingDataManager",function(){function t(){this.settings=void 0,this.settings={module:{list:[],map:{}},resource:{},buff:{resource:{}},research:{list:[],map:{}}},s(this)}var e=t.prototype;return e.setContext=function(t){},e.getResourceBuff=function(t){return this.settings.buff.resource[t]||console.warn("没有该buff name"+t),this.settings.buff.resource[t]},e.addResourceBuff=function(t){this.settings.buff.resource[t.name]=t},e.addModule=function(t){this.settings.module.map[t.name]||(this.settings.module.map[t.name]=t,this.settings.module.list.push(t))},e.addResource=function(t){this.settings.resource[t.name]=t},e.getModule=function(t){return this.settings.module.map[t]},e.getResource=function(t){return this.settings.resource[t]},e.listModules=function(){return this.settings.module.list},e.listModuleNames=function(){return Object.keys(this.settings.module)},e.addResearchAble=function(t){this.settings.research.map[t.name]||(this.settings.research.map[t.name]=t,this.settings.research.list.push(t))},e.listResearchAbles=function(){return this.settings.research.list},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/Start.ts",["cc","./EnumDefine.ts","./define.ts"],(function(e){var u,n,t;return{setters:[function(e){u=e.cclegacy},function(e){n=e.GroundTypeEnum},function(e){t=e.ModuleName}],execute:function(){e("run",(function(e,u){e(i),u((function(e){return e.module.init}),i.name,(function(e,u){u.vars={wave:{},queue:[],queueIdx:0}})),u((function(e){return e.module.onTick}),i.name,(function(e,u){var n,t=u.vars,i=t.wave[e.tick],r=1;i&&((n=t.queue).push.apply(n,i),delete t.wave[e.tick]);for(;t.queueIdx<t.queue.length&&r;){var c=t.queue[t.queueIdx];t.queueIdx++,c&&(e.managers.gameEntityManager.registerResource(c,e.map.getAt(u.position)),r--)}t.queueIdx>5&&(t.queue=t.queue.slice(t.queueIdx),t.queueIdx=0)}))})),u._RF.push({},"6eeb7VgYpxLxrSXilIoFLOq","Start",void 0);var i={name:t.START,groundType:n.WIRE,funcs:{init:t.START,onTick:t.START},consts:[{}]};u._RF.pop()}}}));

System.register("chunks:///_virtual/TranslateManager.ts",["cc","./common.ts","./EnumDefine.ts"],(function(n){var t,e,s;return{setters:[function(n){t=n.cclegacy},function(n){e=n.bindAll},function(n){s=n.LangEnum}],execute:function(){t._RF.push({},"378e2I6djtBorvOXQ4EL4P0","TranslateManager",void 0);n("TranslateManager",function(){function n(){var n=this;this.lang=s.CN,this.lanMap2={},this.$=void 0,this.showKeyOnAbsent=!1;this.$=function(t,e,s){if(!s)return n.getTranslate2(t,e);n.setTranslate2(t,e,s)}}var t=n.prototype;return t.setContext=function(n){e(this)},t.setTranslate2=function(n,t,e){var s=this.lanMap2[n];s||(s=this.lanMap2[n]={}),s[t]=e},t.getTranslate2=function(n,t){var e=this.lanMap2[n];return e||(e=this.lanMap2[n]={}),e[t]?e[t]:this.showKeyOnAbsent?n+"::"+t:t},t.setShowKeyOnAbsent=function(n){this.showKeyOnAbsent=n},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/UIUtilities.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./ViewGlobal.ts"],(function(t){var e,r,n,i,l;return{setters:[function(t){e=t.createForOfIteratorHelperLoose},function(t){r=t.cclegacy,n=t.Vec3},function(t){i=t.GlobalContext},function(t){l=t.UIGlobalContext}],execute:function(){var o;function a(t,r){if("c.eitv"===t)return r.c.effect.triggerInterval/i.FRAME_RATE;var n=t.split("."),l=r;if("p"==n[0])return"<img src='"+n[1]+"'/>";for(var o,a=e(n);!(o=a()).done;){if(void 0===(l=l[o.value]))return"???? not matched "+t+" ????"}return l}t({getViewPositionVec3:function(t){return new n(l.globalDiffer.x+l.mapItemSize.x*t.x,l.globalDiffer.y+l.mapItemSize.y*t.y)},translateSettingString:function(t,e,r){var n=i.translateManager.$(t,null!=e?e:r.name),l={c:r.consts[0],v:{}},o=n.match(/\[(.*?)\]/g);return null==o||o.forEach((function(t){n=n.replace(t,a(t.slice(1,-1),l))})),n},translateString:function(t,e,r){var n=i.translateManager.$(t,null!=e?e:r.name),l={c:r.consts,v:r.vars},o=n.match(/\[(.*?)\]/g);return null==o||o.forEach((function(t){n=n.replace(t,a(t.slice(1,-1),l))})),n}}),r._RF.push({},"859d4Ljzi9Gq40VKU2yPC5a","UIUtilities",void 0);var f=t("UseMemo",function(){function t(e,r,n,i){this.pre=void 0,this.callback=void 0,this.differ=void 0,this.pre=e,this.differ=null!=i?i:t.Differ,this.callback=n?r.bind(n):r}return t.prototype.put=function(t){this.differ(this.pre,t)&&this.callback(this.pre,t),this.pre=t},t}());o=f,f.Differ=function(t,e){if(null===t&&null===e)return!1;if(null===t||null===e)return!0;if("object"!=typeof t&&"object"!=typeof e)return t===e;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!0;for(var r=0;r<t.length;r++)if(o.Differ(t[r],e[r]))return!0;return!1}if("object"==typeof t&&"object"==typeof e){var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!0;for(var l=0,a=n;l<a.length;l++){var f=a[l];if(!o.Differ(t[f],e[f]))return!0}return!1}return!0},r._RF.pop()}}}));

System.register("chunks:///_virtual/ViewGlobal.ts",["cc","./GlobalContextImpl.ts","./common.ts"],(function(e){var t,n,i,s,r,o,l,u;return{setters:[function(e){t=e.cclegacy,n=e.resources,i=e.ImageAsset,s=e.SpriteFrame},function(e){r=e.GlobalContext},function(e){o=e.bindAll,l=e.WatchAble,u=e.DEFAULT}],execute:function(){t._RF.push({},"daee0q2Vj5DEqIMV4q8qyWX","ViewGlobal",void 0);var a=e("InputMode",{NONE:"none",VIEW_DRAG:"view_drag",BUILD_MODULE:"build_module",ON_UI:"on_ui"}),c=function(){function e(){this.listeners={},this.pub=this.pub.bind(this),this.sub=this.sub.bind(this)}var t=e.prototype;return t.pub=function(e,t){var n=this.listeners[e];n&&n.length&&n.forEach((function(e){e.listener(t)}))},t.sub=function(e,t,n){this.listeners[e]||(this.listeners[e]=[]),n&&(t=t.bind(n));var i=this.listeners[e].find((function(e){return e.listener==t&&(!n||e.$this==n)}));if(i){if(i.$this!=n)throw new Error("已经注册了该监听,但绑定的this不一致")}else this.listeners[e].push({listener:t,$this:n})},t.remove=function(e,t,n){if(this.listeners[e]){var i=this.listeners[e].findIndex((function(e){return e.listener==t&&(!n||e.$this==n)})),s=this.listeners[e][i];if(s)throw s.$this==n&&(this.listeners[e]=this.listeners[e].filter((function(e){return e!=s}))),new Error("已经注册了该监听,但解除绑定的this没有传")}},t.$=function(e){return e?this.sub:this.remove},t.clear=function(e){delete this.listeners[e]},e}(),h=function(){return{inputMode:new l(a.NONE),position:new l(void 0),clickedPosition:new l(void 0),mousePointMenu:new l(void 0),mouseOverBuildAble:new l(void 0),clickedBuildAble:new l(void 0)}},f=new c;o(f);var d=function(){function e(){this._sprites={}}var t=e.prototype;return t.loadAll=function(){var e=this,t=r.renderDataManager.listResourceSpritePaths();t.forEach((function(t){n.load(t,i,(function(n,i){console.log(t,n,i),e._sprites[t]=s.createWithImage(i)}))})),(t=r.renderDataManager.listGroundSpritePaths()).forEach((function(t){n.load(t,i,(function(n,i){console.log(t,n,i),e._sprites[t]=s.createWithImage(i)}))})),(t=r.renderDataManager.listBulletSpritePaths()).forEach((function(t){n.load(t,i,(function(n,i){console.log(t,n,i),e._sprites[t]=s.createWithImage(i)}))})),(t=r.renderDataManager.listResourceBuffSpritePaths()).forEach((function(t){n.load(t,i,(function(n,i){console.log(t,n,i),e._sprites[t]=s.createWithImage(i)}))}))},t.getSprite=function(e){var t;return null!=(t=this._sprites[null!=e?e:u])?t:this._sprites[u]},e}(),p=e("UIGlobalContext",{DRAG_DISTANCE:5,myInputSystem:h(),globalUIEvent:f,mapItemSize:{x:160,y:160},globalDiffer:{x:0,y:0},engineResourceManager:new d,clear:function(){this.myInputSystem=h(),p.globalUIEvent=new c}});t._RF.pop()}}}));

System.register("chunks:///_virtual/WaveInfoVMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalContextImpl.ts","./EnumDefine.ts","./ViewGlobal.ts"],(function(e){var t,n,o,a,i,s,u,h,p,d,v,l,m,r;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,o=e._decorator,a=e.NodeEventType,i=e.input,s=e.Input,u=e.RichText,h=e.Button,p=e.Label,d=e.KeyCode,v=e.Component},function(e){l=e.GlobalContext},function(e){m=e.TranslateScope},function(e){r=e.UIGlobalContext}],execute:function(){var c;n._RF.push({},"f4107h7KcJD44nnzmlP5fDZ","WaveInfoVMgr",void 0);var g=o.ccclass;o.property,e("WaveInfoVMgr",g("WaveInfoVMgr")(c=function(e){function n(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this).waveInfoText=void 0,t.btnNext=void 0,t.waveDetailText=void 0,t.pauseGameButton=void 0,t.pauseGameButtonText=void 0,t.speedUpGameButton=void 0,t.speedUpGameButtonText=void 0,t}t(n,e);var o=n.prototype;return o.manageEvent=function(e){e?(this.node.on(a.MOUSE_ENTER,this.onMouseEnter,this,!0),this.node.on(a.MOUSE_LEAVE,this.onMouseLeave,this,!0),i.on(s.EventType.KEY_DOWN,this.on_spaceKey,this)):(this.node.off(a.MOUSE_ENTER,this.onMouseEnter,this,!0),this.node.off(a.MOUSE_LEAVE,this.onMouseLeave,this,!0),i.off(s.EventType.KEY_DOWN,this.on_spaceKey,this))},o.onMouseEnter=function(){r.myInputSystem.mousePointMenu.data=this.node},o.onMouseLeave=function(){r.myInputSystem.mousePointMenu.data===this.node&&(r.myInputSystem.mousePointMenu.data=void 0)},o.loadRef=function(){var e,t,n,o,i,s=this;(!this.waveInfoText&&(this.waveInfoText=null==(e=this.node.getChildByName("TextWave"))?void 0:e.getComponent(u)),this.btnNext)||(this.btnNext=null==(t=this.node.getChildByName("BtnNextWave"))?void 0:t.getComponent(h),this.btnNext.node.on(a.MOUSE_DOWN,this.on_nextWave,this),this.btnNext.node.on(a.MOUSE_ENTER,this.on_showDetail,this),this.btnNext.node.on(a.MOUSE_LEAVE,this.on_hideDetail,this));this.waveDetailText||(this.waveDetailText=null==(n=this.node.getChildByName("TextWaveInfo"))?void 0:n.getComponent(u),this.waveDetailText.node.active=!1);this.speedUpGameButton||(this.speedUpGameButton=null==(o=this.node.getChildByName("SpeedUpGame"))?void 0:o.getComponent(h),this.speedUpGameButtonText=this.speedUpGameButton.node.getComponentInChildren(p),this.speedUpGameButtonText.string="1X",this.speedUpGameButton.node.on(a.MOUSE_UP,(function(){var e=l.logic;e&&(1===e.gameSpeed?e.gameSpeed=2:2===e.gameSpeed?e.gameSpeed=.5:.5===e.gameSpeed&&(e.gameSpeed=1),s.speedUpGameButtonText.string=e.gameSpeed+"X")})));this.pauseGameButton||(this.pauseGameButton=null==(i=this.node.getChildByName("PauseGame"))?void 0:i.getComponent(h),this.pauseGameButtonText=this.pauseGameButton.node.getComponentInChildren(p),this.pauseGameButtonText.string="暂停",this.pauseGameButton.node.on(a.MOUSE_UP,(function(){var e=l.logic;e&&(e.pause=!e.pause,s.pauseGameButtonText.string=e.pause?"开始":"暂停",s.speedUpGameButton.node.active=!e.pause)})))},o.start=function(){this.loadRef(),this.manageEvent(!0)},o.onDestroy=function(){this.manageEvent(!1)},o.update=function(e){var t=l.logic;if(t&&t.gameContext){if(t.gameContext.alive){var n=t.gameContext.wavesInfo;this.waveInfoText.string="波次:"+n.nextPtr+"/"+n.waves.length+"\n时间:"+Math.floor(t.gameContext.tick/20)}else this.waveInfoText.string="已结束\n时间:"+Math.floor(t.gameContext.tick/20);if(this.waveDetailText.node.active){var o=t.gameContext.managers.translateManager.$,a=t.gameContext.wavesInfo,i=a.waves[a.nextPtr];if(!i)return this.waveDetailText.node.active=!1,void(this.waveDetailText.string="");var s="时间:"+Math.floor(i.tick/20)+"\n";i.info.forEach((function(e){e.forEach((function(e){e.name&&(s+=o(m.RESOURCE_NAME,e.name)+":(复杂度)"+e.complexity+"\n")}))})),this.waveDetailText.string=s}}},o.on_nextWave=function(e){var t=l.logic;0===e.getButton()&&t&&t.gameContext&&t.nextWaveLogic(t.gameContext,!0)},o.on_showDetail=function(e){this.waveDetailText.string="",this.waveDetailText.node.active=!0},o.on_hideDetail=function(e){this.waveDetailText.node.active=!1},o.on_spaceKey=function(e){l.logic&&e.keyCode===d.SPACE&&(l.logic.pause=!l.logic.pause,this.pauseGameButtonText.string=l.logic.pause?"开始":"暂停",this.speedUpGameButton.node.active=!l.logic.pause)},n}(v))||c);n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});